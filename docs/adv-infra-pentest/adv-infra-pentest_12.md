# 第十二章：物联网利用

术语“物联网”是由麻省理工学院媒体中心的凯文·阿什顿创造的。它描述了包括摄像头、车辆和传感器在内的物理设备网络。物联网得到了指数级的采用，并且代表了不可否认的承诺和可能性。这种快速采用为新的商业机会打开了大门，但另一方面，从安全角度来看，也揭示了新的威胁和弱点。本章将是您的救世主。因此，它将带您了解物联网生态系统，了解如何抵御真实世界的物联网攻击。实际上，在本章中，您将学会在学习如何利用物联网环境之后，获得准备安全物联网项目所需的技能，从最小的设备到连接的汽车。根据 F5 Labs 的报告，2017 年上半年物联网攻击激增了 280%。在本章中，我们将完成我们的旅程。这是又一个里程碑。在走过攻击和保护宝贵企业资产的不同技术之后，是时候继续学习经验，并发现渗透测试物联网项目的技能了。

# 物联网生态系统

到 2020 年，将有超过 500 亿个连接设备。这么多设备将带来大量新的威胁。作为渗透测试人员，我们需要准备好抵抗这场技术启示。物联网生态系统基于许多因素，我们也在以下图片中显示了这些因素：

+   商业机会

+   公共机构

+   消费者

+   基础设施

![](img/00361.jpeg)

# 物联网项目架构

像任何技术项目一样，典型的物联网项目由许多组件组成，如下所示（请参见以下图片）：

+   **远程设备**

+   **数据存储**

+   **物联网设备**（例如，闭路电视摄像头，家用路由器，打印机，工业系统和连接的汽车）

+   **网关**

这幅图表显示了物联网项目的典型架构：

![](img/00362.jpeg)

# 物联网协议

在典型的物联网项目中，涉及许多协议以确保满足要求。它们分为不同的层。以下是一些知名的物联网协议：

+   **Wi-Fi**：这是物联网开发人员广泛使用的协议。它基于 IEEE 802.11 标准。它使用 2.4 GHz 和 5 GHz 作为频段频率，范围约为 50 米。通常，它可以传输 150-200 Mbps 的数据。

+   **Z-Wave**：这是一种低功率容量的射频通信技术。它广泛用于传感器和家庭自动化产品，数据速率为 100 Kbps。它可以控制最多 232 个设备，范围为 30 米。

+   **Zigbee**：这类似于蓝牙。它基于 IEEE 802.15.4 协议，并在 2.4 GHz 频率上运行。通常在我们没有大数据速率的情况下使用，通常为 250 Kbps，范围为 100 米。有许多 Zigbee 配置文件，例如 Zigbee PRO 和 Zigbee 远程控制（RF4CE）。最新版本是 Zigbee 3，它结合了所有先前的 Zigbee 标准。

+   **Sigfox**：这是一种广域技术，在农村环境下为 30-50 公里，在城市环境下为 3-10 公里。它在 900 MHz 频率上运行，数据速率为 10-1000 Kbps。您无需许可证即可使用其频段，因为它在免许可使用频段（ISM）上运行。

+   **Lora**：这类似于 Sigfox。它旨在在 WAN 网络上运行（在城市环境下为 2-5 公里，在郊区环境下为 15 公里），数据速率为 0.3-50 Kbps。

+   **近场通信（NFC）**：这是一种基于 ISO/IEC 18000-3 标准的双向交互技术，频率为 13.56 MHz，在智能手机中广泛使用，特别是在非接触式支付操作中。它在 4 到 10 厘米的范围内运行，数据速率为 100-420 Kbps。

+   IPv6 低功耗无线个人区域网络（6LOWPAN）：这是基于 RFC 6282 的互联网协议。它非常适应性强，可以使用不同的通信平台，如 Wi-Fi 和以太网。

# 物联网通信堆栈

物联网通信堆栈类似于 OSI 网络模型。它代表了不同层之间的所需功能和交互。它由以下层组成：

+   数据层

+   端到端层

+   网络层

+   ID 层

+   链路层

+   物理层

![](img/00363.jpeg)

# IP 智能对象协议套件

与 TCP/IP 模型类似，物联网项目有自己的套件和表示，名为 IP 智能对象协议套件：

![](img/00364.jpeg)

# 标准组织

物联网展示了一个充满希望的未来。因此，它需要被许多组织和联盟组织和标准化。以下是一些知名的物联网标准组织：

+   国际电工委员会（IEC）：IEC 作为物联网标准的最大贡献者之一，发挥着重要作用，特别是通过其 IEC 62056（DLMS/COSEM）讨论智能电表。

+   国际标准化组织（ISO）：ISO 致力于各种产品，特别是通过 ISO/AWI 18575 标准在供应链中的物联网。ISO 还与 IEC 联合成立了一个联合技术委员会。

+   电气和电子工程师学会（IEEE）：IEEE 制定了物联网的 IEEE P2413 标准，以及其他标准，如 IEEE 802.15.4。

+   互联网工程任务组（IETF）：IETF 对物联网有一个以网络为中心的愿景。这一愿景得到了通过在受限制的 RESTful 环境和 IPv6 协议上的工作的支持。

# 物联网攻击面

上一节是对物联网生态系统的简要概述。物联网为企业提供了一个惊人的增长机会，但也伴随着大量的威胁。从不同的角度来看，物联网面临着许多挑战，包括安全性、集成问题和互操作性。在市场发展的早期阶段，物联网可能会对这些领域产生许多安全警报和技术威胁。

# 设备和设备

设备是物联网项目的核心组件。在本小节中，我们将探讨硬件威胁，并在另一个点讨论框架攻击。物理安全在信息安全中起着重要作用。未受保护的设备对您的架构构成真正的威胁。暴露的设备很容易受到攻击。因此，黑客可以通过公开可用的数据表和大多数使用的知名设备的必需信息在线收集有关设备的信息。网站，如[`wiki.openwrt.org`](https://wiki.openwrt.org)帮助用户了解各种设备，如路由器和网关的详细信息：

![](img/00365.jpeg)

这一步可能是危险的，因为通过了解硬件信息，攻击者可以识别（作为入口点）使用的接口，如通用异步收发器（UART），如果攻击者成功通过查找 PINS（TX、RX 和 GND）连接到设备，就可以获得 root 访问权限，使用万用表作为连续模式（此模式不需要电源）：

![](img/00366.gif)

上图说明了用 USB 电缆连接的引脚。您需要找到波特率，它类似于比特率（每秒的位数），但它是每秒的信号变化次数。换句话说，它是每秒符号的信息变化次数。要识别设备的波特率，您可以使用 Craig Heffner 在 GitHub 链接中开发的脚本：[`github.com/devttys0/baudrate/blob/master/baudrate.py`](https://github.com/devttys0/baudrate/blob/master/baudrate.py)。一旦获得合适的波特率，就可以连接到设备。

# 固件

固件是一组软件，它控制设备的硬件。分析固件是物联网渗透测试的关键步骤。为了实现这一点，您可以使用许多工具和实用程序。其中之一是 binwalk，这是一个由 Craig Heffner 开发的伟大工具，可以帮助渗透测试人员分析物联网设备的固件。您可以从以下 GitHub 链接获取它：[`github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md`](https://github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md)。让我们运行以下命令：

```
# git clone https://github.com/ReFirmLabs/binwalk/
# cd binwalk
# ./deps.sh
```

然后，使用以下命令安装它：

```
# sudo ./setup.py install
```

![](img/00367.jpeg)

如果您使用 Kali Linux 发行版，可以通过在 CLI 中键入`binwalk`来直接使用 binwalk：

![](img/00368.jpeg)

例如，如果您想使用 binwalk 收集关于 Airlink 101 AR430W V1 路由器二进制文件的信息，请使用以下命令：

```
# binwalk ar430w-firmware.bin
```

![](img/00369.jpeg)

要从二进制文件中提取文件，请添加`-e`选项：

![](img/00370.jpeg)

如果您想提取特定文件类型，请使用`-D`选项：

```
# binwalk -D 'png image:png' <firmware_binary_here>
```

从二进制文件中提取文件后，您可以进行固件分析。如果您想自动化这个过程，可以使用来自[`github.com/craigz28/firmwalker`](https://github.com/craigz28/firmwalker)的 firmwalker：

![](img/00371.jpeg)

# Web 界面

不安全的 Web 界面对物联网项目构成巨大风险。许多设备都集成了 Web 服务器，就像任何其他 Web 服务器应用程序项目一样，它们容易受到 Web 应用程序攻击的影响，并且可以被利用。集成的 Web 应用程序不仅容易受攻击，而且缺乏传输加密也是一种危险的举动；因此，发送的消息可能会被拦截。

# 网络服务

网络服务在任何物联网项目中都是必不可少的。如前几节所讨论的，典型的物联网项目可能使用许多通信协议，这些通信面临不同的威胁：它们是攻击者的高价值目标。对于攻击者来说，映射攻击面使得黑客尝试更加成功。

# 云接口和第三方 API

物联网项目可以使用云接口和第三方 API。它们在现代组织中尤其是在物联网项目中扮演着重要角色，同时它们简化了许多云处理过程。这就是为什么作为渗透测试人员，您应该考虑它们。敏感数据可以通过这些渠道传输，许多 API 用于身份验证和授权。因此，您需要确保云接口和第三方 API 的安全性。

# 案例研究 - Mirai 僵尸网络

为了更清楚地了解和认识到不安全的物联网的危险影响，让我们深入了解一下影响数百万设备和用户的灾难性攻击之一。那就是 Mirai 僵尸网络。Mirai 在日语中意味着“未来”。它使用数百万受损设备对许多企业和服务提供商进行了分布式拒绝服务（DoS）攻击，包括 DNS、Twitter、PayPal、reddit、Brian Krebs 网站和许多其他知名网站：

![](img/00372.jpeg)

# OWASP 物联网项目

在第一章中，我们看到了**开放式 Web 应用程序安全项目**（**OWASP**）指南作为众所周知的 Web 应用程序安全标准之一。它们也是活跃的，并且他们正在制定一个新的列表，代表了面临物联网项目的前 10 个威胁。接下来将提到这 10 个威胁。

# 不安全的 Web 界面

如前所述，Web 界面在任何物联网项目中都很重要。这就是为什么不安全的 Web 界面被列为前 10 个威胁之一。为了确保您的物联网 Web 界面通常是安全的，至少使用一个 Web 应用程序漏洞扫描程序。**Nikto**是最常用的用于检查 Web 应用程序安全性的工具之一。如果您使用 Kali Linux，您可以直接通过 CLI 使用它。它是 Kali Linux 中的内置工具：

![](img/00373.jpeg)

如果你想使用 Nikto 扫描你的网络应用程序界面，请输入以下命令：

```
#sudo nikto -h <your_interface_address_here>
```

在下面的例子中，我们使用[www.example.com](http://www.example.com)网站作为演示：

![](img/00374.jpeg)

# 不足的认证/授权

认证问题对物联网设备构成了真正的安全威胁。如果接口没有用强密码保护，设备可能会受到攻击。你可以看到，即使设备和家用电器是新的，攻击技术也是老的。这一切都取决于用户的行为。为了避免这种类型的攻击，确保所有密码都是强密码，并且更改每个默认密码。例如，你可以使用[`howsecureismypassword.net/`](https://howsecureismypassword.net/)来检查你密码的强度：

![](img/00375.jpeg)

# 不安全的网络服务

不安全的网络服务可能被利用来通过网络的外部和内部手段来妥协设备，通常是通过使用端口扫描器识别开放端口。在这种情况下，你需要确保只有必需的端口是开放的。

# 缺乏传输加密

将数据作为纯文本传递代表着你的物联网项目面临巨大的风险。加密数据始终是避免数据被拦截的最佳方法。有许多标准的加密技术和协议，如 SSL 和 TLS。你可以使用一个名为`sslscan`的工具来扫描你的项目，这是 Kali Linux 中的一个内置工具：

![](img/00376.jpeg)

作为演示，这是扫描输出消息的一部分：

![](img/00377.jpeg)

# 隐私问题

许多隐私问题可能会被视为物联网项目的威胁。能够收集有关使用数据的信息，特别是敏感信息，可能是危险的；同时，获取有关设备功能的信息也是危险的。

# 不安全的云接口

云计算在现代物联网项目中扮演着重要的角色。确保云接口是安全的是必须的。作为安全措施，你需要减轻异常行为，并至少实施一个账户锁定机制。

# 不安全的移动接口

移动应用程序非常重要。不安全的移动接口可能会使物联网项目陷入危险。未加密的数据可能会被攻击者拦截。

# 不足的安全可配置性

在配置方面需要采取许多措施。分离管理面板和接口，记录安全事件，并启用警报是避免不足的安全可配置性的明智决定。

# 不安全的软件/固件

在前面的部分中，我们讨论了固件威胁，因为你知道它是软件，每个软件都可以被利用。使用静态和动态分析进行固件分析总是加固固件的一个好方法。

# 差劲的物理安全

不要忘记物理安全。对设备的访问可能对你的项目构成威胁。暴露设备和错误放置它们可能是危险的。如果你把你的设备暴露给任何人，他们可以被拆解或通过开放接口（如 USB）访问。

# 黑客攻击连接的汽车

物联网设备和家用电器并不是唯一受到攻击的受害者。最近的许多研究表明，连接的汽车也可能受到攻击。根据*汽车黑客攻击脆弱性调查*，2016 年 1 月，60%的千禧一代支持汽车变得更加连接。现代连接的汽车由许多以下单元组成：

+   信息娱乐（主机单元）-有时称为**发动机控制单元**（**ECU**）

+   远程监控和连接形式

+   GPS 和导航系统

+   车辆对车辆通信系统

+   安全和防盗系统

+   传感器

+   夜视

大多数连接的汽车包括一个控制器区域网络，它将所有汽车的组件（传感器、气囊等）与中央控制单元连接起来。控制器区域网络的标准自 1993 年以来已被 ISO 接受和发布：

![](img/00378.jpeg)

# 对连接的汽车的威胁

连接的汽车面临来自不同攻击向量的许多威胁。因为它们由许多单元组成，所以存在各种攻击类别：

+   固件攻击

+   操作系统攻击

+   对 CAN 的远程攻击

+   OBD2 受损

+   嗅探

+   恶意下载的应用程序

一辆日产 Leaf 被通过手机应用程序和网络浏览器进行了安全研究。2016 年 2 月，安全研究人员展示了可以通过互联网使用日产手机应用程序访问日产汽车。

# 总结

这一章是一个简单明了的指南，旨在帮助开发人员、制造商和渗透测试人员构建和保护物联网项目。我们首先发现了物联网生态系统，以及典型物联网项目的不同组成部分。我们看到了物联网项目面临的威胁，以及确保物联网环境安全所需的步骤。在这一点上，您已经掌握了执行渗透测试任务所需的技术技能和适当的心态。现在，您将能够保护现代组织基础设施免受当今的威胁和攻击，并部署适当的防护措施来抵御这些攻击。
