- en: Performing Information Gathering
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行信息收集
- en: The skill of gathering information about your target is an essential skill that
    any penetration tester should have.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 收集关于目标的信息的技能是任何渗透测试人员都应该具备的重要技能。
- en: There is a big difference between passive and active information gathering.
    Passive information gathering leverages publicly available information. Active
    information gathering involves direct interaction with the target system. Active
    information gathering crosses the line when it comes to laws in specific countries,
    as some countries deem it illegal to perform any type of penetration test without
    permission—this is where your "get out of jail free card" (as discussed in [Chapter
    1](b37fecb9-6e3e-4ce0-8937-eb376e474bf9.xhtml), *Introduction to Penetration Testing*)
    comes in. It's important to have the right authorizations before you perform any
    active information gathering.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 被动信息收集和主动信息收集之间存在很大的区别。被动信息收集利用公开可用的信息。主动信息收集涉及与目标系统的直接交互。在特定国家的法律中，主动信息收集越过了界限，因为一些国家认为未经许可进行任何类型的渗透测试是非法的——这就是你的“免于监禁”（如[第1章](b37fecb9-6e3e-4ce0-8937-eb376e474bf9.xhtml)，*渗透测试简介*中讨论的）的重要性。在进行任何主动信息收集之前，获得正确的授权是非常重要的。
- en: The information you gather about your target will be used to plan your attack.
    In this phase, you will look for anything that can expose information about your
    target. For example, are their public facing servers exposing known vulnerable
    ports? Are there any documents or information (such as social media posts) that
    contain sensitive information that's available on the internet? As you build your
    repository of information, you can begin threat modeling and search for vulnerabilities
    that can be used in your attack plan.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 你收集的关于目标的信息将被用来规划你的攻击。在这个阶段，你将寻找任何可能暴露目标信息的东西。例如，他们的公共服务器是否暴露了已知的易受攻击的端口？是否有任何文件或信息（比如社交媒体帖子）在互联网上包含敏感信息？当你建立你的信息库时，你可以开始威胁建模，并寻找可以在你的攻击计划中使用的漏洞。
- en: 'As you progress through this chapter, you will learn about the following topics:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 随着你在本章的学习过程中，你将了解以下主题：
- en: Passive information gathering
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 被动信息收集
- en: Active information gathering
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主动信息收集
- en: Vulnerability scanning
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞扫描
- en: Known vulnerable services
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 已知的易受攻击的服务
- en: Capturing traffic
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 捕获流量
- en: Technical requirements
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'The following technical requirements apply to this chapter:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章适用以下技术要求：
- en: Kali Linux 2019.1
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 2019.1
- en: Metasploitable 2 and 3
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploitable 2和3
- en: Passive information gathering
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 被动信息收集
- en: Passive information gathering is commonly referred to as **Open Source Intelligence**
    (**OSINT**). When you're performing passive information gathering, the main aim
    is to collect as much information about the target as possible without alerting
    the target. In the passive information gathering phase, you will leverage publicly
    published information using a number of tools and third-party databases. You will
    be surprised at how much information you can gain from publicly accessible resources.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 被动信息收集通常被称为**开源情报**（**OSINT**）。当你进行被动信息收集时，主要目的是在不引起目标注意的情况下尽可能多地收集有关目标的信息。在被动信息收集阶段，你将利用使用多种工具和第三方数据库发布的公开信息。你会惊讶于你可以从公开资源中获得多少信息。
- en: 'Common passive information gathering techniques are as follows:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 常见的被动信息收集技术如下：
- en: Investigating DNS records to find mail server details, subdomains, and more
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 调查DNS记录以查找邮件服务器详细信息、子域等
- en: Using crafted searches on search engines to discover any information, such as
    files
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在搜索引擎上使用精心设计的搜索来发现任何信息，比如文件
- en: Discovering internet connected devices
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现互联网连接的设备
- en: Using tools to obtain information, such as email addresses
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用工具获取信息，比如电子邮件地址
- en: The OSINT framework aims to collect information from freely available resources.
    A good online resource that I encourage you to look at is as follows: [https://osintframework.com](https://osintframework.com).
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: OSINT框架旨在从免费可用的资源中收集信息。我鼓励你查看一个很好的在线资源，如下：[https://osintframework.com](https://osintframework.com)。
- en: Let's do some information gathering by using something that is rife with information—the
    internet.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过使用充满信息的东西——互联网来进行一些信息收集。
- en: Using the internet
  id: totrans-23
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用互联网
- en: When gathering information, one of your main tools will be the internet. The
    internet is rife with information. Social media, blogs, messaging services, among
    others, are all common mediums that people use on a daily basis. Employees might
    post information about their organization that might seem meaningless to them,
    but to an attacker, it can be a gold mine.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在收集信息时，你的主要工具之一将是互联网。互联网充斥着信息。社交媒体、博客、消息服务等都是人们日常使用的常见媒介。员工可能会发布关于他们组织的信息，这对他们来说可能毫无意义，但对攻击者来说，这可能是一个金矿。
- en: Google dorks
  id: totrans-25
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 谷歌dork
- en: A Google dork (also referred to as Google hacking) really is a specially crafted
    search string that returns information that isn't readily available on the website
    that's being targeted. It does this by leveraging advanced search operators.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌dork（也称为谷歌黑客）实际上是一个特别设计的搜索字符串，返回的信息在目标网站上并不容易获得。它通过利用高级搜索运算符来实现这一点。
- en: Using Google dorks is an excellent way to perform information gathering on your
    target. You are able to return data such as usernames and passwords, sensitive
    information, login portals, and more.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 使用谷歌dork是在目标上执行信息收集的一个很好的方法。你可以返回诸如用户名和密码、敏感信息、登录门户等数据。
- en: 'Search operators within Google can be used to query specific information. Examples
    of such search operators are as follows:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌内的搜索运算符可以用来查询特定信息。此类搜索运算符的示例如下：
- en: '**site**:Provides an output of URLs that are specific to the website you define.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**site**：提供了你定义的网站特定的URL输出。'
- en: '**inurl**: With this query, you can define a certain string, and the results
    will return websites that have that string in them.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**inurl**：使用此查询，您可以定义一个特定的字符串，结果将返回包含该字符串的网站。'
- en: '**filetype**: Here, you can define specific filetypes that you are looking
    for. For example, you can specify PDF, XLS, DOC, or any other file extension you
    want.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**filetype**：在这里，您可以定义您要查找的特定文件类型。例如，您可以指定PDF、XLS、DOC或任何其他您想要的文件扩展名。'
- en: Search operators can be used together to perform crafty searches. An example
    of this is when looking for files with the `.doc` extension on `microsoft.com`.
    Here, you would accomplish this using the search query `filetype:doc site:microsoft.com` within
    `Google.com`.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索运算符可以一起使用进行巧妙的搜索。例如，在`microsoft.com`上查找具有`.doc`扩展名的文件时，您可以使用`Google.com`中的搜索查询`filetype:doc
    site:microsoft.com`来实现这一点。
- en: 'Exploit-DB houses the Google Hacking Database, which is shown in the following
    screenshot (*Figure 1*). Here, you will find a vast collection of Google dorks
    that are constantly being updated:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: Exploit-DB存放着Google Hacking数据库，如下截图所示（*图1*）。在这里，您将找到一个不断更新的大量Google dorks：
- en: The exact location for the Google Hacking Database on Exploit-DB is as follows: [https://www.exploit-db.com/google-hacking-database](https://www.exploit-db.com/google-hacking-database).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: Exploit-DB上Google Hacking数据库的确切位置如下：[https://www.exploit-db.com/google-hacking-database](https://www.exploit-db.com/google-hacking-database)。
- en: '![](img/233383f2-7bc3-4a8f-8051-3014d0b86760.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](img/233383f2-7bc3-4a8f-8051-3014d0b86760.png)'
- en: 'Figure 1: Google Hacking Database listed on exploit-db.com'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 图1：在exploit-db.com上列出的Google Hacking数据库
- en: 'You will notice that there are multiple categories where you can find various
    Google dorks. Let''s perform information gathering using one of the dorks:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 您会注意到有多个类别，您可以在其中找到各种Google dorks。让我们使用其中一个dork进行信息收集：
- en: '[PRE0]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The results from Google show how many websites have passwords exposed in clear
    text, as shown in *Figure 2*:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌的结果显示了有多少网站的密码以明文形式暴露，如*图2*所示：
- en: '![](img/cf30a4cf-7dae-4d1b-97f7-9bc67008ff01.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cf30a4cf-7dae-4d1b-97f7-9bc67008ff01.png)'
- en: 'Figure 2: Passwords exposed using a Google Dork'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 图2：使用Google Dork暴露的密码
- en: As you gather information on your target, you can leverage crafted search queries
    within Google to discover what information is available.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在收集有关目标的信息时，您可以利用在Google中精心设计的搜索查询来发现可用的信息。
- en: Shodan
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Shodan
- en: 'Shodan is not your average search engine. It''s often referred to as the search
    engine for hackers. On its website, Shodan is referred to as the *world''s first
    search engine for interconnected devices*. Shodan is accessible via [https://www.shodan.io](https://www.shodan.io)
    as shown in *Figure 3*:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Shodan不是您平均的搜索引擎。它经常被称为黑客的搜索引擎。在其网站上，Shodan被称为*互联设备的世界第一搜索引擎*。Shodan可以通过[https://www.shodan.io](https://www.shodan.io)访问，如*图3*所示：
- en: '![](img/fc411077-1c5e-4439-b139-7da0c7c2692e.png)'
  id: totrans-45
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fc411077-1c5e-4439-b139-7da0c7c2692e.png)'
- en: 'Figure 3: The landing page for https://www.shodan.io'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 图3：https://www.shodan.io的登录页面
- en: What is so unique about Shodan? Search engines such as Google and Bing index
    websites, but Shodan indexes everything, such as webcams, databases servers, medical
    devices, routers, and so on. Anything that is connected to the internet is indexed
    by Shodan.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: Shodan有什么独特之处？谷歌和必应等搜索引擎索引网站，但Shodan索引一切，如网络摄像头、数据库服务器、医疗设备、路由器等等。任何连接到互联网的东西都被Shodan索引。
- en: As defined by the founder of Shodan, John Matherly, in his book, *Complete Guide
    to Shodan*, the algorithm of Shodan is simple.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 正如Shodan的创始人John Matherly在他的书*Shodan完全指南*中所定义的，Shodan的算法很简单。
- en: 1\. Create a random IPv4 address
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 1. 创建一个随机的IPv4地址
- en: 2\. Look at the list of ports that Shodan understands and pick a random port
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 2. 查看Shodan了解的端口列表并选择一个随机端口
- en: 3\. Using the IPv4 address generated in step 1 and the port generated in step
    2, perform a connection and grab the banner
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 3. 使用步骤1生成的IPv4地址和步骤2生成的端口，执行连接并抓取横幅
- en: 4\. Repeat step 1
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 4. 重复步骤1
- en: This algorithm does not merely crawl websites—it finds everything and indexes
    it. Let's take a look at some of the queries that can be run with Shodan.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 这个算法不仅仅是爬取网站，它找到一切并对其进行索引。让我们看一下可以使用Shodan运行的一些查询。
- en: Shodan scripting
  id: totrans-54
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Shodan脚本
- en: As we learned in [Chapter 2](6c1d74a7-e51b-4141-9f6c-6e34bf0a926c.xhtml), *Getting
    Started with Kali Linux*, within Kali Linux, you are able to use scripts. Let's
    take a look at a script that can work with Shodan.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在[第2章](6c1d74a7-e51b-4141-9f6c-6e34bf0a926c.xhtml)中学到的，*使用Kali Linux入门*，在Kali
    Linux中，您可以使用脚本。让我们看一下可以与Shodan一起使用的脚本。
- en: The first thing you should do is register for an account with Shodan. This can
    be done by navigating directly to [https://account.shodan.io/register](https://account.shodan.io/register).
    Once you have created an account, navigate to My Account and obtain your **API
    key.** Keep you API key as you will use it in the script.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该做的第一件事是在Shodan注册一个帐户。这可以通过直接导航到[https://account.shodan.io/register](https://account.shodan.io/register)来完成。创建帐户后，导航到我的帐户并获取您的**API密钥**。保留API密钥，因为您将在脚本中使用它。
- en: 'From your Kali Linux machine, you need to perform a few tasks before you can
    begin writing the script:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 从您的Kali Linux机器上，您需要在开始编写脚本之前执行一些任务：
- en: 'Ensure that you are running the latest updates and upgrades and have `python
    2.7` installed. Running the following command will ensure that you meet this requirement:'
  id: totrans-58
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 确保您正在运行最新的更新和升级，并且已安装`python 2.7`。运行以下命令将确保您满足此要求：
- en: '[PRE1]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We will leverage the `pip` command to install the required `shodan` files.
    This is done using the following command:'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将利用`pip`命令来安装所需的`shodan`文件。使用以下命令完成此操作：
- en: '[PRE2]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Once you have all the requirements installed, you can create a script that performs
    whatever search you want to perform. Note that for all the queries leveraging
    Shodan, you will need to leverage your **API** **key**. You can replace the text
    `"insert your API key here"` with your actual **API key**. We will create a script
    that will allow us to perform information gathering on our target. By using the
    sample script the follows, we can leverage Shodan to obtain results using the `api.search`
    query.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 安装了所有要求后，您可以创建一个执行您想要执行的任何搜索的脚本。请注意，对于所有利用Shodan的查询，您需要使用您的**API密钥**。您可以用您的实际**API密钥**替换文本`"insert
    your API key here"`。我们将创建一个脚本，允许我们对目标进行信息收集。通过使用下面的示例脚本，我们可以利用Shodan使用`api.search`查询来获取结果。
- en: 'We will create a new Python script using the `nano shodan-iis.py` command and
    the following code:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用`nano shodan-iis.py`命令和以下代码创建一个新的Python脚本：
- en: '[PRE3]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: To save a file in nano, you can use *Ctrl* + *O* and exit using *Ctrl* + *X. *Once
    the file has been saved, we can run it using the `python shodan-iis.py` command.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 要在nano中保存文件，您可以使用*Ctrl* + *O*，然后使用*Ctrl* + *X*退出。文件保存后，我们可以使用`python shodan-iis.py`命令运行它。
- en: 'Note that my search is not specific to any country—I am merely searching for
    IIS servers:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我的搜索不针对任何特定国家，我只是在搜索IIS服务器：
- en: If you purchase a subscription to Shodan, you are able to use a lot more search
    operators within your API query. The free version limits you to basic searches
    and only 2 pages of results.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您购买了Shodan的订阅，您可以在API查询中使用更多的搜索运算符。免费版本限制您进行基本搜索，只能看到2页的结果。
- en: '![](img/fd1a71bb-1438-4bef-a0bc-5af725e42267.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fd1a71bb-1438-4bef-a0bc-5af725e42267.png)'
- en: 'Figure 4: Output of the shodan-iis script'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 图4：shodan-iis脚本的输出
- en: In the preceding output (*Figure 4*), we have a number of results. Now, we can
    filter the results so that we have the IP addresses only. Using these IP addresses,
    we can then leverage a simple Nmap script to perform a scan of the IP addresses.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在上述输出(*图4*)中，我们有许多结果。现在，我们可以过滤结果，以便只有IP地址。使用这些IP地址，我们可以利用一个简单的Nmap脚本来对IP地址进行扫描。
- en: 'Modify the script so that only the IP addresses are displayed. To do this,
    we need to remove `IP`from the line `print(''IP: {}''.format(result[''ip_str'']))`and
    remove the lines `print(result[''data''])` and `print('''')`. The new code should
    look like this:'
  id: totrans-71
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '修改脚本，以便只显示IP地址。为此，我们需要从`print(''IP: {}''.format(result[''ip_str'']))`行中删除`IP`，并删除`print(result[''data''])`和`print('''')`行。新代码应如下所示：'
- en: '[PRE4]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Note that we now have just the IP addresses*. *Using this, we can pipe the
    output to a text file using the `python shodan-iis.py >> shodan-iis.txt` command
    as shown in *Figure 5*:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们现在只有IP地址。使用这个，我们可以将输出导入到一个文本文件中，使用`python shodan-iis.py >> shodan-iis.txt`命令，如*图5*所示：
- en: '![](img/e30392e2-ceed-494a-8b9d-fd5e6bbd5bbd.png)'
  id: totrans-74
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e30392e2-ceed-494a-8b9d-fd5e6bbd5bbd.png)'
- en: 'Figure 5: Output of shodan-iis script filtering only IP addresses.'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 图5：shodan-iis脚本的输出，仅过滤IP地址。
- en: Now that we have the IP addresses, we can build a simple bash script to run
    an Nmap scan against them.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们有了IP地址，我们可以创建一个简单的bash脚本来对它们进行Nmap扫描。
- en: 'Create a simple bash script by entering the `nano shodan-nmap-iis.sh` command.
    Inside nano, enter the following code:'
  id: totrans-77
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过输入`nano shodan-nmap-iis.sh`命令创建一个简单的bash脚本。在nano中，输入以下代码：
- en: '[PRE5]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Save the script as you did for the Python script, and change the permissions
    to enable it to run using the `chmod +x shodan-nmap-iis.sh`command. Then, run
    the script using the `./shodan-nmap-iis.sh` command.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 保存脚本，然后更改权限以使其能够使用`chmod +x shodan-nmap-iis.sh`命令运行。然后，使用`./shodan-nmap-iis.sh`命令运行脚本。
- en: 'In the preceding code, we started with the crunchbang (`#!`) and defined the
    shell we will run the script in. Then, we defined the source file. While the script
    reads each line, it then performs a Nmap TCP syn scan (`-sS`), and a service and
    version detection on the ports (`-sV`). The results are as shown in *Figure 6*:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的代码中，我们从crunchbang (`#!`)开始，并定义了我们将在其中运行脚本的shell。然后，我们定义了源文件。当脚本读取每一行时，它会执行Nmap
    TCP syn扫描(`-sS`)，以及对端口的服务和版本检测(`-sV`)。结果如*图6*所示：
- en: '![](img/fc47875a-4dfd-4e14-99e1-989d20ab09c0.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](img/fc47875a-4dfd-4e14-99e1-989d20ab09c0.png)'
- en: 'Figure 6: Results of the bash script'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图6：bash脚本的结果
- en: Shodan truly is a search engine for hackers. There is a wealth of information
    that can be obtained on any type of internet-connected device.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: Shodan确实是黑客的搜索引擎。可以获取任何类型的互联网连接设备的大量信息。
- en: Using Kali Linux
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Kali Linux
- en: Kali Linux has a number of built-in tools that you can use for both passive
    and active information gathering. Here, we will take a look at some of the tools
    that can be used for passive information gathering.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: Kali Linux有许多内置工具，可以用于被动和主动信息收集。在这里，我们将看一些可以用于被动信息收集的工具。
- en: Maltego
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Maltego
- en: Maltego is a great tool that uses OSINT. Maltego is able to visualize how information
    on your target is connected. Maltego is available in both free and paid versions.
    In this book, we will leverage the free version. Maltego is also pre-installed
    within Kali Linux, so there is no need to install it. You will notice that even
    though we will use the free version, it's able to derive a wealth of information
    on your target.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego是一个使用OSINT的好工具。Maltego能够可视化有关目标的信息是如何连接的。Maltego有免费和付费版本。在本书中，我们将利用免费版本。Maltego也预装在Kali
    Linux中，所以不需要安装它。您会注意到，即使我们使用免费版本，它也能够为您的目标提供大量信息。
- en: Maltego uses publicly available information to visualize connections and information.
    There should be no legal implications when performing analysis on public targets,
    but please ensure that you check your local country-specific laws.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego使用公开可用的信息来可视化连接和信息。在对公共目标进行分析时，不应该有法律影响，但请确保您检查您当地特定国家的法律。
- en: Let's get started and run Maltego. To get Maltego started, from the Kali Terminal,
    type in `maltego`. On the first launch of Maltego, you will need to select which
    version you will be using. The free edition is titled **Maltego CE. **Once you
    register your account and sign in, you will be presented with the start screen
    of Maltego.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们开始运行Maltego。要启动Maltego，在Kali终端中输入`maltego`。在首次启动Maltego时，您需要选择要使用的版本。免费版本名为**Maltego
    CE**。注册帐户并登录后，您将看到Maltego的启动屏幕。
- en: 'Maltego uses **transforms**, which allow you to obtain richer results by plugging
    into various websites such as Shodan, VirusTotal and Threatminer. You will notice
    that the Transform Hub has a wealth of additions that you can plug into to beef
    up your results as shown in *Figure 7*:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego使用**变换**，允许您通过插入各种网站（如Shodan、VirusTotal和Threatminer）获得更丰富的结果。您会注意到变换中心有许多附加功能，可以增强您的结果，如*图7*所示：
- en: '![](img/17d393ef-87b1-4c78-9f47-1a624a663d8c.png)'
  id: totrans-91
  prefs: []
  type: TYPE_IMG
  zh: '![](img/17d393ef-87b1-4c78-9f47-1a624a663d8c.png)'
- en: 'Figure 7: List of transforms within Maltego'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 图7：在Maltego中的变换列表
- en: 'Within Maltego, we have the option to run a **machine**. Think of a machine
    as a script or macro that runs a set of predefined **transforms** with various
    filters configured. Using a machine allows you to kick off information gathering
    quickly. To run a machine, you need to click on Run a machine and select your
    desired machine*.* In our example, we will run the Footprint L3 machine, which
    performs an intense footprint on a defined domain as shown in *Figure 8*:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在Maltego中，我们有运行**机器**的选项。将机器视为运行一组预定义的带有各种配置的**变换**的脚本或宏。使用机器可以快速启动信息收集。要运行机器，您需要单击运行机器，并选择所需的机器。在我们的示例中，我们将运行Footprint
    L3机器，该机器在指定的域上执行了一个强烈的足迹，如*图8*所示：
- en: '![](img/1b9c9357-a456-498e-a895-70738d4913ce.png)'
  id: totrans-94
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1b9c9357-a456-498e-a895-70738d4913ce.png)'
- en: 'Figure 8: Running a machine within Maltego'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 图8：在Maltego中运行机器
- en: 'Once the scan has completed, you will be presented with a wealth of information.
    In this example, I performed an information-gathering scan on one of my personal
    domains. Maltego was able to pick up other domains hosted on my hosting companies''
    shared DNS, my domain''s website, shared public IP, MX records, and much more
    as shown in *Figure 9*:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描完成后，您将获得大量信息。在此示例中，我对我的个人域名进行了信息收集扫描。Maltego能够捕捉到托管在我的托管公司共享DNS上的其他域，我的域的网站，共享的公共IP，MX记录等，如*图9*所示：
- en: '![](img/3937570a-df57-4a07-9ba0-2427c435d173.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3937570a-df57-4a07-9ba0-2427c435d173.png)'
- en: 'Figure 9: Information gathered by Maltego'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 图9：Maltego收集的信息
- en: You will notice that the graph is very large. For illustration purposes, I have
    zoomed into the data related to my domain. You can perform this test on your own
    personal domain and observe the results that Maltego presents.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 您会注意到图表非常大。出于说明目的，我已经放大了与我的域相关的数据。您可以在自己的个人域上执行此测试，并观察Maltego呈现的结果。
- en: Maltego is extremely useful for information gathering. When you make use of
    the additional transforms, it will allow you to obtain a lot of information about
    your target.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: Maltego对信息收集非常有用。当您使用额外的变换时，它将允许您获取有关目标的大量信息。
- en: Active information gathering
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 主动信息收集
- en: Active information gathering is when we start to interact with systems so that
    we can gather more information. During active information gathering, it is possible
    to trip alarms that will alert the target, so depending on the type of attack
    being planned, you need to exercise caution.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 主动信息收集是指我们开始与系统进行交互，以便收集更多信息。在主动信息收集期间，有可能触发警报，从而警告目标，因此，根据计划的攻击类型，您需要谨慎行事。
- en: Some penetration tests intentionally trip alarms to test the effectiveness of
    alerts, logs, or even the response times of the countermeasures that are in place.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 一些渗透测试有意触发警报，以测试警报、日志甚至现有对策的响应时间的有效性。
- en: Nmap
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Nmap
- en: '**Network mapper** (**Nmap**) is a tool that allows you to perform network
    discovery and security auditing. It is only available in the command line, and
    has a graphical version called **Zenmap.** Nmap is able to work across multiple
    platforms, such as macOS, Windows, and Linux. Nmap is very robust in that it provides additional
    functionality by not only allowing you to detect open ports, but also allowing
    you to detect the operating system and services running on your target. Nmap is
    included in Kali Linux by default. Nmap can be used to perform the following:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络映射器**（**Nmap**）是一种允许您进行网络发现和安全审计的工具。它仅在命令行中可用，并且有一个名为**Zenmap**的图形版本。Nmap能够跨多个平台工作，如macOS、Windows和Linux。Nmap非常强大，不仅可以检测开放端口，还可以检测目标上运行的操作系统和服务，Kali
    Linux默认包含Nmap。Nmap可用于执行以下操作：'
- en: '**Network discovery**: This allows you to detect any live hosts on the target
    network'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**网络发现**：允许您检测目标网络上的任何活动主机'
- en: '**Port discovery**: This allows the detection of open ports'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**端口发现**：允许检测开放端口'
- en: '**Service discovery**: This provides the ability to detect software versions
    tied to a specific port'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务发现**：提供检测与特定端口相关的软件版本的能力'
- en: '**Operating system discovery**: This provides information on the running operating
    system and version'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**操作系统发现**：提供正在运行的操作系统和版本的信息'
- en: '**Vulnerability scanning**: This provides the ability to detect vulnerabilities
    using scripts'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**漏洞扫描**：提供使用脚本检测漏洞的能力'
- en: 'Nmap has a number of scanning options that you can use. Some of the common
    scans are as follows:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap有许多扫描选项可供使用。以下是一些常见的扫描：
- en: '`-sS`: This is a TCP SYN scan. This scan is one of the most commonly used scan
    types, as it offers stealth by not completing the TCP connection.'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-sS`：这是一个TCP SYN扫描。这种扫描是最常用的扫描类型之一，因为它通过不完成TCP连接来提供隐蔽性。'
- en: '`-sT`: This is a TCP connect scan. This scan performs a complete connection
    to the target port, which can lead to detection by the target.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`-sT`：这是一个TCP连接扫描。这种扫描对目标端口进行完整连接，可能会被目标检测到。'
- en: '`-sU`: This performs a scan over the UDP protocol. Using this scan, you can
    uncover ports related to DHCP, DNS, SNMP, and so on.'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -sU：这执行了对UDP协议的扫描。使用这种扫描，您可以发现与DHCP、DNS、SNMP等相关的端口。
- en: '`-p`: This defines a specific port or port range. Ranges are separated by a
    dash, `-`. If you do not specify a port or range, the scan will scan all 65,535
    ports.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -p：定义特定的端口或端口范围。范围用破折号`-`分隔。如果不指定端口或范围，扫描将扫描所有的65,535个端口。
- en: '`-sC`: This performs a scan using the default set of scripts.'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -sC：使用默认的脚本集执行扫描。
- en: '`-sV`: This performs version detection by referencing the port to the Nmap
    services database of well-known services. Once the reference is made, Nmap is
    able to display the service that is running on the port. Although this linking
    is very accurate, you might find a case where admins link different applications
    to common ports.'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '-sV：通过引用Nmap服务数据库中的知名服务，执行版本检测。一旦引用完成，Nmap就能够显示在端口上运行的服务。尽管这种链接非常准确，但您可能会发现管理员将不同的应用程序链接到常用端口的情况。 '
- en: '`-O`: This performs operating system detection by sending a number of crafted
    packets (such as TCP sampling, window check sizes, and IP options) and comparing
    them to the `nmap-os-db`. Once there is a match, Nmap will display the operating
    system of the target.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: -O：通过发送一些精心制作的数据包（如TCP采样、窗口检查大小和IP选项）并将它们与`nmap-os-db`进行比较，执行操作系统检测。一旦匹配，Nmap将显示目标的操作系统。
- en: '`--script`: This defines scripts using a comma-separated list for different
    categories, names, and directories. For example, `--script "http-*"` will load
    every script which deals with http. `--script "default,safe"` will load scripts
    that are in the **default** and **safe** category.'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: --script：使用逗号分隔的列表来定义脚本，用于不同的类别、名称和目录。例如，`--script "http-*"`将加载处理http的每个脚本。`--script
    "default,safe"`将加载**default**和**safe**类别中的脚本。
- en: SANS currently has a good Nmap cheat sheet that you can use for reference. This
    is located here: [https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf](https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf).
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: SANS目前有一份很好的Nmap备忘单供您参考。它位于这里：[https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf](https://blogs.sans.org/pen-testing/files/2013/10/NmapCheatSheetv1.1.pdf)。
- en: Nmap was originally used for port scanning, but the tool has evolved beyond
    that and is now capable of performing vulnerability scans too. Leveraging the
    **Nmap Scripting Engine** (**NSE**) allows you to write your own scripts, and
    use scripts that are freely available. Within Kali Linux, there are a number of
    scripts that can be found at the `/usr/share/nmap/scripts` location. There are
    various categories for the scripts, such as information gathering, vulnerability
    scanning, brute force, and so on. To view a full list of scripts that are currently
    available within Kali Linux, you can run the `ls /usr/share/nmap/scripts` command
    from a Terminal window within Kali Linux. Alternatively, you can use the `locate`
    command, which you learned about in the previous chapter: `locate *.nse`.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: Nmap最初用于端口扫描，但该工具已经发展到可以执行漏洞扫描。利用**Nmap脚本引擎**（**NSE**）允许您编写自己的脚本，并使用免费提供的脚本。在Kali
    Linux中，可以在`/usr/share/nmap/scripts`位置找到许多脚本。脚本有各种类别，如信息收集、漏洞扫描、暴力破解等。要查看当前在Kali
    Linux中可用的脚本的完整列表，可以在Kali Linux中的终端窗口中运行`ls /usr/share/nmap/scripts`命令。或者，您可以使用您在上一章学到的`locate`命令：`locate
    *.nse`。
- en: 'If you are unsure of what a script does, you can use the `nmap -script-help
    [script name]` command, as shown in *Figure 10*:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您不确定脚本的作用，可以使用`nmap -script-help [script name]`命令，如*图10*所示：
- en: '![](img/f28173e2-7418-4f84-84ca-af1d1663992c.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](img/f28173e2-7418-4f84-84ca-af1d1663992c.png)'
- en: 'Figure 10: Nmap script help'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 图10：Nmap脚本帮助
- en: 'Let''s perform a few scans against the Metasploitable 2 virtual machine. Ensure
    that both your Kali Linux and Metasploitable 2 virtual machines are on the same
    virtual network:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们对Metasploitable 2虚拟机执行一些扫描。确保您的Kali Linux和Metasploitable 2虚拟机都在同一个虚拟网络上：
- en: We will perform some network discovery using the `netdiscover` command from
    a Terminal window in Kali Linux. After some time, your Metasploitable 2 IP address
    will be displayed.
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用Kali Linux终端窗口中的`netdiscover`命令进行一些网络发现。过一段时间，您的Metasploitable 2 IP地址将被显示出来。
- en: 'We will run a basic TCP SYN scan against the Metasploitable 2 virtual machine
    using the `nmap -sS [ip address]`command. Once the scan has completed, we will
    be presented with a list of all open ports, as shown in *Figure 11*. In the output,
    we are presented with the current list of open ports. But let''s combine some
    more parameters to obtain richer results:'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将使用`nmap -sS [ip address]`命令对Metasploitable 2虚拟机进行基本的TCP SYN扫描。扫描完成后，我们将看到所有开放端口的列表，如*图11*所示。在输出中，我们看到了当前的开放端口列表。但让我们结合一些更多的参数来获得更丰富的结果：
- en: '![](img/a674921f-7341-41cb-9fb4-a5a667f37c93.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a674921f-7341-41cb-9fb4-a5a667f37c93.png)'
- en: 'Figure 11: Nmap TCP SYN scan'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 图11：Nmap TCP SYN扫描
- en: Note that `nfs` port `2049`/TCP is open on Metasploitable 2\. Using the file
    browser, you can navigate to `nfs://[IP]` of your Metasploitable 2 virtual machine.
    You will have access to the filesystem without authentication. You can leverage
    this vulnerability and browse to `/etc/` and copy the `shadow` and `passwd` files
    to your Kali Linux. You will use these files in [Chapter 6](72d35b3e-36f2-487f-b143-d228b9e3c77f.xhtml),* Understanding
    Password Attacks.*
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，Metasploitable 2上的`nfs`端口`2049`/TCP是开放的。使用文件浏览器，您可以导航到您的Metasploitable 2虚拟机的`nfs://[IP]`。您将可以在没有身份验证的情况下访问文件系统。您可以利用这个漏洞并浏览到`/etc/`，并将`shadow`和`passwd`文件复制到您的Kali
    Linux。您将在[第6章](72d35b3e-36f2-487f-b143-d228b9e3c77f.xhtml)中使用这些文件，*理解密码攻击*。
- en: 'Using the `nmap -sS -sV -O -sU [ip address]` command, we are able to obtain
    results, which provide a lot more information. You will notice that we can now
    see the service version tied to the port numbers for both **TCP** and **UDP**,
    as well as the operating system''s information, as shown in *Figure 12*:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`nmap -sS -sV -O -sU [IP地址]`命令，我们能够获得更多信息的结果。您会注意到，我们现在可以看到与**TCP**和**UDP**端口号相关的服务版本，以及操作系统的信息，如*图12*所示：
- en: '![](img/ac81f01f-3085-4cdb-a475-2f69ce7fab8b.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ac81f01f-3085-4cdb-a475-2f69ce7fab8b.png)'
- en: 'Figure 12: An Nmap scan combining various scan options'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 图12：Nmap扫描结合各种扫描选项
- en: 'Since this version of Metasploitable has an Apache server running, let''s leverage
    a script to provide us with even more information. Using the `nmap --script http-enum.nse
    [IP address]`command, we are able to detect information related to the open HTTP
    ports, as shown in *Figure 13*:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 由于这个版本的Metasploitable正在运行Apache服务器，让我们利用一个脚本为我们提供更多信息。使用`nmap --script http-enum.nse
    [IP地址]`命令，我们能够检测与开放的HTTP端口相关的信息，如*图13*所示：
- en: '![](img/09bf135e-7090-4d7e-bb9b-132bc1fbbfcc.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](img/09bf135e-7090-4d7e-bb9b-132bc1fbbfcc.png)'
- en: 'Figure 13: Nmap displaying the open ports of a machine in the Terminal'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 图13：Nmap在终端中显示机器的开放端口
- en: You can perform an Nmap scan using the switches in step 3 toward your Metasploitable
    3 system, but you will need to add in `-oX`, which exports the output to an `.xml`
    file. In [Chapter 5](8c5306b6-5c1e-4554-a839-5b2422286120.xhtml), *Diving into
    the Metasploit Framework*, you will use this.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用第3步中的开关对Metasploitable 3系统执行Nmap扫描，但是您需要添加`-oX`，将输出导出到一个`.xml`文件中。在[第5章](8c5306b6-5c1e-4554-a839-5b2422286120.xhtml)中，*深入Metasploit框架*，您将使用这个。
- en: By having a good understanding of Nmap, you can really benefit when performing
    a penetration test. Ensure that you have practiced various scans within your lab,
    so that you gain a good understanding of the outputs and how to use different
    scans in specific situations.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 通过对Nmap有很好的理解，您在进行渗透测试时可以获益良多。确保您在实验室内进行了各种扫描的练习，以便您对输出和如何在特定情况下使用不同的扫描有很好的理解。
- en: Vulnerability scanning
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 漏洞扫描
- en: Once you have gathered the necessary information, it's time to start performing
    some additional research around the vulnerabilities that exist. Vulnerability
    scans are done using software such as Nessus and OpenVAS, to name a couple. Typically,
    a vulnerability scanner will have signatures that tie into specific vulnerabilities.
    Once the scanner has been run and completed, you will be presented with a report
    that shows all the vulnerabilities related to a specific system. Vulnerability
    scanners are only able to detect the **known**vulnerabilities; anything that is **unknown**will
    not be detected by the vulnerability scanner. Vulnerability scanners are crucial
    to have within your penetration testing toolkit. They often expose vulnerabilities
    that you might have overlooked.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您收集了必要的信息，就是时候开始对现有的漏洞进行一些额外的研究了。漏洞扫描使用诸如Nessus和OpenVAS之类的软件。通常，漏洞扫描器将具有与特定漏洞相关的签名。一旦扫描器运行并完成，您将收到一份报告，显示与特定系统相关的所有漏洞。漏洞扫描器只能检测**已知**的漏洞；任何**未知**的漏洞都不会被漏洞扫描器检测到。漏洞扫描器在您的渗透测试工具包中至关重要。它们经常会暴露您可能忽视的漏洞。
- en: Let's take a look at a few vulnerability scanners that you can use in your penetration
    tests.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看一些您可以在渗透测试中使用的漏洞扫描器。
- en: OpenVAS
  id: totrans-142
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: OpenVAS
- en: 'OpenVAS is an open source vulnerability scanner that comes in both free and
    paid versions. The aim of OpenVAS is to be an all-in-one vulnerability scanner
    that leverages a variety of built-in tests. OpenVAS contains more than 50,000
    **network vulnerability tests** (**NVTS**) as of January 2019, and it is constantly
    growing. OpenVAS is not installed by default on Kali Linux, so you will need to
    install it. To install OpenVAS, you need to follow these steps:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: OpenVAS是一个开源的漏洞扫描器，有免费和付费版本。OpenVAS的目标是成为一个集成各种内置测试的全能漏洞扫描器。截至2019年1月，OpenVAS包含超过50,000个网络漏洞测试（NVTS），并且不断增长。Kali
    Linux默认未安装OpenVAS，因此您需要安装它。要安装OpenVAS，您需要按照以下步骤进行：
- en: From a Kali Linux Terminal window, download OpenVAS using the `apt-get install
    openvas` command. This will connect to the OpenVAS repository and download the
    required files.
  id: totrans-144
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从Kali Linux终端窗口，使用`apt-get install openvas`命令下载OpenVAS。这将连接到OpenVAS存储库并下载所需的文件。
- en: 'Once the download completes, it''s time to install OpenVAS using the `openvas-setup` command.
    This will begin the installation process of OpenVAS and download the NVT feeds.
    Once the installation has completed, there will be a system-generated password
    presented at the end. Take note of this as you will need it to log in to OpenVAS
    and change the password to something you desire as shown in *Figure 14*:'
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下载完成后，是时候使用`openvas-setup`命令安装OpenVAS了。这将开始OpenVAS的安装过程并下载NVT feeds。安装完成后，最后会显示一个系统生成的密码。请注意这一点，因为您需要用它登录OpenVAS并将密码更改为您想要的内容，如*图14*所示：
- en: '![](img/cb64bd9f-eeb1-4409-be75-e1be4dac7243.png)'
  id: totrans-146
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cb64bd9f-eeb1-4409-be75-e1be4dac7243.png)'
- en: 'Figure 14: OpenVAS installation completed with login details presented on screen'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 图14：OpenVAS安装完成，屏幕上显示登录详细信息
- en: 'If you forgotten your OpenVAS username and password, you can change them using
    the following command:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您忘记了OpenVAS的用户名和密码，可以使用以下命令更改它们：
- en: '`openvasmd –user=[username]–new-password=[password]`'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: '`openvasmd –user=[用户名]–new-password=[密码]`'
- en: So, for example, you might use `openvasmd –user=admin –new-password=Sup3rS3cretPa55w0rd`.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，例如，您可以使用`openvasmd –user=admin –new-password=Sup3rS3cretPa55w0rd`。
- en: 'Once the installation has completed and you have logged into the user interface
    of OpenVAS, you can perform a vulnerability scan by clicking on the Scans tab
    on the top navigation bar. To perform a new scan, you can use the **task ****wizard **or **create
    a new task** button. These buttons are depicted by the wand (**task wizard**)and star (**create
    new task**)**.**Let''s create a task so that we can perform a vulnerability scan
    on Metasploit 2\. Using the **create new task** function, we can define the name
    of the task and define the target, as shown in *Figure 15*:'
  id: totrans-151
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 安装完成并登录到OpenVAS的用户界面后，您可以通过点击顶部导航栏上的“扫描”选项卡执行漏洞扫描。要执行新的扫描，您可以使用**任务向导**或**创建新任务**按钮。这些按钮由魔杖（**任务向导**）和星号（**创建新任务**）表示。让我们创建一个任务，以便我们可以对Metasploit
    2进行漏洞扫描。使用**创建新任务**功能，我们可以定义任务的名称并定义目标，如*图15*所示。
- en: '![](img/2acd274c-48d0-46d0-9ff1-a0eca7d8accd.png)'
  id: totrans-152
  prefs: []
  type: TYPE_IMG
  zh: '![](img/2acd274c-48d0-46d0-9ff1-a0eca7d8accd.png)'
- en: 'Figure 15: New OpenVAS task creation'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 图15：新的OpenVAS任务创建
- en: Once the task has been created, you can run it using the green play icon in
    the Actions section of the task.
  id: totrans-154
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦任务创建完成，您可以在任务的“操作”部分使用绿色播放图标来运行它。
- en: 'Once the task has completed, you will be presented with a dashboard showing
    you a high-level view of the results. Click on the Reports section, as shown in *Figure
    16*:'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 任务完成后，您将看到一个仪表板，显示结果的高层视图。点击“报告”部分，如*图16*所示：
- en: '![](img/cc60b569-55ad-4bb0-86eb-b4ec705953a1.png)'
  id: totrans-156
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cc60b569-55ad-4bb0-86eb-b4ec705953a1.png)'
- en: 'Figure 16: High-level overview'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 图16：高层概述
- en: 'Once you are in the Reports overview, to view the full report of the scan,
    you will need to click on the scan Date, as shown in *Figure 17*:'
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦您在报告概述中，要查看扫描的完整报告，您需要点击扫描日期，如*图17*所示：
- en: '![](img/1f6aff22-abe7-4f05-b281-367a3b8d613c.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1f6aff22-abe7-4f05-b281-367a3b8d613c.png)'
- en: 'Figure 17: Report overview'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 图17：报告概述
- en: 'Now, you will have a full list of all the vulnerabilities that were discovered
    by OpenVAS, as shown in *Figure 18*:'
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在，您将获得OpenVAS发现的所有漏洞的完整列表，如*图18*所示：
- en: '![](img/9015db48-8acc-4047-940b-1a19de45909e.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](img/9015db48-8acc-4047-940b-1a19de45909e.png)'
- en: 'Figure 18: A report of found vulnerabilities'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 图18：发现漏洞的报告
- en: Once you have the report, you are able to expand the vulnerability to see the
    full details of it. OpenVAS provides you with the solution type (such as a vendor
    fix or workaround) and **quality of detection** (**QoD**).
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您获得报告，您可以展开漏洞以查看其完整细节。OpenVAS为您提供解决方案类型（如供应商修复或解决方法）和**检测质量**（**QoD**）。
- en: I encourage you to perform a vulnerability scan of your own network or host
    using OpenVAS so that you can become more familiar with this vulnerability scanner.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 我鼓励您使用OpenVAS对自己的网络或主机执行漏洞扫描，以便更熟悉这个漏洞扫描器。
- en: Nessus
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Nessus
- en: Nessus is one of the most popular vulnerability scanners on the market. Like
    other vulnerability scanners, Nessus contains a database of known vulnerabilities
    across different platforms and protocols. Nessus is available in both the paid
    version (commonly used by penetration testers and in-house security departments
    to perform vulnerability scans) and the free version, which is called Nessus Home.
    In this book, we will use Nessus Home, which is limited to scanning only a few
    IP addresses. Since Nessus is not installed by default in Kali Linux, we will
    need to install it.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus是市场上最受欢迎的漏洞扫描器之一。与其他漏洞扫描器一样，Nessus包含了跨不同平台和协议的已知漏洞的数据库。Nessus有付费版本（通常由渗透测试人员和内部安全部门用于执行漏洞扫描）和免费版本，称为Nessus
    Home。在本书中，我们将使用Nessus Home，它只能扫描几个IP地址。由于Kali Linux默认未安装Nessus，我们需要安装它。
- en: 'Follow these steps to do so:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下步骤执行：
- en: Navigate to [https://www.tenable.com/products/nessus-home](https://www.tenable.com/products/nessus-home)
    and register for an activation code for Nessus Home. Once you complete the registration,
    you will have the option to download Nessus. The direct link for the Nessus download
    page is [https://www.tenable.com/downloads/nessus#download](https://www.tenable.com/downloads/nessus#download).
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 转到[https://www.tenable.com/products/nessus-home](https://www.tenable.com/products/nessus-home)注册Nessus
    Home的激活码。注册完成后，您将有下载Nessus的选项。Nessus下载页面的直接链接是[https://www.tenable.com/downloads/nessus#download](https://www.tenable.com/downloads/nessus#download)。
- en: Download the version titled Debian 6, 7, 8, 9/Kali Linux 1, 2017.3 AMD64, or Debian
    6, 7, 8, 9/Kali Linux 1, 2017.3 i386 (32-bit), depending on your Kali Linux architecture.
    Although the software version displayed a previous version of Kali Linux, it will
    work in the current version that's used throughout this book, which is version
    2019.1.
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 根据您的Kali Linux架构下载标题为Debian 6, 7, 8, 9/Kali Linux 1, 2017.3 AMD64或Debian 6,
    7, 8, 9/Kali Linux 1, 2017.3 i386（32位）的版本。尽管软件版本显示为Kali Linux的旧版本，但它将在本书中使用的当前版本（2019.1版）中运行。
- en: 'Once you have downloaded the correct version, you can install it within Kali
    Linux by navigating to your download directory and using the `dpkg -I`command.
    The installation should be relatively quick. Once completed, you will be presented
    with the summary, as shown in *Figure 19*:'
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 一旦下载了正确的版本，您可以通过导航到下载目录并使用`dpkg -I`命令在Kali Linux中安装它。安装应该相对快速。完成后，您将看到摘要，如*图19*所示：
- en: '![](img/7cb7ab1c-cf99-4367-ab3d-00551891f26d.png)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/7cb7ab1c-cf99-4367-ab3d-00551891f26d.png)'
- en: 'Figure 19: Nessus installation'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 图19：Nessus安装
- en: Start the Nessus scanner by running the `/etc/init.d/nessusd start` or `service
    nessusd start` commands and navigate to the graphical interface, which is located
    at `https://kali:8834`using Firefox ESR, which is built in to Kali Linux.
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 通过运行`/etc/init.d/nessusd start`或`service nessusd start`命令启动Nessus扫描器，并使用内置于Kali
    Linux中的Firefox ESR导航到位于`https://kali:8834`的图形界面。
- en: The URL for the graphical interface might differ in your environment. Please
    take note of the summary once the installation completes.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 图形界面的URL可能在您的环境中有所不同。请注意安装完成后的摘要。
- en: 'Once Nessus has been started and you navigate to the administrator URL, you
    will be presented with some options to create a new user account. After the account
    has been created, Nessus will perform some post-installation tasks, such as installing
    plugins. Once all of the tasks are completed, you will be able to log in to the
    admin portal, as shown in *Figure 20*:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦Nessus启动并导航到管理员URL，您将看到一些选项来创建新的用户帐户。帐户创建后，Nessus将执行一些安装后任务，如安装插件。完成所有任务后，您将能够登录到管理员门户，如*图20*所示：
- en: '![](img/418cb2e6-4411-4f58-9d01-90767bf6e1f7.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](img/418cb2e6-4411-4f58-9d01-90767bf6e1f7.png)'
- en: 'Figure 20: The Nessus admin portal'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 图20：Nessus管理员门户
- en: 'Let''s perform a vulnerability scan on a Metasploitable 2 virtual machine (which
    you learned about in [Chapter 1](b37fecb9-6e3e-4ce0-8937-eb376e474bf9.xhtml),
    *Introduction to Penetration Testing*). To get your Metasploitable 2 virtual machine
    up and running, open `metasploitable.vmx` with your hypervisor (in my case, I
    am using VMware Fusion). Once Metasploitable 2 loads, log in using the default
    username and password of `msfadmin` and issue the `ifconfig` command to display
    the IP address of the virtual machine, as shown in *Figure 21*. Make sure that
    Kali Linux is on the same virtual network as Metasploitable:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们对Metasploitable 2虚拟机执行漏洞扫描（您在[第1章](b37fecb9-6e3e-4ce0-8937-eb376e474bf9.xhtml)中了解到的，*渗透测试简介*）。要启动并运行您的Metasploitable
    2虚拟机，请使用您的超级管理程序打开`metasploitable.vmx`（在我的情况下，我正在使用VMware Fusion）。一旦Metasploitable
    2加载完成，使用默认用户名和密码`msfadmin`登录，并发出`ifconfig`命令以显示虚拟机的IP地址，如*图21*所示。确保Kali Linux与Metasploitable在同一个虚拟网络上：
- en: '![](img/0482cc27-e1f4-4ef3-acd3-3708b4c4283f.png)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0482cc27-e1f4-4ef3-acd3-3708b4c4283f.png)'
- en: 'Figure 21: Metasploitable 2 IP address'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 图21：Metasploitable 2 IP地址
- en: From the Nessus admin portal, select New Scan. You will be presented with a
    number of scan templates. A scan template is a set of predefined tasks that you
    can quickly leverage for a specific type of scan. Some templates are only available
    in the paid license version of Nessus. For our demo, we will use the Basic Network
    Scan template. Once we've selected this template, we will be presented with a
    number of options.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 从Nessus管理员门户选择新的扫描。您将看到许多扫描模板。扫描模板是一组预定义的任务，您可以快速利用它们进行特定类型的扫描。一些模板仅在Nessus的付费许可版本中可用。对于我们的演示，我们将使用基本网络扫描模板。选择了这个模板后，我们将看到许多选项。
- en: 'Under the Settings tab, in the General section, we will provide inputs for
    the Name, Description, and Targets fields, as shown in *Figure 22*:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在“设置”选项卡中，在“常规”部分，我们将提供“名称”、“描述”和“目标”字段的输入，如*图22*所示：
- en: '![](img/e481c390-1a2b-403f-ad45-9371d529ac9a.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e481c390-1a2b-403f-ad45-9371d529ac9a.png)'
- en: 'Figure 22: Nessus scan general configuration'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图22：Nessus扫描常规配置
- en: 'The next section we will configure is under the Discovery section, and the
    Scan Type that we will select is Port Scan (common ports). After that, we will
    select Assessment and choose the Scan for all web vulnerabilities (complex) option.
    Lastly, we will click on Save. Once you have saved the scan, you will be directed
    back to the main admin page, where you can now select your saved scan and then
    click on the** L**aunch button. Your scan will now begin running and after a while,
    you will be presented with the output, as shown in *Figure 23*:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来我们要配置的部分是在“发现”部分下，我们将选择的扫描类型是端口扫描（常见端口）。之后，我们将选择“评估”并选择“扫描所有Web漏洞（复杂）”选项。最后，我们将点击“保存”。保存扫描后，您将被引导回主管理员页面，在那里您现在可以选择您保存的扫描，然后点击“启动”按钮。您的扫描现在将开始运行，过一会儿，您将看到输出，如*图23*所示：
- en: '![](img/48bb12bf-6e9e-47b8-8ad7-ad3391f7155e.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](img/48bb12bf-6e9e-47b8-8ad7-ad3391f7155e.png)'
- en: 'Figure 23: Nessus scan results'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 图23：Nessus扫描结果
- en: 'As we can see, Nessus found a number of vulnerabilities in Metasploitable 2\.
    Nessus places these findings in order of criticality. Nessus is able to provide
    detailed information about the findings. For example, by looking at one of the
    critical findings, we can see that Nessus provides information on exploitability.
    It even goes one step further and covers what the vulnerability is exploitable
    with, as shown in *Figure 24*:'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所看到的，Nessus在Metasploitable 2中发现了许多漏洞。Nessus按严重性对这些发现进行排序。Nessus能够提供有关发现的详细信息。例如，通过查看一个关键发现，我们可以看到Nessus提供了有关可利用性的信息。它甚至进一步介绍了漏洞可以利用的内容，如*图24*所示：
- en: '![](img/cb607157-26a4-45ff-96be-0dc04de08edf.png)'
  id: totrans-190
  prefs: []
  type: TYPE_IMG
  zh: '![](img/cb607157-26a4-45ff-96be-0dc04de08edf.png)'
- en: 'Figure 24: Nessus vulnerability information'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 图24：Nessus漏洞信息
- en: You can perform a Nessus scan on both Metasploitable 2 and 3 virtual machines.
    In [Chapter 5](8c5306b6-5c1e-4554-a839-5b2422286120.xhtml), *Diving into the Metasploit
    Framework*, you will use the Nessus scan of the Metasploitable 3 virtual machine.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以对Metasploitable 2和3虚拟机执行Nessus扫描。在[第5章](8c5306b6-5c1e-4554-a839-5b2422286120.xhtml)中，*深入了解Metasploit框架*，您将使用Nessus扫描Metasploitable
    3虚拟机。
- en: Nessus and OpenVAS are both excellent vulnerability scanners. It's important
    to note that as a penetration tester, knowing how to interpret the vulnerability
    assessment results is a key skill to have. Generally, verification of the results
    will need to be conducted manually to ensure that you have the full picture and
    can eliminate any false positives.
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus和OpenVAS都是优秀的漏洞扫描工具。重要的是要注意，作为渗透测试人员，了解如何解释漏洞评估结果是一项关键技能。通常，需要手动验证结果，以确保您获得全面的图片并消除任何错误的阳性。
- en: Capturing traffic
  id: totrans-194
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 捕获流量
- en: 'Learning how to use packet-capturing tools is vital for any security professional.
    We will cover two packet capturing tools in this section: Wireshark (GUI-based)
    and `tcpdump` (CLI-based).'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 学习如何使用数据包捕获工具对于任何安全专业人员来说都是至关重要的。在本节中，我们将介绍两种数据包捕获工具：Wireshark（基于GUI）和`tcpdump`（基于CLI）。
- en: Before we begin using these tools, let's take a step back to understand why
    there will be a need to capture traffic when performing a penetration test. Network
    traffic travels in packets, and each packet holds a number of fields that contain
    the information it needs to travel across the network and perform a certain function.
    Performing a packet capture (or packet sniffing) will allow you to view the structure
    of the packets, plus any data that is available. Some protocol traffic is unencrypted,
    such as FTP. This will allow you to see the username and password in clear text.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们开始使用这些工具之前，让我们退一步来理解在进行渗透测试时为什么需要捕获流量。网络流量以数据包形式传输，每个数据包包含一些字段，其中包含它需要在网络中传输并执行某个功能所需的信息。进行数据包捕获（或数据包嗅探）将允许你查看数据包的结构，以及任何可用的数据。一些协议流量是未加密的，比如FTP。这将允许你看到明文中的用户名和密码。
- en: Packet sniffing is a type of wire tap that is applied to computer networks.
    You can liken this to phone tapping, where a conversation is spied on.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 数据包嗅探是一种应用于计算机网络的窃听类型。你可以将其类比为电话窃听，其中一段对话被监听。
- en: Wireshark
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Wireshark
- en: Wireshark has been the prime choice for packet capturing for many users worldwide.
    It is a cross-platform tool that allows you to perform packet capturing and analysis.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark一直是全球许多用户进行数据包捕获的首选工具。它是一个跨平台工具，允许你进行数据包捕获和分析。
- en: 'Some of the main features of Wireshark are as follows:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark的一些主要特点如下：
- en: Live packet capture with analysis (offline analysis or on the fly)
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 实时数据包捕获与分析（离线分析或即时分析）
- en: Deep packet inspection
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 深度数据包检查
- en: Decryption support for protocols such as SSL/TLS, IPSEC, SNMPv3, Kerberos, WPA/WPA2,
    and more
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 诸如SSL/TLS、IPSEC、SNMPv3、Kerberos、WPA/WPA2等协议的解密支持
- en: Within Wireshark, you have the ability to apply a **capture filter** and a **display
    filter**. Understanding the differences between these two filters and how to apply
    them will help you capture the relevant packets and filter out the noise.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 在Wireshark中，你有能力应用**捕获过滤器**和**显示过滤器**。理解这两种过滤器之间的区别以及如何应用它们将帮助你捕获相关的数据包并过滤掉噪音。
- en: '**Capture filters** are used to reduce the size of the raw packet captures,
    while **display filters** are used to filter out what is captured and only display
    certain data. **Capture filters** are applied before the capture starts and cannot
    be changed during the capture. On the other hand, **display filters** can be applied
    at any time.'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: '**捕获过滤器**用于减少原始数据包捕获的大小，而**显示过滤器**用于过滤捕获的内容并只显示特定数据。**捕获过滤器**在捕获开始前应用，不能在捕获过程中更改。另一方面，**显示过滤器**可以随时应用。'
- en: 'Some **capture filters** can be very basic and simple. Let''s go over a few
    examples:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: 一些**捕获过滤器**可以非常基本和简单。让我们看几个例子：
- en: 'Capturing traffic for a specific host is as follows:'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 捕获特定主机的流量如下：
- en: '[PRE6]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Capturing traffic for a specific subnet is as follows:'
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 捕获特定子网的流量如下：
- en: '[PRE7]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Some **capture filters** can be complex, such as the one to detect the heart
    bleed exploit:'
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一些**捕获过滤器**可以很复杂，比如用于检测心脏出血漏洞的过滤器：
- en: '[PRE8]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '**Display filters** can also be basic. Let''s go over a few examples:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 显示过滤器也可以是基本的。让我们看几个例子：
- en: 'Displaying traffic for communication between a specific source and its destination
    is done as follows:'
  id: totrans-214
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 显示特定源和目的地之间通信的流量如下：
- en: '[PRE9]'
  id: totrans-215
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Looking for traffic on a specific port is done with the following command:'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找特定端口的流量使用以下命令：
- en: '[PRE10]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'In the following screenshot (*Figure 25*), I have marked the fields where you
    define a display and capture filter:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 在下面的截图（*图25*）中，我标记了定义显示和捕获过滤器的字段：
- en: '![](img/1204bce0-d9c4-4dd6-a65b-9fd5dbf82eeb.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![](img/1204bce0-d9c4-4dd6-a65b-9fd5dbf82eeb.png)'
- en: 'Figure 25: The display and capture filters'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 图25：显示和捕获过滤器
- en: 'Wireshark has the ability to display credentials in clear text for unencrypted
    traffic. For example, while capturing Telnet traffic, we can use Follow | TCP
    Stream to follow the TCP stream as shown in *Figure 26*:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: Wireshark有能力显示未加密流量中的明文凭据。例如，在捕获Telnet流量时，我们可以使用Follow | TCP Stream来跟踪TCP流，如*图26*所示：
- en: '![](img/ce4a8480-d9f0-40ec-af94-63b0d7802aac.png)'
  id: totrans-222
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ce4a8480-d9f0-40ec-af94-63b0d7802aac.png)'
- en: 'Figure 26: Using Follow | TCP Stream'
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: 图26：使用Follow | TCP Stream
- en: 'Note that by using the Follow | TCP Stream option, we are able to see the Username
    and Password in clear text, as shown in *Figure 27*:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，通过使用Follow | TCP Stream选项，我们能够看到明文中的用户名和密码，如*图27*所示：
- en: '![](img/0db19e2e-a20e-45e6-905c-5645aea5e464.png)'
  id: totrans-225
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0db19e2e-a20e-45e6-905c-5645aea5e464.png)'
- en: 'Figure 27: FTP credentials in clear text'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
  zh: 图27：明文的FTP凭证
- en: The preceding captures were taken from [http://packetlife.net/captures](http://packetlife.net/captures).
    You can find more packet captures that you can download for free to test out the
    functionality of Wireshark at [http://packetlife.net/captures/Wireshark](http://packetlife.net/captures/Wireshark).
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的捕获来自[http://packetlife.net/captures](http://packetlife.net/captures)。你可以在[http://packetlife.net/captures/Wireshark](http://packetlife.net/captures/Wireshark)找到更多可以免费下载以测试Wireshark功能的数据包捕获。
- en: Having the graphical interface of Wireshark makes it easier to work with packet
    captures. However, if you don't have the ability to use Wireshark, then you will
    need to know how to leverage a command-line packet capture tool such as `tcpdump`.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Wireshark的图形界面使得处理数据包捕获更容易。然而，如果你无法使用Wireshark，那么你需要知道如何利用命令行数据包捕获工具如`tcpdump`。
- en: tcpdump
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: tcpdump
- en: '`tcpdump` is the most widely used packet capture utility. It is available on
    Linux/Unix-based operating systems, which means it''s installed by default in
    Kali Linux. It has the abilities to save captures to a `.pcap` file and read `.pcap`
    files.'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: '`tcpdump`是最广泛使用的数据包捕获实用程序。它在Linux/Unix操作系统上可用，这意味着它在Kali Linux中默认安装。它有能力将捕获保存到`.pcap`文件并读取`.pcap`文件。'
- en: '`tcpdump` has a number of switches that you can use. Some of its common switches
    are as follows:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: '`tcpdump`有许多开关可以使用。它的一些常见开关如下：'
- en: '`tcpdump -d`: Displays a list of interfaces'
  id: totrans-232
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tcpdump -d`：显示接口列表'
- en: '`tcpdump -i [interface]`: Specifies an interface to perform the packet capture
    on'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tcpdump -i [interface]`：指定要在其上执行数据包捕获的接口'
- en: '`tcpdump -c`: Specifies the number of packets to capture'
  id: totrans-234
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tcpdump -c`：指定要捕获的数据包数量'
- en: '`tcpdump -w /path`: Defines a file that `tcpdump` should write to'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tcpdump -w /path`：定义`tcpdump`应写入的文件'
- en: '`tcpdump -r /path`: Reads a capture file'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tcpdump -r /path`：读取捕获文件'
- en: '`tcpdump -XX`: Captures packets in ASCII or HEX'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`tcpdump -XX`：以ASCII或HEX格式捕获数据包'
- en: 'The following is a practical example of using `tcpdump` to capture FTP traffic.
    Using `tcpdump`, you are able to see the username and password in clear text,
    as shown in *Figure 28*:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是使用`tcpdump`捕获FTP流量的实际示例。使用`tcpdump`，您可以看到明文中的用户名和密码，如*图28*所示：
- en: '![](img/0d629955-8fd3-4b77-ab4e-7fc0c03f75a9.png)'
  id: totrans-239
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0d629955-8fd3-4b77-ab4e-7fc0c03f75a9.png)'
- en: 'Figure 28: Login details in plain text'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 图28：明文登录详细信息
- en: You can replicate the preceding test by using a publicly accessible `ftp` server,
    which is used for speedtest. The URL is `speedtest.tele2.net`.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过使用一个公开可访问的`ftp`服务器来复制前面的测试，该服务器用于速度测试。URL是`speedtest.tele2.net`。
- en: Summary
  id: totrans-242
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we looked at information gathering and vulnerability scanning.
    We defined the difference between active and passive information gathering. We
    worked through the various tools that can be used for passive and active information
    gathering, and the tools that are needed for vulnerability scanning. Lastly, we
    worked through packet captures using graphical and command-line tools.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们看了信息收集和漏洞扫描。我们定义了主动和被动信息收集之间的区别。我们通过各种工具来进行被动和主动信息收集，并介绍了漏洞扫描所需的工具。最后，我们使用图形和命令行工具进行了数据包捕获。
- en: You now have the ability to perform information gathering using open source
    intelligence, which is passive information gathering. You have learned how to
    use Nmap for active information gathering, and how to leverage the Nmap scripting
    engine. You have gained the necessary skills to use vulnerability scanners such
    as OpenVAS and Nessus, and know how to perform a vulnerability scan to plan your
    attack. Packet capturing has taught you how to **sniff** traffic traversing a
    network, and how you can obtain valuable information from insecure protocols.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在可以使用开源情报进行信息收集，这是被动信息收集。您已经学会了如何使用Nmap进行主动信息收集，以及如何利用Nmap脚本引擎。您已经掌握了使用漏洞扫描器（如OpenVAS和Nessus）的必要技能，并知道如何执行漏洞扫描以规划攻击。数据包捕获教会了您如何**嗅探**网络中的流量，以及如何从不安全的协议中获取有价值的信息。
- en: In the next chapter ([Chapter 4](c9af5dc8-a2f6-41a7-98db-dd300fff396a.xhtml),
    *Mastering Social Engineering*), we will look at what social engineering is and
    the different tools that you can use to perform social engineering. We will leverage
    built-in tools within Kali Linux, along with some additional tools that will need
    to be installed.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章（[第4章](c9af5dc8-a2f6-41a7-98db-dd300fff396a.xhtml)，*精通社会工程*）中，我们将看看什么是社会工程以及您可以使用哪些不同工具来执行社会工程。我们将利用Kali
    Linux中的内置工具，以及一些需要安装的其他工具。
- en: Questions
  id: totrans-246
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: What is the difference between passive and active information gathering?
  id: totrans-247
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 被动信息收集和主动信息收集之间有什么区别？
- en: Name two tools that can be used for passive information gathering.
  id: totrans-248
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出两种可用于被动信息收集的工具。
- en: How has Nmap evolved from being a traditional port scanner?
  id: totrans-249
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Nmap如何从传统端口扫描器发展而来？
- en: Name two vulnerability scanners.
  id: totrans-250
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 列出两种漏洞扫描器。
- en: Why should you know how to perform packet capturing?
  id: totrans-251
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为什么您需要知道如何执行数据包捕获？
