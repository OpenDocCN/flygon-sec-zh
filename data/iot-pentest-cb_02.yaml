- en: IoT Threat Modeling
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 物联网威胁建模
- en: 'In this chapter, we will cover the following recipes:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖以下配方：
- en: Getting familiar with thread modeling concepts
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 熟悉威胁建模概念
- en: Anatomy of threat modeling a device
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁建模设备的解剖学
- en: Threat modeling firmware
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁建模固件
- en: Threat modeling an IoT web application
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁建模物联网Web应用
- en: Threat modeling an IoT mobile application
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁建模物联网移动应用
- en: Threat modeling IoT device hardware
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁建模物联网设备硬件
- en: Threat modeling IoT radio communication
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁建模物联网无线通信
- en: Introduction
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: Whether you have a software development background or system and networking
    background, you may be familiar with attack surfaces or vectors within each respective
    area. Attack surfaces refer to the many ways in which a device can be compromised
    via a source of input. This source of input may be via hardware, software, or
    wirelessly. Generally speaking, the more attack surfaces a device contains, the
    higher the likelihood of compromise. Attack surfaces are entry points into the
    IoT device. Sometimes, these entry points are inherently trusted by the IoT device
    or application. Each attack surface discovered will have an associated risk, likelihood,
    and impact. In essence, attack surfaces are threats which have the potential to
    negatively affect a device to perform unintended actions. In order to discover
    each attack surface, theoretical use cases will need to be thought of before testing
    has taken place, or before software is written. This exercise is known as threat
    modeling.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 无论您具有软件开发背景还是系统和网络背景，您可能都熟悉各自领域内的攻击面或向量。攻击面指的是设备可以通过输入源受到威胁的多种方式。这个输入源可以是通过硬件、软件或无线方式。一般来说，设备包含的攻击面越多，被威胁的可能性就越高。攻击面是物联网设备的入口点。有时，这些入口点被物联网设备或应用程序本身信任。发现的每个攻击面都将有相关的风险、可能性和影响。实质上，攻击面是可能对设备产生负面影响的威胁，使其执行意外操作。为了发现每个攻击面，需要在测试之前或软件编写之前考虑理论使用案例。这个练习被称为威胁建模。
- en: This chapter will discuss the basic principles of threat modeling and how it
    will help us with exploiting flaws in IoT devices. Recipes on how to conduct basic
    threat models for firmware, web applications, mobile applications, device hardware,
    and radio communication will be performed to get you started on the right track.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将讨论威胁建模的基本原则以及它如何帮助我们利用物联网设备中的缺陷。将执行有关如何对固件、Web应用程序、移动应用程序、设备硬件和无线通信进行基本威胁建模的配方，以帮助您正确入门。
- en: While the recipes in this chapter will give you an introduction into threat
    modeling, there are several books written on this topic. If supplemental reading
    is needed in order to understand the concept of threat modeling, by all means
    pick up a book on threat modeling or refer to third-party sources.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然本章的配方将为您介绍威胁建模，但关于这个主题已经有几本书写成。如果需要补充阅读以理解威胁建模的概念，务必阅读有关威胁建模的书籍或参考第三方来源。
- en: Getting familiar with threat modeling concepts
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 熟悉威胁建模概念
- en: Threat modeling is more or less associated with software development as an exercise
    that occurs after the software design phase but prior to software deployment.
    These exercises are known to take place in software development, system, network,
    and security teams upon major software releases by either drawing a full end-to-end
    data flow diagram or a data flow and network diagram to determine how to employ
    security controls and countermeasures. These drawings can be physically on a white
    board or via software tools such as Microsoft's free Threat Modeling Tool and
    web applications such as [https://draw.io](https://draw.io/) which have a number
    of template diagrams that can be used for a variety of purposes. The idea is to
    map out all of the device's functionalities and features to their associated technical
    dependencies. It is up to the company or individual how threat model formats are
    drawn out. Keep in mind that threat models can get really granular when breaking
    down components individually. The most important aspect of threat modeling is
    iteratively updating the document due to threats changing when features are added
    as well as when more knowledge is acquired about a certain technology employed.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁建模或多或少与软件开发相关，是在软件设计阶段之后但在软件部署之前进行的一种练习。这些练习通常在软件开发、系统、网络和安全团队中进行，这些团队会在主要软件发布时绘制完整的端到端数据流图或数据流和网络图，以确定如何使用安全控制和对策。这些图可以在白板上物理绘制，也可以通过诸如微软免费的威胁建模工具和Web应用程序（例如[https://draw.io](https://draw.io/)）等软件工具绘制，这些工具有许多模板图表可用于各种用途。其核心思想是将设备的所有功能和特性映射到其相关的技术依赖关系上。威胁模型的格式如何绘制取决于公司或个人。请记住，威胁模型在逐步更新文档时可以变得非常细化，因为随着功能的增加以及对某种技术的更多了解，威胁也会发生变化。
- en: Once the IoT device attack surface is drawn out, threat use cases have to be
    identified using methods such as STRIDE, which will be discussed later. These
    threats will need to be rated with a rating system to identify the risk of discovered
    threats. There are several threat rating systems, depending on the industry; however,
    the most common are DREAD and the **common vulnerability scoring system** (**CVSS**).
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦绘制出物联网设备的攻击面，就必须使用诸如STRIDE之类的方法来识别威胁使用案例，这将在后面讨论。这些威胁将需要使用评级系统进行评级，以确定发现威胁的风险。根据行业，有几种威胁评级系统；然而，最常见的是DREAD和**通用漏洞评分系统**（**CVSS**）。
- en: 'CVSS offers a more granular rating system with 14 scoring areas bundled in
    3 groups: base, temporal, and environmental. Each of the three groups is subdivided
    into subareas that consist of six for base, three for temporal, and five for environmental.
    CVSS can be quite useful for reporting vulnerabilities to vendors but may not
    be as straightforward for threat modeling purposes. To learn more about CVSS,
    please visit [https://www.first.org/cvss/user-guide](https://www.first.org/cvss/user-guide).'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: CVSS提供了一个更精细的评级系统，其中包括3组中的14个评分区域：基本、临时和环境。这三个组中的每一个都细分为包括基本的六个、临时的三个和环境的五个子区域。CVSS对于向供应商报告漏洞可能非常有用，但对于威胁建模目的可能不太直观。要了解有关CVSS的更多信息，请访问[https://www.first.org/cvss/user-guide](https://www.first.org/cvss/user-guide)。
- en: 'The DREAD rating system stands for the following:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: DREAD评级系统代表以下内容：
- en: '**Damage potential**: How great is the damage if exploited?'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**损害潜力**：如果被利用，损害有多大？'
- en: '**Reproducibility**: How easy is it to reproduce the attack?'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可重现性**：攻击有多容易重现？'
- en: '**Exploitability**: How easy is it to attack?'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可利用性**：攻击有多容易？'
- en: '**Affected users**: Roughly how many users are affected?'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**受影响用户**：大约有多少用户受到影响？'
- en: '**Discoverability**: How easy is it to find the vulnerability?'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**可发现性**：漏洞有多容易被发现？'
- en: DREAD has a risk rating system ranging from 1-3\. 1 is low risk, 2 is medium
    risk, and 3 is high risk.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: DREAD具有从1到3的风险评级系统。1是低风险，2是中等风险，3是高风险。
- en: 'The following table describes each rating number for each rating category:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格描述了每个评级类别的每个评级数字：
- en: '|  | **Rating** | **High (3)** | **Medium (2)** | **Low (1)** |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '|  | **评级** | **高（3）** | **中（2）** | **低（1）** |'
- en: '| **D** | Damage potential | Can subvert all security controls and get full
    trust to take over the whole IoT ecosystem. | Could leak sensitive information.
    | Could leak sensitive information. |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| **D** | 损害潜力 | 可以破坏所有安全控制并获得完全信任，接管整个物联网生态系统。 | 可能泄露敏感信息。 | 可能泄露敏感信息。 |'
- en: '| **R** | Reproducibility | The attack is always reproducible. | The attack
    can be reproduced only within a timed window or specific condition. | It''s very
    difficult to reproduce the attack, even with specific information about the vulnerability.
    |'
  id: totrans-27
  prefs: []
  type: TYPE_TB
  zh: '| **R** | 可重现性 | 攻击总是可重现的。 | 攻击只能在定时窗口或特定条件内重现。 | 即使有关漏洞的具体信息，也很难重现攻击。 |'
- en: '| **E** | Exploitability | A novice attacker could execute the exploit. | A
    skilled attacker could make the attack repeatedly. | Allows a skilled attacker
    with in-depth knowledge to perform the attack. |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
  zh: '| **E** | 可利用性 | 新手攻击者可以执行攻击。 | 熟练的攻击者可以重复进行攻击。 | 允许具有深入知识的熟练攻击者执行攻击。 |'
- en: '| **A** | Affected users | All users, default configurations, all devices.
    | Affects some users, some devices, and custom configurations. | Affects a small
    percentage of users and/or devices through an obscure feature. |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
  zh: '| **A** | 受影响用户 | 所有用户，默认配置，所有设备。 | 影响一些用户，一些设备和自定义配置。 | 通过模糊功能影响少部分用户和/或设备。
    |'
- en: '| **D** | Discoverability | Attack explanation can be easily found in a publication.
    | Affects a seldom-used feature where an attacker would need to be very creative
    to discover a malicious use for it. | Is obscure and unlikely an attacker would
    discover a way to exploit the bug. |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
  zh: '| **D** | 可发现性 | 攻击解释可以很容易在出版物中找到。 | 影响很少使用的功能，攻击者需要非常有创造力才能发现其恶意用途。 | 是模糊的，攻击者不太可能发现利用漏洞的方法。
    |'
- en: 'The STRIDE model groups threats into six categories in order to formulate questions
    to discover possible threats. The six threat categories are derived from the acronym
    STRIDE which is described as the following:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: STRIDE模型将威胁分为六类，以便提出问题来发现可能的威胁。这六种威胁类别源自缩写STRIDE，描述如下：
- en: '**Spoofing identity**: Spoofing is attempting to gain access to a system by
    using a false identity. This can be accomplished using stolen user credentials
    or a false IP address. After the attacker successfully gains access as a legitimate
    user or host, elevation of privileges or abuse using authorization can begin.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**欺骗身份**：欺骗是试图通过使用虚假身份来获取系统访问权限。这可以通过使用窃取的用户凭据或虚假IP地址来实现。在攻击者成功以合法用户或主机身份获得访问权限后，可以开始提升权限或滥用授权。'
- en: '**Tampering with data**: Tampering is the unauthorized modification of data,
    for example, as it flows over a network between two computers.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**篡改数据**：篡改是未经授权的数据修改，例如在两台计算机之间流动时。'
- en: '**Repudiation**: Repudiation is the ability of users (legitimate or otherwise)
    to deny that they performed specific actions or transactions. Without adequate
    auditing, repudiation attacks are difficult to prove.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**否认**：否认是用户（合法或非法）否认他们执行特定操作或交易的能力。如果没有充分的审计，否认攻击很难证明。'
- en: '**Information disclosure**: Information disclosure is the unwanted exposure
    of private data. For example, a user views the contents of a table or file he
    or she is not authorized to open, or monitors data passed in plain text over a
    network. Some examples of information disclosure vulnerabilities include the use
    of hidden form fields, comments embedded in web pages that contain database connection
    strings and connection details, and weak exception handling that can lead to internal
    system level details being revealed to the client. Any of this information can
    be very useful to the attacker.'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息泄露**：信息泄露是私人数据的意外暴露。例如，用户查看他或她未被授权打开的表格或文件的内容，或者监视通过网络以纯文本传递的数据。信息泄露漏洞的一些例子包括使用隐藏的表单字段，嵌入包含数据库连接字符串和连接详细信息的网页注释，以及弱异常处理可能导致内部系统级详细信息被泄露给客户端。攻击者可以利用这些信息中的任何信息。'
- en: '**Denial of service**: Denial of service is the process of making a system
    or application unavailable. For example, a denial of service attack might be accomplished
    by bombarding a server with requests to consume all available system resources
    or by passing it malformed input data that can crash an application process.'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**拒绝服务**：拒绝服务是使系统或应用程序不可用的过程。例如，拒绝服务攻击可能通过向服务器发送请求以消耗所有可用系统资源或通过传递格式错误的输入数据来使应用程序进程崩溃来实现。'
- en: '**Elevation of privileges**: Elevation of privilege occurs when a user with
    limited privileges assumes the identity of a privileged user to gain privileged
    access to an application. For example, an attacker with limited privileges might
    elevate his or her privilege level to compromise and take control of a highly
    privileged and trusted process or account.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**权限提升**：权限提升是指具有有限权限的用户假定特权用户的身份以获得对应用程序的特权访问。例如，具有有限权限的攻击者可能提升他或她的特权级别，以破坏并控制高度特权和受信任的进程或帐户。'
- en: 'Additional details for using STRIDE can be found via the following links:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 有关使用 STRIDE 的更多详细信息，请参阅以下链接：
- en: '[https://msdn.microsoft.com/en-us/library/ee823878(v=cs.20).aspx](https://msdn.microsoft.com/en-us/library/ee823878(v=cs.20).aspx)
    [https://msdn.microsoft.com/en-us/library/ff648641.aspx](https://msdn.microsoft.com/en-us/library/ff648641.aspx)'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://msdn.microsoft.com/en-us/library/ee823878(v=cs.20).aspx](https://msdn.microsoft.com/en-us/library/ee823878(v=cs.20).aspx)
    [https://msdn.microsoft.com/en-us/library/ff648641.aspx](https://msdn.microsoft.com/en-us/library/ff648641.aspx)'
- en: 'A great threat modeling approach is one provided by Microsoft which uses a
    multiple step process to determine the severity of threats introduced by a new
    application or system. The threat modeling process steps are outlined using the
    following figure:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 微软提供的一种很好的威胁建模方法使用了一个多步骤的过程来确定新应用程序或系统引入的威胁的严重程度。威胁建模过程的步骤如下图所示：
- en: '![](img/ed0ffd64-8085-4b47-b865-5cf8067b086b.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](img/ed0ffd64-8085-4b47-b865-5cf8067b086b.png)'
- en: 'Additional reading on Microsoft''s threat modeling process can be found via
    the following link:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 有关微软威胁建模过程的更多阅读，请参阅以下链接：
- en: '[https://msdn.microsoft.com/en-us/library/ff648644.aspx](https://msdn.microsoft.com/en-us/library/ff648644.aspx)'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://msdn.microsoft.com/en-us/library/ff648644.aspx](https://msdn.microsoft.com/en-us/library/ff648644.aspx)'
- en: We will apply STRIDE and DREAD to perform threat modeling exercises from a black
    box perspective and break down components in each recipe for an IoT device. When
    beginning any type of security testing, it is always best to threat model beforehand
    in order to ensure proper coverage of testing has taken place. It can also be
    fun to think of all the potential threat possibilities and categorize them as
    a brain exercise.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将应用 STRIDE 和 DREAD 来从黑盒的角度进行威胁建模练习，并在每个步骤中分解物联网设备的组件。在开始任何类型的安全测试时，最好先进行威胁建模，以确保测试的覆盖范围已经到位。想象所有潜在的威胁可能性并将它们分类作为一种大脑锻炼也是很有趣的。
- en: Getting ready
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: To step through ongoing threat model recipes in this chapter, we will utilize
    Microsoft's free Threat Modeling Tool and diagrams drawn from [https://draw.io](https://draw.io/).
    At the time of writing, Microsoft's Threat Modeling Tool 2016 can be downloaded
    from [https://www.microsoft.com/en-us/download/details.aspx?id=49168](https://www.microsoft.com/en-us/download/details.aspx?id=49168).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在本章中逐步进行威胁建模，我们将利用微软免费的威胁建模工具和从 [https://draw.io](https://draw.io/) 绘制的图表。在撰写本文时，可以从
    [https://www.microsoft.com/en-us/download/details.aspx?id=49168](https://www.microsoft.com/en-us/download/details.aspx?id=49168)
    下载微软的威胁建模工具 2016。
- en: How to do it...
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: 'For this recipe, we will work with Microsoft''s Threat Modeling Tool as it''s
    quite simple to draw network diagrams with:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个步骤中，我们将使用微软的威胁建模工具，因为使用它可以很容易地绘制网络图表：
- en: 'Start Microsoft''s Threat Modeling Tool 2016\. Select the Create A Model option:'
  id: totrans-49
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 启动微软的威胁建模工具 2016\. 选择“创建模型”选项：
- en: '![](img/b865a51c-3a5a-48ed-ade5-d1b933660e30.png)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
  zh: '![](img/b865a51c-3a5a-48ed-ade5-d1b933660e30.png)'
- en: 'Get familiar with the Stencils the tool provides to demonstrate devices, transport
    communication, as well as trust boundaries for inputs and outputs. Microsoft does
    provide a user guide on the different Stencils and options when the tool is downloaded
    although it is not required reading:'
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 熟悉工具提供的 Stencils，以展示设备、传输通信以及输入和输出的信任边界。微软在工具下载时提供了不同 Stencils 和选项的用户指南，尽管不是必需阅读：
- en: As of the 2016 version of Microsoft's Threat Modeling Tool, custom templates,
    and Stencils can be created to correlate threats more accurately.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 截至 2016 年版的微软威胁建模工具，可以创建自定义模板和 Stencils 以更准确地相关威胁。
- en: '![](img/a09af89d-24b2-4be3-8192-c0896586f372.png)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a09af89d-24b2-4be3-8192-c0896586f372.png)'
- en: 'Each of the Stencil properties can be modified according to device, network,
    or application:'
  id: totrans-54
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 每个 Stencil 属性都可以根据设备、网络或应用程序进行修改：
- en: '![](img/77b68beb-07ce-4c88-bff2-89f52a0a459d.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](img/77b68beb-07ce-4c88-bff2-89f52a0a459d.png)'
- en: 'At this stage, we would normally identify an IoT system''s assets from a high
    level and zero in on areas of interest once more knowledge is acquired about the
    device through research or reverse engineering. Identifying assets can be written
    out in a table format or via brainstorming visually. The following table shows
    a basic inventory of assets and a brief description about each asset:'
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在这个阶段，我们通常会从高层次识别物联网系统的资产，并在通过研究或逆向工程获得更多了解设备的知识后，再对感兴趣的领域进行深入研究。资产的识别可以以表格格式或通过可视化头脑风暴来书写。以下表格显示了资产的基本清单和每个资产的简要描述：
- en: '| **ID** | **Asset** | **Description** |'
  id: totrans-57
  prefs: []
  type: TYPE_TB
  zh: '| **ID** | **资产** | **描述** |'
- en: '| 1 | Doorbell | Smart doorbells monitor motion, alert users, and provide a
    real-time camera feed via applications. Data is stored on the doorbell itself
    as well as the application interfaces. The doorbell can connect via P2P with SIP/RTP
    if users view camera feeds locally in the network or connect to an application
    which utilizes STUN/TURN servers to gain access to camera feeds without the need
    for opening router ports. All data is transmitted to a router for remote access.
    |'
  id: totrans-58
  prefs: []
  type: TYPE_TB
  zh: 1 | 门铃 | 智能门铃监视运动，向用户发出警报，并通过应用程序提供实时摄像头视频。数据存储在门铃本身以及应用程序界面上。如果用户在网络中本地查看摄像头视频，门铃可以通过P2P与SIP/RTP连接，或者连接到使用STUN/TURN服务器的应用程序，以无需打开路由器端口即可访问摄像头视频。所有数据都传输到路由器以进行远程访问。
- en: '| 2 | LED bulbs | LED bulbs transmit data over Zigbee to an IoT hub to communicate
    over Wi-Fi. LEDs are controlled via an IoT hub or through an application interface.
    |'
  id: totrans-59
  prefs: []
  type: TYPE_TB
  zh: 2 | LED灯泡 | LED灯泡通过Zigbee传输数据到物联网中心，以便通过Wi-Fi进行通信。LED灯泡可以通过物联网中心或应用程序界面进行控制。
- en: '| 3 | Mobile applications | Mobile applications control various devices in
    the network. These mobile applications can be created directly from the device
    maker, or the IoT hub vendor. Device configuration data and secrets may reside
    in mobile applications. Data is transmitted via an API or web service to devices
    or backend systems. |'
  id: totrans-60
  prefs: []
  type: TYPE_TB
  zh: 3 | 移动应用程序 | 移动应用程序控制网络中的各种设备。这些移动应用程序可以直接由设备制造商或物联网中心供应商创建。设备配置数据和密钥可能存储在移动应用程序中。数据通过API或Web服务传输到设备或后端系统。
- en: '| 4 | IoT hub | The IoT hub aggregates all protocols into one device for ease
    of administration. Users can control devices via the IoT hub''s application interface.
    An IoT hub can connect wirelessly to the router or plug in via Ethernet. IoT hubs
    store configuration data and may send data externally to backend systems for processing.
    |'
  id: totrans-61
  prefs: []
  type: TYPE_TB
  zh: 4 | 物联网中心 | 物联网中心将所有协议聚合到一个设备中，以便进行简化管理。用户可以通过物联网中心的应用程序界面控制设备。物联网中心可以通过无线连接到路由器，也可以通过以太网插入连接。物联网中心存储配置数据，并可能将数据外部发送到后端系统进行处理。
- en: '| 5 | Router | All network communication is taken care of by the router. The
    router can block external access to devices or let traffic pass-through. |'
  id: totrans-62
  prefs: []
  type: TYPE_TB
  zh: 5 | 路由器 | 所有网络通信都由路由器处理。路由器可以阻止外部访问设备，也可以让流量通过。
- en: 'The following figure demonstrates an overview diagram of a smart home environment
    with a smart doorbell, LED bulbs, mobile application, and an IoT hub:'
  id: totrans-63
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下图示展示了一个智能家居环境的概述图，其中包括智能门铃、LED灯泡、移动应用程序和物联网中心：
- en: '![](img/260726cf-3398-41ae-9d64-57657b46c7a6.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](img/260726cf-3398-41ae-9d64-57657b46c7a6.png)'
- en: The example steps described are only the beginning of a threat modeling exercise.
    We discussed downloading Microsoft's Threat Model Tool and getting familiar with
    Stencils and their associated properties. We then moved toward identifying assets
    for a smart home environment with brief descriptions based upon research or forms
    of reverse engineering. Next, an example architecture diagram was given to visualize
    the assets identified. Our next steps will be the meat of threat modeling that
    will help break down each portion of an IoT system to help identity attack points,
    methods, and impact if a portion of an IoT system was to be exploited. As with
    many aspects of security, the greater your familiarity with the platform you plan
    on testing, the higher the probability of compromise will be.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 所描述的示例步骤只是威胁建模练习的开始。我们讨论了下载微软的威胁模型工具，并熟悉了图形符号及其相关属性。然后，我们开始识别智能家居环境的资产，并根据研究或逆向工程形式提供简要描述。接下来，给出了一个示例架构图，以可视化识别的资产。我们的下一步将是威胁建模的核心，将帮助分解IoT系统的每个部分，以帮助识别攻击点、方法和如果IoT系统的一部分被利用的影响。与安全的许多方面一样，您对计划测试的平台越熟悉，被攻击的可能性就越高。
- en: Anatomy of threat modeling an IoT device
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁建模物联网设备的解剖学
- en: In 2016, we witnessed mass exploitation of IoT devices that consisted of IP
    cameras and **digital video recorders** (**DVRs**) that contributed to the world's
    largest **distributed denial of service** (**DDoS**) ever recorded. This DDoS
    was possible due to vendor negligence that could have been prevented by basic
    threat model exercises. Considering the prevalence of these types of devices on
    the internet and the risk they pose to the internet, we will conduct a threat
    modeling exercise and walk through the threat modeling process for a *connected
    DVR IP camera security system*. These connected security systems can be purchased
    by consumers or small/medium size businesses via e-commerce sites as well as through
    a number of electronic stores for a fairly low price. Connected DVRs are a good
    example of an IoT system because they contain a number of entry points into the
    device in order to view camera feeds and can be connected to a third-party provider
    to utilize remote viewing without opening ports on your network. Gathering details
    about an IoT device and its applications from a black box perspective can be a
    bit tricky. However, there may be plenty of resources on the product available
    online to help with this exercise.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 2016年，我们目睹了由IP摄像头和数字视频录像机（DVR）组成的大规模IoT设备的大规模利用，这导致了有史以来最大的分布式拒绝服务（DDoS）。这次DDoS是由于供应商的疏忽造成的，这本可以通过基本的威胁模型练习来防止。考虑到这些类型的设备在互联网上的普遍存在以及它们对互联网的风险，我们将进行威胁建模练习，并走过连接的DVR
    IP摄像头安全系统的威胁建模过程。这些连接的安全系统可以通过电子商务网站以及许多电子商店以相对较低的价格购买。连接的DVR是IoT系统的一个很好的例子，因为它们包含许多进入设备的入口，以便查看摄像头视频，并可以连接到第三方提供商以利用远程查看而无需在您的网络上打开端口。从黑盒的角度收集有关IoT设备及其应用程序的详细信息可能有些棘手。然而，可能有很多在线产品资源可用于帮助进行这项练习。
- en: How to do it...
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: To start threat modeling the connected DVR, we will follow the aforementioned
    Microsoft multistep threat modeling approach.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始威胁建模连接的DVR，我们将遵循前面提到的微软多步骤威胁建模方法。
- en: Step 1 - identifying the assets
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤1 - 识别资产
- en: 'Document all of the DVR''s assets in order to understand where to focus more
    probable attacks in the interest of time. If we can identify assets that contain
    public vulnerabilities, this will save us time as attackers when exploiting the
    DVR system. The following table describes what we know about the DVR''s assets
    by reading the back of the box and user manuals when installing the device:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 记录DVR的所有资产，以了解在时间利益上更可能的攻击焦点。如果我们能够识别包含公共漏洞的资产，那么在利用DVR系统时，这将节省我们时间。通过阅读盒子背面和用户手册来安装设备时，以下表格描述了我们对DVR资产的了解：
- en: '| **ID** | **Asset** | **Description** |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| **ID** | **资产** | **描述** |'
- en: '| 1 | DVR | The DVR contains multiple camera channels to view live feeds, play
    back previous feeds, record videos, and take camera pictures. The DVR can connect
    to IP cameras or hardwired BNC cable cameras. A number of known network protocols
    and proprietary protocols are supported, such as TCP/IP, PPPoE, DHCP, Hik-connect
    Cloud P2P, DNS, DDNS, NTP, SADP, SMTP, NFS, iSCSI, UPnP, and HTTPS. The DVR has
    the ability to connect to a number of application interfaces to view camera feeds.
    |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| 1 | DVR | DVR包含多个摄像头通道，可查看实时源，回放以前的源，录制视频和拍摄摄像头图片。DVR可以连接到IP摄像头或有线BNC电缆摄像头。支持多种已知的网络协议和专有协议，如TCP/IP，PPPoE，DHCP，Hik-connect
    Cloud P2P，DNS，DDNS，NTP，SADP，SMTP，NFS，iSCSI，UPnP和HTTPS。DVR具有连接到多个应用程序接口查看摄像头源的能力。
    |'
- en: '| 2 | Cameras | Video streams are captured by enabled IP cameras and/or BNC
    cable cameras where data is transmitted to the DVR directly or wirelessly if an
    IP is available. |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 摄像头 | 视频流由启用的IP摄像头和/或BNC电缆摄像头捕获，数据直接传输到DVR或通过无线方式传输。 |'
- en: '| 3 | Firmware | Various camera features and configuration options are controlled
    via the firmware. |'
  id: totrans-75
  prefs: []
  type: TYPE_TB
  zh: '| 3 | 固件 | 通过固件控制各种摄像头功能和配置选项。 |'
- en: '| 4 | Web applications | The DVR contains a local web server that can be reached
    by accessing the IP address in a web browser. To view video feeds via the local
    web application, a plugin must be downloaded with a supported browser.The device
    has the option to view video feeds via the vendor''s cloud SaaS platform when
    configuring the device. A separate username and password is needed to enable the
    vendor''s cloud SaaS platform. The SaaS platform adds additional sharing features
    to third parties and access to other DVRs that may be purchased by the same owner.
    |'
  id: totrans-76
  prefs: []
  type: TYPE_TB
  zh: '| 4 | Web应用 | DVR包含一个本地Web服务器，可以通过在Web浏览器中访问IP地址来访问。要通过本地Web应用程序查看视频源，必须使用支持的浏览器下载插件。在配置设备时，设备可以通过供应商的云SaaS平台查看视频源。需要单独的用户名和密码才能启用供应商的云SaaS平台。SaaS平台为第三方添加了额外的共享功能，并可以访问同一所有者可能购买的其他DVR。
    |'
- en: '| 5 | Mobile applications | Android and iOS applications are available for
    configuring various settings as well as view and save video feeds remotely. All
    traffic from mobile applications is sent via the vendor''s API over the mobile
    device''s network connection. The mobile application connects to the vendor''s
    cloud environment to render back the camera feed. A username and password are
    needed to access the camera system via the mobile applications. |'
  id: totrans-77
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 移动应用 | 可用于配置各种设置以及远程查看和保存视频源的Android和iOS应用程序。所有移动应用程序的流量都通过供应商的API发送到移动设备的网络连接。移动应用程序连接到供应商的云环境以渲染摄像头源。需要用户名和密码才能通过移动应用程序访问摄像头系统。
    |'
- en: '| 6 | Thick applications | Windows and OS X installers are available to view
    camera feeds and configure various settings. |'
  id: totrans-78
  prefs: []
  type: TYPE_TB
  zh: '| 6 | 厚应用 | 可以安装Windows和OS X安装程序来查看摄像头源并配置各种设置。 |'
- en: '| 7 | Device hardware | The DVR hardware contains multiple video outputs for
    VGA and HDMI. The device connects to the local network via an Ethernet cable.
    For storage, the device has one SATA connector for a hard drive with up to 6 TB
    in capacity. |'
  id: totrans-79
  prefs: []
  type: TYPE_TB
  zh: '| 7 | 设备硬件 | DVR硬件包含多个VGA和HDMI视频输出。设备通过以太网电缆连接到本地网络。对于存储，设备具有一个SATA连接器，可容纳高达6TB的硬盘。
    |'
- en: '| 8 | Radio communication | The DVR connects to cameras via BNC connectors
    or via IP. No wireless communication is used; however, all traffic via the mobile
    applications is transmitted over wireless communication. |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| 8 | 无线通信 | DVR通过BNC连接器或IP连接到摄像头。不使用无线通信；但是，所有移动应用程序的流量都通过无线通信传输。 |'
- en: Step 2 - creating an IoT device architecture overview
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2 - 创建物联网设备架构概述
- en: 'Creating an architecture overview helps with visualizing how we can attack
    the DVR to misuse the system in an unintended manner. When creating an IoT device
    architecture overview, our goal is to document the DVR functionality and its applications
    as well as its physical architecture from the data we have gathered or learned
    in the process. We want to discover flaws in the DVR''s design and its implementation.
    This includes identifying the different technologies as well. Let''s break down
    how we should create an architecture overview into three tasks:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 创建架构概述有助于可视化我们如何攻击DVR以错误使用系统。在创建物联网设备架构概述时，我们的目标是记录DVR的功能及其应用程序以及从我们已经收集或在过程中学到的数据中的物理架构。我们希望发现DVR设计和实施中的缺陷。这还包括识别不同的技术。让我们分解如何创建架构概述为三个任务：
- en: Document the DVR functionality and features
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 记录DVR功能和特性
- en: Create an architectural diagram that details the DVR ecosystem
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建一个详细的DVR生态系统的架构图
- en: Identify the technologies in use
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 识别正在使用的技术
- en: To start with documenting DVR functionality and features, let's create a couple
    of use cases.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始记录DVR功能和特性，让我们创建一些用例。
- en: '**Use case 1**: User views camera feed in their local network via the local
    web application'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: '**用例1**：用户通过本地Web应用程序在其本地网络中查看摄像头源'
- en: User installs the DVR and a camera.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户安装DVR和摄像头。
- en: User creates a user.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户创建一个用户。
- en: User configures the DVR and camera settings.
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户配置DVR和摄像头设置。
- en: User then connects the Ethernet to the DVR for network connectivity.
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户然后将以太网连接到DVR以进行网络连接。
- en: User takes note of the DVR IP address.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户记录DVR IP地址。
- en: User then installs plugins and software provided by the vendor.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户然后安装供应商提供的插件和软件。
- en: User logs into to the DVR via a web browser.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户通过Web浏览器登录DVR。
- en: User selects the appropriate camera to view its feed.
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户选择适当的摄像头查看其视频。
- en: '**Use case 2**: User views camera feed remotely via the mobile application'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: '**用例2**：用户通过移动应用程序远程查看摄像头视频'
- en: User configures settings for platform access to the vendor SaaS.
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户配置平台访问供应商SaaS的设置。
- en: User downloads and installs the Android or iOS application.
  id: totrans-98
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户下载并安装Android或iOS应用程序。
- en: User creates a separate user for the vendor's SaaS application upon installation.
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户在安装时为供应商的SaaS应用程序创建一个单独的用户。
- en: User logs into the mobile application.
  id: totrans-100
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户登录移动应用程序。
- en: User scans a barcode with the mobile application under the DVR for vendor verification.
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户使用移动应用程序在DVR下扫描条形码进行供应商验证。
- en: User selects the appropriate camera to view its feed.
  id: totrans-102
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 用户选择适当的摄像头查看其视频。
- en: 'The following architectural diagram of the preceding listed use cases provides
    details of components for the DVR ecosystem:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 前述列出的用例的以下架构图提供了DVR生态系统组件的详细信息：
- en: '![](img/e248e594-8362-4aab-9edc-655bb2c52245.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/e248e594-8362-4aab-9edc-655bb2c52245.png)'
- en: 'Once an architecture diagram is drawn, the different technologies need to be
    identified and examined. Certain operating systems, protocols, and low-level libraries
    contain inherent vulnerabilities. It is important to document what technologies
    are utilized to further analyze and define possible threat cases:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦绘制了架构图，就需要识别和检查不同的技术。某些操作系统、协议和低级库具有固有的漏洞。重要的是记录所使用的技术，以进一步分析和定义可能的威胁案例：
- en: '| **Technology** | **Details** |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '| **技术** | **详情** |'
- en: '| DVR | Embedded Linux 3.10.0; communicates over HTTP and TCP/IP; custom web
    server (DNVRS-Webs); internal and external storage options. |'
  id: totrans-107
  prefs: []
  type: TYPE_TB
  zh: '|DVR|嵌入式Linux 3.10.0；通过HTTP和TCP/IP通信；自定义Web服务器（DNVRS-Webs）；内部和外部存储选项。|'
- en: '| Wireless (Wi-Fi) router | 2.4 GHz Wi-Fi; 100 m range. |'
  id: totrans-108
  prefs: []
  type: TYPE_TB
  zh: '|无线（Wi-Fi）路由器|2.4 GHz Wi-Fi；100米范围。|'
- en: '| Mobile apps | Android and iOS applications connect to a third-party service
    for viewing camera feeds. Data has the option to be stored locally on the device
    for pictures as well as user credentials. |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '|移动应用程序| Android和iOS应用程序连接到第三方服务，用于查看摄像头视频。数据可以选择在设备上本地存储图片和用户凭据。|'
- en: '| Communication protocol: HTTP | Clear text protocol used by default when viewing
    camera feeds. |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '|通信协议：HTTP |默认情况下查看摄像头视频时使用的明文协议。|'
- en: '| Communication protocol: HTTPS | Encrypted communication when viewing camera
    feeds but needs to be configured manually after generating an SSL certificate
    through the web interface. |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '|通信协议：HTTPS |查看摄像头视频时进行加密通信，但需要在通过Web界面生成SSL证书后手动配置。|'
- en: '| Communication protocol: 802.11 Wi-Fi | RF protocol for communication between
    IP cameras and the DVR. |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '|通信协议：802.11 Wi-Fi | IP摄像头和DVR之间通信的RF协议。|'
- en: '| Communication protocol: RTSP | Network protocol used to stream camera feeds
    to applications. |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '|通信协议：RTSP |用于将摄像头视频流式传输到应用程序的网络协议。|'
- en: Step 3 - decomposing the IoT device
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3步 - 分解物联网设备
- en: Next, we analyze the application and protocol data flows through the DVR environment
    to locate vulnerable entry points into the device or client applications. We will
    look for locations that may have higher privilege access and document each possible
    entry point. An entry point that compromises the DVR's confidentiality and integrity
    will give us the upper hand as an attacker.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将分析应用程序和协议数据流通过DVR环境，以找到设备或客户端应用程序的易受攻击的入口点。我们将寻找可能具有更高特权访问的位置，并记录每个可能的入口点。一个危害DVR机密性和完整性的入口点将使我们作为攻击者占据上风。
- en: These entry points will vary based upon the platform, technology, and protocol
    used but for this section, we will keep it at a high level. Also examine the various
    trust boundaries between the technologies and features as well. Once decomposing
    the DVR architecture is complete, you should have a better idea of attack surfaces
    and how data may be compromised.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这些入口点将根据所使用的平台、技术和协议而变化，但在本节中，我们将保持在较高水平。还要检查技术和功能之间的各种信任边界。一旦分解DVR架构完成，您应该对攻击面有更好的了解，以及数据可能如何被威胁。
- en: 'The following diagram is an example of decomposing an IoT DVR''s environmental
    data flow:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表是分解物联网DVR环境数据流的示例：
- en: '![](img/a43ea0b8-4241-4fd7-aaad-f9877d0d02b1.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](img/a43ea0b8-4241-4fd7-aaad-f9877d0d02b1.png)'
- en: 'After the data flow is mapped out and complete, documentation of the entry
    points takes place:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 在映射数据流并完成后，进行入口点的文档记录：
- en: '| **DVR entry points** |  |  |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| **DVR入口点** |  |  |'
- en: '| **#** | **Entry Point** | **Description** |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| **＃** | **入口点** | **描述** |'
- en: '| 1 | Embedded web app | The embedded web application provides an interface
    to view camera feeds and make changes to the camera details, configurations, as
    well as networking details for monitoring such as SNMP. The embedded web app uses
    SOAP/XML web services for transport communication over HTTP but has the option
    to use HTTPS by creating a self-signed certificate within the configuration menus.
    In order to view camera feeds, an executable is downloaded and within the executable
    file, an ActiveX plugin is installed in Internet Explorer.Note: Browsers other
    than **Internet Explorer** (**IE**) cannot view camera feeds. |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| 1 |嵌入式Web应用程序|嵌入式Web应用程序提供了一个界面，用于查看摄像头视频并对摄像头细节、配置以及用于监控的网络细节进行更改，如SNMP。嵌入式Web应用程序使用SOAP/XML
    Web服务通过HTTP进行传输通信，但可以通过在配置菜单中创建自签名证书来使用HTTPS。为了查看摄像头视频，需要下载一个可执行文件，在可执行文件中，需要在Internet
    Explorer中安装一个ActiveX插件。注意：**Internet Explorer**（IE）之外的浏览器无法查看摄像头视频。|'
- en: '| 2 | Vendor web app | A connection is made from the DVR to a STUN/TURN server
    owned by the vendor in order to stream camera feeds without opening ports on a
    router. The vendor application is only available over HTTPS and uses web sockets
    for communication. |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| 2 | 供应商Web应用 | DVR与供应商拥有的STUN/TURN服务器建立连接，以便在不打开路由器端口的情况下流式传输摄像头视频。供应商应用仅通过HTTPS可用，并使用Web套接字进行通信。
    |'
- en: '| 3 | DVR | The DVR connects to multiple web apps and mobile apps. An embedded
    web app is a server from the DVR itself and the vendor SaaS application connects
    to the DVR. Similarly, the vendor has a mobile app available but also has another
    third-party mobile app from the original manufacturer for the DVR (discovered
    through proxying). The DVR also has inputs via hardware peripherals as well as
    through its main PCB. |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 3 | DVR | DVR连接到多个Web应用程序和移动应用程序。嵌入式Web应用程序是DVR本身的服务器，供应商的SaaS应用程序连接到DVR。同样，供应商有一个可用的移动应用程序，但也有另一个原始制造商为DVR提供的第三方移动应用程序（通过代理发现）。DVR还通过硬件外围设备和主PCB进行输入。
    |'
- en: '| 4 | Firmware | The DVR utilizes firmware to control the device but may only
    be acquired via vendor technical support (per documentation). The embedded web
    server utilizes the firmware for managing actions. |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 4 | 固件 | DVR利用固件来控制设备，但可能只能通过供应商技术支持（根据文档）获得。嵌入式Web服务器利用固件进行管理操作。 |'
- en: '| 5 | Cameras | Cameras can be added to a DVR by adding their IP address to
    the DVR configuration page. Cameras can also be added by manually plugging in
    cameras with a BNC connector. |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| 5 | 摄像头 | 可以通过将其IP地址添加到DVR配置页面来将摄像头添加到DVR。摄像头也可以通过手动插入具有BNC连接器的摄像头来添加。 |'
- en: '| 6 | Mobile applications | Multiple mobile applications are available for
    download. Each mobile application can make configuration changes to the DVR and
    cameras. Credentials are required to use the mobile app. All traffic is fed to
    the vendor environment to view camera details and feeds. |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| 6 | 移动应用程序 | 可以下载多个移动应用程序。每个移动应用程序都可以对DVR和摄像头进行配置更改。使用移动应用程序需要凭据。所有流量都被传送到供应商环境以查看摄像头详情和视频。
    |'
- en: '| 7 | Wireless communication | Communication traffic from the mobile applications
    are over wireless technology; either 802.11 or cell provider networks (4G). |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| 7 | 无线通信 | 移动应用程序的通信流量通过无线技术进行，可以是802.11或蜂窝网络（4G）。 |'
- en: Step 4 - identifying threats
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤4 - 辨识威胁
- en: 'At this stage, we have drawn out the data flow of a DVR system and identified
    entry points. We now have to identify the risks of each entry point as it relates
    to the user, the network, and the application as well, as the vendors who wrote
    the application code. From an attacker perspective, we want to identify threats
    which affect the network, applications, and hosts that may be exploitable and
    cause the following impact:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段，我们已经绘制出了DVR系统的数据流，并确定了入口点。现在我们必须确定每个入口点的风险，因为它涉及用户、网络和应用程序，以及编写应用程序代码的供应商。从攻击者的角度来看，我们希望确定影响网络、应用程序和主机的威胁，这些威胁可能是可利用的，并造成以下影响：
- en: Affect a large number of users utilizing this specific DVR system
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 影响使用这个特定DVR系统的大量用户
- en: Compromise the vendor's infrastructure to induce mass exploitation
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 妥协供应商基础设施以引发大规模利用
- en: Compromise the DVR to pose a privacy risk to users
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 妥协DVR以对用户构成隐私风险
- en: Compromise the DVR to pose a safety risk to the DVR owner
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 妥协DVR以对DVR所有者构成安全风险
- en: 'To help with identifying threats and categorizing them, let''s apply the STRIDE
    model to our DVR IoT system. We will be adding a couple of threat types in lieu
    of IoT-specific issues in the following table. This table is by no means exhaustive
    but should help with ideas when thinking about threats that may affect the holistic
    DVR environment:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 为了帮助辨识威胁并对其进行分类，让我们将STRIDE模型应用于我们的DVR物联网系统。在下表中，我们将添加一些威胁类型，以代替物联网特定问题。这张表并不是详尽无遗的，但应该有助于思考可能影响整体DVR环境的威胁时提供一些想法：
- en: '| **Threat types** | **Analysis** |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| **威胁类型** | **分析** |'
- en: '| Spoofing identity | Examine the system for threats related to the spoofing
    DVR identity and the ability for an attacker to overcome automated trust relationships
    between devices.Look for entry points that allow devices or users to manipulate
    trust relationships within DVR provisioning processes.Analyze authentication and
    authorization functions with the DVR''s application interfaces.Review the DVR''s
    app communication for the ability to forge requests. |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| 冒充身份 | 检查系统中与冒充DVR身份相关的威胁，以及攻击者克服设备之间自动信任关系的能力。寻找允许设备或用户在DVR配置过程中操纵信任关系的入口点。分析DVR应用程序接口的身份验证和授权功能。检查DVR应用程序通信是否具有伪造请求的能力。
    |'
- en: '| Tampering with data | Review the DVR''s messaging communication between applications
    and devices.Identify points in the DVR that provide an opportunity to tamper with
    the data at points of collection, processing, transport, and storage of data.Attempt
    to tamper with firmware and mobile app configurations to perform unauthorized
    actions. |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| 数据篡改 | 检查DVR应用程序和设备之间的消息通信。识别DVR中提供数据篡改机会的点，包括数据收集、处理、传输和存储的环节。尝试篡改固件和移动应用程序配置，执行未经授权的操作。
    |'
- en: '| Repudiation | Identify attack entry points that allow illegal operations
    to take place without logging abilities.Disable web and mobile app tracing functionalities.
    |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| 否认 | 辨识允许进行非法操作而无需记录能力的攻击入口点。禁用Web和移动应用程序的跟踪功能。 |'
- en: '| Information disclosure | Fuzz application parameters to influence application
    error disclosuresIdentify all clear text communications.Review DVR API communication
    HTTP response headers for versioning information.Identify all API endpoints and
    application backend technologies utilized.Review application data storage for
    unintended data leakage within clear text files. |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
  zh: '| 信息泄露 | 模糊应用程序参数以影响应用程序错误披露。识别所有明文通信。检查DVR API通信的HTTP响应头以获取版本信息。识别所有API端点和应用程序后端使用的技术。检查应用程序数据存储中是否存在明文文件中的意外数据泄露。
    |'
- en: '| Denial of service | Perform functions such as forgot password to identify
    whether locking out users is possible.Test for account lockout policies within
    each DVR application interface.Examine the throughput of the DVRs network services
    to understand how attacks may withstand relevant DoS attacks.Examine the messaging
    structures (for example, data buses), data structures, improper use of variables
    and APIs used within the DVR''s components and determine whether there are vulnerabilities
    that would allow a malicious camera to drown out the transmissions of a legitimate
    camera or compatible DVR device. |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
  zh: '| 拒绝服务 | 执行诸如忘记密码之类的功能，以确定是否可能锁定用户。测试每个DVR应用程序界面中的帐户锁定策略。检查DVR网络服务的吞吐量，以了解攻击可能如何抵御相关的DoS攻击。检查消息结构（例如，数据总线）、数据结构、变量和DVR组件中使用的API的不当使用，并确定是否存在漏洞，使恶意摄像头可以淹没合法摄像头或兼容的DVR设备的传输。
    |'
- en: '| Privileged elevation | Examine the administration capabilities the DVR provides.
    Create lower application users and test for administrative access.Identify instances
    where there are weaknesses in the ability to segregate administrative functions
    from user-level functions within the DVR''s application and operating system.Identify
    weaknesses in the authentication methods employed by DVR nodes in order to design
    appropriate authentication controls into the system. |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
  zh: '| 特权提升 | 检查DVR提供的管理功能。创建较低的应用程序用户并测试管理访问。识别DVR应用程序和操作系统中无法将管理功能与用户级功能分隔开的弱点。识别DVR节点所采用的身份验证方法的弱点，以便设计适当的身份验证控件到系统中。
    |'
- en: '| Physical security bypass | Examine the physical protection mechanisms offered
    by the DVR and its cameras to identify weaknesses that may allow administrative
    console access. |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
  zh: '| 物理安全绕过 | 检查DVR及其摄像头提供的物理保护机制，以识别可能允许管理控制台访问的弱点。 |'
- en: '| Supply chain issues | Understand the various technological components and
    their origins that make up the DVR system (for example, ODMs, hardware manufacturers,
    OEMs, and so on).Keep track of vulnerabilities related to any of the technology
    layers related to the DVR''s hardware and software components. |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
  zh: '| 供应链问题 | 了解组成DVR系统的各种技术组件及其来源（例如，ODM、硬件制造商、OEM等）。跟踪与DVR硬件和软件组件相关的任何技术层面的漏洞。
    |'
- en: 'Alternatively, we can simply list out threats from a high-level and later in
    the chapter, we will drill down to threats for each component. Some of the threats
    may be unknown or completely theoretical since we may not have all the insights
    but it''s important to brainstorm these ideas. To get the most out of identifying
    threats, pair up with a partner or make it a group exercise with others who are
    looking at attacking your specific IoT system of interest. The following are examples
    of high-level threats to our DVR system that an attacker could perform:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，我们可以简单地列出高层次的威胁，然后在本章后面，我们将深入研究每个组件的威胁。一些威胁可能是未知的或完全理论的，因为我们可能没有所有的见解，但重要的是要进行头脑风暴。为了更好地识别威胁，可以与伙伴配对或与其他人一起进行小组练习，他们正在攻击您感兴趣的特定物联网系统。以下是我们DVR系统的高级威胁的示例，攻击者可能执行的：
- en: Remotely take over the DVR system
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程接管DVR系统
- en: Remotely view camera feeds (spy) without authorization
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 未经授权远程查看摄像头视频（间谍）
- en: Turn off camera recording playback features
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 关闭摄像头录制回放功能
- en: Track individuals
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跟踪个人
- en: Break into surrounding areas based upon intelligence gathering
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据情报收集闯入周围区域
- en: Install malware on the DVR
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在DVR上安装恶意软件
- en: Gain physical access and sabotage recordings
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获得物理访问并破坏录音
- en: Overload the DVR with requests to prevent usage
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用请求超载DVR以阻止使用
- en: Eavesdrop on DVR communications
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃听DVR通信
- en: Step 5 - documenting threats
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第5步 - 记录威胁
- en: Next, we will document a few of the threat use cases we have identified in step
    4 with a description, threat target, attack technique(s), and any countermeasures
    that may be in place.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将记录我们在第4步中识别的一些威胁用例，包括描述、威胁目标、攻击技术和可能存在的任何对策。
- en: 'Threat #1'
  id: totrans-157
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃1
- en: '| **Threat description** | **Attacker could remotely take over the DVR system**
    |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能远程接管DVR系统** |'
- en: '| Threat target | DVR customers, DVR network processes, DVR applications. |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | DVR客户、DVR网络进程、DVR应用程序。 |'
- en: '| Attack techniques | Attacker intercept wireless communication, API communication,
    and/or network protocol communications for credentials or session cookies. Attackers
    can social engineer users into accessing their DVR via spoofed user interfaces
    or exploiting application vulnerabilities to add user accounts using cross-site
    request forgery (CSRF). |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者拦截无线通信，API通信和/或网络协议通信以获取凭据或会话cookie。攻击者可以通过欺骗用户访问其DVR，通过欺骗用户界面或利用应用程序漏洞使用跨站点请求伪造（CSRF）添加用户帐户。
    |'
- en: '| Countermeasures | DVR locks out users for 30 mins if failed logins are attempted
    or too many requests are sent at one time. |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 如果尝试登录失败或同时发送太多请求，DVR将锁定用户30分钟。 |'
- en: 'Threat #2'
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃2
- en: '| **Threat description** | **Attacker could remotely view camera feeds without
    authorization** |'
  id: totrans-163
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能未经授权远程查看摄像头视频** |'
- en: '| Threat target | DVR customers, protocols, and applications. |'
  id: totrans-164
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | DVR客户、协议和应用程序。 |'
- en: '| Attack techniques | Acquire credentials or API calls to view cameras without
    authenticated access. Attacker can harvest session identifiers to hijack sessions
    to enable remote viewing of camera feeds. Attackers can socially engineer users
    into accessing their DVR feed. Attackers can exploit vulnerable clear text RTSP
    streams to access video feeds with tools such as Cameradar ([https://hub.docker.com/r/ullaakut/cameradar/](https://hub.docker.com/r/ullaakut/cameradar/)).
    |'
  id: totrans-165
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 获取凭据或API调用以在未经身份验证的情况下查看摄像头。攻击者可以获取会话标识符以劫持会话，从而实现远程查看摄像头视频。攻击者可以通过社会工程学诱使用户访问其DVR视频。攻击者可以利用易受攻击的明文RTSP流使用诸如Cameradar（[https://hub.docker.com/r/ullaakut/cameradar/](https://hub.docker.com/r/ullaakut/cameradar/)）之类的工具访问视频源。
    |'
- en: '| Countermeasures | Enforce multifactor authentication and make use of encrypted
    RTSP or SRTP streams. |'
  id: totrans-166
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 强制执行多因素身份验证，并使用加密的RTSP或SRTP流。 |'
- en: 'Threat #3'
  id: totrans-167
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃3
- en: '| **Threat description** | **Attackers could turn off recording playback features**
    |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能关闭录制回放功能** |'
- en: '| Threat target | DVR customers. |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | DVR客户。 |'
- en: '| Attack techniques | Attackers can physically access the DVR system to apply
    changes. Attackers can socially engineer users into accessing their DVR. |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者可以物理访问DVR系统以应用更改。攻击者可以通过社会工程使用户访问其DVR。 |'
- en: '| Countermeasures | Enforce authentication to sensitive features as well as
    multifactor authentication. |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 对敏感功能进行身份验证，以及多因素身份验证。 |'
- en: Step 6 - rating the threats
  id: totrans-172
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤6 - 对威胁进行评级
- en: Since we have identified and documented threats for our DVR, let's rate the
    threats with their likelihood as well as their possible impact using the DREAD
    rating system. Earlier in the chapter, we introduced the DREAD rating system but,
    as noted, there are other rating systems available to use. The rating values for
    each letter in DREAD range from 3 for high, 2 for medium, and 1 for low.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 既然我们已经确定并记录了DVR的威胁，让我们使用DREAD评级系统对威胁进行评级，以及它们可能的影响。在本章的前面，我们介绍了DREAD评级系统，但需要注意的是，还有其他可用的评级系统。DREAD中每个字母的评级值范围为高3，中2，低1。
- en: 'For DREAD, the final risk is ranked using the following ratings:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 对于DREAD，最终风险是使用以下评级进行排名的：
- en: '| **Risk rating** | **Result** |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| **风险评级** | **结果** |'
- en: '| High | 12-15 |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| 高 | 12-15 |'
- en: '| Medium | 8-11 |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| 中等 | 8-11 |'
- en: '| Low | 5-7 |'
  id: totrans-178
  prefs: []
  type: TYPE_TB
  zh: '| 低 | 5-7 |'
- en: 'An example of a threat rating for a threat case in our DVR system is given
    as follows:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的DVR系统中威胁案例的威胁评级示例如下：
- en: '| **Threat risk rating: Attacker could remotely view camera feeds without authorization**
    |  |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| **威胁风险评级：攻击者可能未经授权远程查看摄像头视频** |  |'
- en: '| **Item** | **Score** |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| **项目** | **分数** |'
- en: '| Damage potential | 3 |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| 损害潜力 | 3 |'
- en: '| Reproducibility | 2 |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| 可重现性 | 2 |'
- en: '| Exploitability | 3 |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| 可利用性 | 3 |'
- en: '| Affected users | 2 |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| 受影响的用户 | 2 |'
- en: '| Discoverability | 3 |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| 可发现性 | 3 |'
- en: '| **Risk rating score: High** | **13** |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| **风险评级分数：高** | **13** |'
- en: Initially, threat modeling a holistic DVR system may be a bit more difficult
    when thinking of all threat cases due to all the different components. Although,
    once complete, you will have documented a number of potential high-risk vulnerabilities
    to focus on for testing. This will make it easier to prioritize vulnerabilities
    when testing an IoT system.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 最初，对整体DVR系统进行威胁建模可能会更加困难，因为需要考虑所有不同的组件的威胁案例。尽管如此，一旦完成，您将已记录了许多潜在的高风险漏洞，以便进行测试时专注于重点。这将使得在测试物联网系统时更容易优先处理漏洞。
- en: Threat modeling firmware
  id: totrans-189
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁建模固件
- en: In the previous recipe, we conducted a threat model of a DVR system and rated
    a threat case that would help with prioritizing vulnerabilities to test. In this
    recipe, we will go through threat modeling firmware for the same DVR system.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在上一节中，我们对DVR系统进行了威胁建模，并对一个威胁案例进行了评级，这有助于优先处理要测试的漏洞。在本节中，我们将对相同的DVR系统的固件进行威胁建模。
- en: Getting ready
  id: totrans-191
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备工作
- en: In this exercise, we will use the free [https://draw.io](https://draw.io/) online
    diagram software to help with demonstrating relationships in diagrams within firmware.
    This tool is a Chrome app and ties to third-party services for storage such as
    Google Drive or GitHub. We can draw relationships and processes that overlap,
    which is not possible in the Microsoft tool. Any tool that can effectively draw
    the architecture with their respective relationships of the target device or software
    will suffice.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们将使用免费的[https://draw.io](https://draw.io/)在线图表软件来帮助演示固件内的图表关系。这个工具是一个Chrome应用，与Google
    Drive或GitHub等第三方服务进行存储。我们可以绘制重叠的关系和流程，这在Microsoft工具中是不可能的。任何能够有效绘制目标设备或软件的架构及其相应关系的工具都可以。
- en: 'To get started with drawing diagrams, perform the following steps:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 要开始绘制图表，请执行以下步骤：
- en: Select Create New Diagram.
  id: totrans-194
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择创建新图表。
- en: Select Software Design.
  id: totrans-195
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择软件设计。
- en: 'Select the deployment diagram template as shown in the following screenshot:'
  id: totrans-196
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择部署图表模板，如下面的屏幕截图所示：
- en: '![](img/c5cbb192-eb79-4d45-b76d-f1701e66bb3c.png)'
  id: totrans-197
  prefs: []
  type: TYPE_IMG
  zh: '![](img/c5cbb192-eb79-4d45-b76d-f1701e66bb3c.png)'
- en: Remove all unused diagrams in the template and leave one rectangle for the firmware
    and its internal components.
  id: totrans-198
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 删除模板中所有未使用的图表，只留下一个矩形用于固件及其内部组件。
- en: Drag and drop assets into the diagram to show their relationship.
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将资产拖放到图表中以显示它们的关系。
- en: How to do it...
  id: totrans-200
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做...
- en: For firmware, we can identify what type of operating system is running via the
    device packaging, basic port scans, or various online resources. We should have
    a general idea how firmware functions on embedded IoT devices as discussed in
    [Chapter 1](d21aaeab-23b9-4b4d-8ae7-efdca033ec10.xhtml), *IoT Penetration Testing*.
    This section will not be going into as much detail as the previous recipe but
    we still want identify all we know about the firmware as well as draw out its
    components to identify potential threats for testing. Some of the threat modeling
    steps we will combine for brevity.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 对于固件，我们可以通过设备包装、基本端口扫描或各种在线资源来确定正在运行的操作系统的类型。我们应该对嵌入式物联网设备上的固件功能有一个大致的了解，如[第1章](d21aaeab-23b9-4b4d-8ae7-efdca033ec10.xhtml)中所讨论的。本节不会像前面的内容那样详细，但我们仍然希望确定我们对固件的所有了解，并绘制其组件以确定测试的潜在威胁。我们将合并一些威胁建模步骤以简洁起见。
- en: Step 1 - identifying the assets
  id: totrans-202
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤1 - 确定资产
- en: 'From what we know about the firmware and services the DVR provides, let''s
    use the following table to document some of the firmware assets:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 根据我们对固件和DVR提供的服务的了解，让我们使用以下表格来记录一些固件资产：
- en: '| **ID** | **Asset** | **Description** |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| **ID** | **资产** | **描述** |'
- en: '| 1 | Web server | The firmware serves a local web app for viewing camera feeds
    and managing cameras. |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| 1 | Web服务器 | 固件为本地Web应用提供服务，用于查看摄像头视频和管理摄像头。 |'
- en: '| 2 | SSH | The DVR listens on port 22 for shell access. |'
  id: totrans-206
  prefs: []
  type: TYPE_TB
  zh: '| 2 | SSH | DVR在端口22上监听shell访问。 |'
- en: '| 3 | RTSP | Camera feeds utilize RTSP for viewing. |'
  id: totrans-207
  prefs: []
  type: TYPE_TB
  zh: '| 3 | RTSP | 摄像头视频流使用RTSP进行查看。 |'
- en: '| 4 | UPnP | UPnP is available to manage the device''s configuration. |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| 4 | UPnP | UPnP可用于管理设备的配置。 |'
- en: '| 5 | DNS | Local DNS server is running for remote viewing. |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| 5 | DNS | 本地DNS服务器用于远程查看。 |'
- en: Steps 2 and 3 - creating an architecture overview and decomposition
  id: totrans-210
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2和3 - 创建架构概述和分解
- en: 'We have a general idea of what firmware components and possible libraries may
    be used that pertain to the DVR''s services. An overview diagram such as the following
    one can be drawn showing the relationship between the device, firmware contents,
    and what resides in the filesystem:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 我们大致了解了固件组件和可能使用的库，这些库与DVR的服务相关。可以绘制以下概述图，显示设备、固件内容以及文件系统之间的关系：
- en: '![](img/988a8d59-07dc-4dba-925d-510deda23155.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](img/988a8d59-07dc-4dba-925d-510deda23155.png)'
- en: Step 4 - identifying threats
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤4 - 识别威胁
- en: 'Let''s now document threats based upon our diagram and knowledge of the firmware
    contents. Remember, we have not disassembled or located the firmware image at
    this stage. The contents of the diagrams are assumptions based upon what the DVR
    advertises as its services and online documentation. The following are possible
    threats to firmware that attackers could exploit to do the following:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们根据我们的图表和对固件内容的了解来记录威胁。请记住，在这个阶段我们还没有对固件图像进行反汇编或定位。图表的内容是基于DVR宣传的服务和在线文档的假设。以下是攻击者可能利用的固件的可能威胁：
- en: Perform remote code execution on network services
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在网络服务上执行远程代码执行
- en: Gain admin access to the filesystem and attack the LAN
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获得对文件系统的管理员访问权并攻击局域网
- en: Intercept network communications
  id: totrans-217
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拦截网络通信
- en: Access filesystem resources via SSH
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过SSH访问文件系统资源
- en: Control DNS to redirect traffic to victim networks/computers
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 控制DNS以将流量重定向到受害者网络/计算机
- en: Access web configurations and possible secrets within firmware
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问Web配置和固件中可能的秘密
- en: Install malicious firmware or applications on the DVR
  id: totrans-221
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在DVR上安装恶意固件或应用程序
- en: Track user activity
  id: totrans-222
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跟踪用户活动
- en: Tamper with camera feeds and content
  id: totrans-223
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 篡改摄像头视频流和内容
- en: Tamper with audit logs
  id: totrans-224
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 篡改审计日志
- en: Brick the DVR
  id: totrans-225
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 变砖DVR
- en: Block all network connections to the DVR
  id: totrans-226
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 阻止所有网络连接到DVR
- en: Step 5 - documenting threats
  id: totrans-227
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤5 - 记录威胁
- en: Next, we will pick a few threat cases and document them with a description,
    threat target, attack technique(s), and any countermeasures that may be in place
    in order to rate their risk.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将挑选几个威胁案例，并记录它们的描述、威胁目标、攻击技术和可能存在的任何对策，以便评估它们的风险。
- en: 'Threat #1'
  id: totrans-229
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃1
- en: '| **Threat description** | **Attacker could perform remote code execution on
    network services** |'
  id: totrans-230
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可以在网络服务上执行远程代码执行** |'
- en: '| Threat target | DVR firmware. |'
  id: totrans-231
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | DVR固件。 |'
- en: '| Attack techniques | Attacker discovers flaws in DVR API communication. |'
  id: totrans-232
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者发现DVR API通信中的漏洞。 |'
- en: '| Countermeasures | DVR has rate-limit protections within its API. |'
  id: totrans-233
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | DVR在其API中设置了速率限制保护。 |'
- en: 'Threat #2'
  id: totrans-234
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃2
- en: '| **Threat description** | **Attacker could gain admin access to the filesystem
    and attack the LAN** |'
  id: totrans-235
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能获得对文件系统的管理员访问权并攻击局域网** |'
- en: '| Threat target | DVR firmware. |'
  id: totrans-236
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | DVR固件。 |'
- en: '| Attack techniques | Access to the console could be enabled via SSH or Telnet.
    Attacker can discover a buffer overflow to access filesystem contents and utilize
    post-exploitation techniques. Attackers locate a known bug in libraries used by
    the DVR. |'
  id: totrans-237
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者可以通过SSH或Telnet启用对控制台的访问。攻击者可以发现缓冲区溢出以访问文件系统内容并利用后期利用技术。攻击者发现DVR使用的库中的已知漏洞。
    |'
- en: '| Countermeasures | DVR enforces auto-update features preventing vulnerable
    libraries and services from being enabled. |'
  id: totrans-238
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | DVR强制执行自动更新功能，防止启用易受攻击的库和服务。 |'
- en: 'Threat #3'
  id: totrans-239
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃3
- en: '| **Threat description** | **Attacker could install malicious firmware or applications
    on the DVR** |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能在DVR上安装恶意固件或应用程序** |'
- en: '| Threat target | DVR firmware. |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | DVR固件。 |'
- en: '| Attack techniques | Attackers can sideload malicious firmware upon firmware
    updates. |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者可以在固件更新时加载恶意固件。 |'
- en: '| Countermeasures | DVR should sign its firmware images and validate upon reboot.
    |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | DVR应该对其固件图像进行签名，并在重启时进行验证。 |'
- en: Step 6 - rating the threats
  id: totrans-244
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤6 - 对威胁进行评级
- en: 'As we did in the previous recipe, we will need to rate each of the possible
    threats using DREAD. Using the following table, we will choose one threat and
    find out its risk rating:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 就像我们在上一个步骤中所做的那样，我们需要使用DREAD对每个可能的威胁进行评分。使用以下表格，我们将选择一个威胁并找出其风险评级：
- en: '| **Threat risk rating: Attacker could gain admin access to the filesystem
    and attack the LAN** |  |'
  id: totrans-246
  prefs: []
  type: TYPE_TB
  zh: '| **威胁风险评级：攻击者可能获得对文件系统的管理员访问权并攻击局域网** |  |'
- en: '| **Item** | **Score** |'
  id: totrans-247
  prefs: []
  type: TYPE_TB
  zh: '| **项目** | **得分** |'
- en: '| Damage potential | 3 |'
  id: totrans-248
  prefs: []
  type: TYPE_TB
  zh: '| 损害潜力 | 3 |'
- en: '| Reproducibility | 2 |'
  id: totrans-249
  prefs: []
  type: TYPE_TB
  zh: '| 可重现性 | 2 |'
- en: '| Exploitability | 2 |'
  id: totrans-250
  prefs: []
  type: TYPE_TB
  zh: '| 利用性 | 2 |'
- en: '| Affected users | 3 |'
  id: totrans-251
  prefs: []
  type: TYPE_TB
  zh: '| 受影响的用户 | 3 |'
- en: '| Discoverability | 2 |'
  id: totrans-252
  prefs: []
  type: TYPE_TB
  zh: '| 可发现性 | 2 |'
- en: '| **Risk rating score: High** | **12** |'
  id: totrans-253
  prefs: []
  type: TYPE_TB
  zh: '| **风险评分：高** | **12** |'
- en: Most embedded device operating systems typically run as root or admin. This
    means any vulnerability that may be exploited via a device's firmware should give
    you the highest access needed. There is no need for privilege escalation. More
    regulated industries may defer but if you are testing a consumer device, chances
    are the firmware is already running as root.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数嵌入式设备操作系统通常以root或管理员身份运行。这意味着通过设备固件可能被利用的任何漏洞都应该给您所需的最高访问权限。没有必要进行特权升级。更受监管的行业可能会推迟，但如果您正在测试消费者设备，固件很可能已经以root身份运行。
- en: Threat modeling of an IoT web application
  id: totrans-255
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 对物联网Web应用程序进行威胁建模
- en: Continuing our threat modeling exercises for our DVR, we will work on breaking
    down its web applications. Our DVR contains two types of web applications. One
    web application is embedded, running off of the DVR itself. The second web application
    is a SaaS application provided by the vendor for remote access to the DVR and
    its camera feeds.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 在为我们的DVR进行威胁建模练习时，我们将继续分解其Web应用程序。我们的DVR包含两种类型的Web应用程序。一个Web应用程序是嵌入式的，从DVR本身运行。第二个Web应用程序是供应商提供的用于远程访问DVR及其摄像头视频的SaaS应用程序。
- en: The SaaS application accesses the embedded DVR within the LAN. We have a better
    sense of what runs on the embedded web application locally on the DVR rather than
    the vendor SaaS application. Earlier in the chapter, we did mention some technologies
    utilized for the vendor web application but no additional information is known
    at this time. We will start by drawing out the architecture of the embedded web
    application and touch on the vendor SaaS application in the threats section rather
    than drawing its unknown architecture.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: SaaS应用程序访问局域网中的嵌入式DVR。我们对在DVR上本地运行的嵌入式Web应用程序有更清晰的了解，而对供应商SaaS应用程序了解较少。在本章的前面，我们提到了供应商Web应用程序使用的一些技术，但目前没有其他信息。我们将从绘制嵌入式Web应用程序的架构开始，并在威胁部分涉及供应商SaaS应用程序，而不是绘制其未知的架构。
- en: How to do it...
  id: totrans-258
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做…
- en: At this point, we should have a good idea of how to conduct threat models from
    beginning to end. With this in mind, we will skip some steps in the threat modeling
    process and move toward some of the more important aspects.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们应该对如何从头到尾进行威胁建模有一个很好的想法。考虑到这一点，我们将跳过威胁建模过程中的一些步骤，转向一些更重要的方面。
- en: Step 1 :Creating an architecture overview and decomposition
  id: totrans-260
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第1步：创建架构概述和分解
- en: 'As mentioned, we will draw out what we know about the embedded web application
    and work on identifying and rating threats within its architecture data flow.
    The following diagram illustrates some of the basic functions for the embedded
    web application:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 正如前面提到的，我们将绘制我们对嵌入式Web应用程序的了解，并致力于识别和评估其架构数据流中的威胁。以下图表说明了嵌入式Web应用程序的一些基本功能：
- en: '![](img/5367bbce-0460-4cd4-b5ca-d7a6e8b033be.png)'
  id: totrans-262
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5367bbce-0460-4cd4-b5ca-d7a6e8b033be.png)'
- en: The flow of the application is simplistic as the traffic only stays in the LAN
    and doesn't reach public-facing traffic. Identifying threats for an embedded application
    should not be too difficult.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 应用程序的流程很简单，因为流量只停留在局域网中，不会到达面向公众的流量。识别嵌入式应用程序的威胁不应该太困难。
- en: 'Step 2: Identifying threats'
  id: totrans-264
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2步：识别威胁
- en: Since the data flow within an embedded web application is simplistic in nature,
    documenting threats should be a breeze, although we will add some additional scenarios
    to take into account the vendor SaaS web application.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 由于嵌入式Web应用程序内的数据流具有简单性质，记录威胁应该很容易，尽管我们将添加一些额外的情景以考虑供应商SaaS Web应用程序。
- en: 'An attacker could exploit the DVR embedded web application and/or vendor SaaS
    applications to do the following:'
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用DVR嵌入式Web应用程序和/或供应商SaaS应用程序来执行以下操作：
- en: Hijack user sessions for viewing camera feeds and configurations
  id: totrans-267
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 劫持用户会话以查看摄像头视频和配置
- en: Eavesdrop on API calls
  id: totrans-268
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃听API调用
- en: Execute operating system commands via command injection vulnerabilities
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过命令注入漏洞执行操作系统命令
- en: Expose sensitive user details
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴露敏感用户详细信息
- en: Dump database contents via SQL injection
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过SQL注入转储数据库内容
- en: Perform arbitrary script execution
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 执行任意脚本
- en: Gain access to other user accounts
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问其他用户账户
- en: Forge requests under the logged-in user account (CSRF)
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 伪造已登录用户账户下的请求（CSRF）
- en: Modify DVR settings to redirect traffic to unauthorized users or networks
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 修改DVR设置以将流量重定向到未经授权的用户或网络
- en: Track users
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跟踪用户
- en: Expose camera playback feeds
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴露摄像头回放视频
- en: Delete camera playback feeds
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除摄像头回放视频
- en: Exploit a flaw in the web or application server of the vendor environment
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用供应商环境的Web或应用程序服务器中的漏洞
- en: Prevent access to legitimate users
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 防止合法用户访问
- en: Step 3 :Documenting threats
  id: totrans-281
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第3步：记录威胁
- en: Next, we will pick threat cases similar to what we have done in previous recipes
    and document their threat case description, threat target, attack technique(s),
    and any countermeasures that may be in place to rate their respective risk.
  id: totrans-282
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将选择类似于以前的案例的威胁案例，并记录它们的威胁案例描述、威胁目标、攻击技术和可能存在的任何对策，以评估它们各自的风险。
- en: 'Threat #1'
  id: totrans-283
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃1
- en: '| **Threat description** | **Attacker could execute operating system commands
    via command injection vulnerabilities** |'
  id: totrans-284
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能通过命令注入漏洞执行操作系统命令** |'
- en: '| Threat target | Embedded and vendor web app. |'
  id: totrans-285
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 嵌入式和供应商Web应用程序。 |'
- en: '| Attack techniques | Attacker discovers flaws in DVR and vendor API communications
    due to weak input validation. Attacker creates code that runs within the context
    of the application. Attacker gains access to backend systems with custom code
    injected into the application. |'
  id: totrans-286
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者发现DVR和供应商API通信中的漏洞，因为输入验证不严格。攻击者创建在应用程序上下文中运行的代码。攻击者通过将自定义代码注入应用程序来访问后端系统。
    |'
- en: '| Countermeasures | Applications perform input validation and contextual output
    encoding. |'
  id: totrans-287
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 应用程序执行输入验证和上下文输出编码。 |'
- en: 'Threat #2'
  id: totrans-288
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃2
- en: '| **Threat description** | **Attacker could forge requests under the logged-in
    user account (CSRF)** |'
  id: totrans-289
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能伪造已登录用户账户下的请求（CSRF）** |'
- en: '| Threat target | Embedded and vendor web app. |'
  id: totrans-290
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 嵌入式和供应商Web应用程序。 |'
- en: '| Attack techniques | Attacker identifies a vulnerable HTML form and creates
    code to forge the requested change in the context of the logged-in user. Such
    changes may include adding or sharing a user account to a third party. |'
  id: totrans-291
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者识别了一个易受攻击的HTML表单，并创建了代码来伪造已登录用户的请求更改。这些更改可能包括向第三方添加或共享用户账户。 |'
- en: '| Countermeasures | Implement anti-CSRF tokens for sensitive HTML forms that
    change application state. |'
  id: totrans-292
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 为改变应用程序状态的敏感HTML表单实施反CSRF令牌。 |'
- en: 'Threat #3'
  id: totrans-293
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃3
- en: '| **Threat description** | **Attacker could dump database contents via SQL
    injection** |'
  id: totrans-294
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能通过SQL注入转储数据库内容** |'
- en: '| Threat target | Vendor web app. |'
  id: totrans-295
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 供应商Web应用程序。 |'
- en: '| Attack techniques | An attacker appends or concatenates SQL commands to a
    vulnerable parameter that''s used to query the database. |'
  id: totrans-296
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者将SQL命令附加或连接到用于查询数据库的易受攻击参数。 |'
- en: '| Countermeasures | User input should be validated and queries should be parameterized
    or a stored procedure to access the database. |'
  id: totrans-297
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 应验证用户输入，并对查询进行参数化或使用存储过程来访问数据库。 |'
- en: 'Step 4 : Rating the threats'
  id: totrans-298
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤4：评估威胁
- en: 'Using the following table, we will choose one threat and find out its risk
    rating:'
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下表格，我们将选择一个威胁并找出其风险评级：
- en: '| **Threat risk rating: Attacker could dump database contents via SQL injection**
    |  |'
  id: totrans-300
  prefs: []
  type: TYPE_TB
  zh: '| **威胁风险评级：攻击者可能通过SQL注入转储数据库内容** |  |'
- en: '| **Item** | **Score** |'
  id: totrans-301
  prefs: []
  type: TYPE_TB
  zh: '| **项目** | **分数** |'
- en: '| Damage potential | 3 |'
  id: totrans-302
  prefs: []
  type: TYPE_TB
  zh: '| 损害潜力 | 3 |'
- en: '| Reproducibility | 3 |'
  id: totrans-303
  prefs: []
  type: TYPE_TB
  zh: '| 可重现性 | 3 |'
- en: '| Exploitability | 2 |'
  id: totrans-304
  prefs: []
  type: TYPE_TB
  zh: '| 可利用性 | 2 |'
- en: '| Affected users | 3 |'
  id: totrans-305
  prefs: []
  type: TYPE_TB
  zh: 受影响的用户：3
- en: '| Discoverability | 2 |'
  id: totrans-306
  prefs: []
  type: TYPE_TB
  zh: '| 可发现性 | 2 |'
- en: '| **Risk Rating Score: High** | **13** |'
  id: totrans-307
  prefs: []
  type: TYPE_TB
  zh: '| **风险评级分数：高** | **13** |'
- en: Clearly, there is more of a payoff to exploit vulnerabilities in the vendor's
    SaaS application given that there are loads of users' details with additional
    features available. However, it is important to stay within legal bounds and gain
    authorization prior to testing. Targeting the embedded web applications may not
    give as big of a reward up front but it is definitely possible once a poll is
    taken on the device usage online and a remotely exploitable vulnerability is discovered.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，利用供应商的SaaS应用程序中的漏洞会有更大的回报，因为有大量用户的详细信息和额外的功能可用。但是，重要的是要在法律范围内并获得授权后进行测试。针对嵌入式Web应用程序可能一开始并不会有太大的回报，但一旦对设备在线使用进行了调查并发现了可远程利用的漏洞，就肯定是可能的。
- en: Threat modeling an IoT mobile application
  id: totrans-309
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁建模IoT移动应用程序
- en: For our next threat modeling exercise, we will examine IoT mobile applications
    for our DVR system. This DVR system (like many others in IoT) has several mobile
    applications available developed by resellers and different OEMs. For demonstration
    purposes, we will only threat model one Android and one iOS application.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们的下一个威胁建模练习中，我们将检查DVR系统的IoT移动应用程序。这个DVR系统（像许多其他IoT系统一样）由经销商和不同的OEM开发了几个可用的移动应用程序。为了演示目的，我们将只对一个Android和一个iOS应用程序进行威胁建模。
- en: How to do it...
  id: totrans-311
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做…
- en: Since we have the majority of our data flow diagrams created from previous recipes,
    we will continue to use the same Microsoft Threat Modeling Tool for this recipe.
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经从以前的配方中创建了大部分数据流图，我们将继续使用相同的Microsoft威胁建模工具进行此配方。
- en: 'Step 1: Creating an architecture overview and decomposition'
  id: totrans-313
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤1：创建架构概述和分解
- en: 'Similar to our last couple of recipes, we will jump right to creating a data
    flow diagram which includes all known assets for the mobile applications. The
    following is the data flow diagram for the mobile applications:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 与我们上几个配方类似，我们将立即创建一个包含移动应用程序所有已知资产的数据流图。以下是移动应用程序的数据流图：
- en: '![](img/0ba5ad59-60d4-49f0-96c6-4666befa3cb7.png)'
  id: totrans-315
  prefs: []
  type: TYPE_IMG
  zh: '![](img/0ba5ad59-60d4-49f0-96c6-4666befa3cb7.png)'
- en: We can see that the applications contact the third-party vendor cloud environment
    each time in order to view account details and camera feeds. This also occurs
    when the user is in the same network as the DVR. A username and password is needed
    to access the DVR remotely, which is also stored within the mobile devices. At
    this point, we do not know how this data is stored or sent when communicating
    with the vendor backend systems. This leads us to our next step, identifying threats.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到应用程序每次都会联系第三方供应商的云环境，以查看帐户详细信息和摄像头回放。当用户与DVR处于同一网络时也会发生这种情况。远程访问DVR需要用户名和密码，这也存储在移动设备中。在这一点上，我们不知道在与供应商后端系统通信时如何存储或发送这些数据。这引出了我们的下一步，识别威胁。
- en: 'Step 2: Identifying threats'
  id: totrans-317
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2：识别威胁
- en: 'An attacker could exploit the mobile application to do the following:'
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用移动应用程序执行以下操作：
- en: Eavesdrop on API calls
  id: totrans-319
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃听API调用
- en: Access local resources on the mobile device
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问移动设备上的本地资源
- en: Expose sensitive user details
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴露敏感用户详细信息
- en: Locate sensitive information for all users in clear text on the mobile device
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在移动设备上以明文查找所有用户的敏感信息
- en: Dump database contents via SQL(ite) injection
  id: totrans-323
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过SQL(ite)注入转储数据库内容
- en: Perform arbitrary script execution via WebView JavaScript interface
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过WebView JavaScript接口执行任意脚本
- en: Gain access to other user accounts
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 访问其他用户帐户
- en: Track users in the vendor's cloud environment
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 跟踪供应商云环境中的用户
- en: Expose camera playback feeds stored on the device
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴露存储在设备上的摄像头回放
- en: Delete camera playback feeds
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 删除摄像头回放
- en: Change user information
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改用户信息
- en: Add users for sharing cameras without authorization
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加用户以共享摄像头而无需授权
- en: Create long-lived sessions that do not expire for persistent access
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建不会过期的长期会话以持久访问
- en: Take screenshots and send them to a third party
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 拍摄屏幕截图并发送给第三方
- en: 'Step 3: Documenting threats'
  id: totrans-333
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤3：记录威胁
- en: Next, we will pick threat cases similar to what we have done in previous recipes
    and document them to rate their respective risk.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将选择与以前的配方类似的威胁案例，并对其进行评分。
- en: 'Threat #1'
  id: totrans-335
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃1
- en: '| **Threat description** | **Attacker could access local resources on the mobile
    device** |'
  id: totrans-336
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能访问移动设备上的本地资源** |'
- en: '| Threat target | Mobile apps. |'
  id: totrans-337
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 移动应用程序。 |'
- en: '| Attack techniques | Attacker discovers flaws in API communications that expose
    a WebView to a JavaScript bridge for access to local objects. Attacker exploits
    a SQL injection for SQLite calls locally on the mobile device to attach a database
    and create a file which has access to local resources. |'
  id: totrans-338
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者发现API通信中的漏洞，从而使WebView暴露给JavaScript桥接以访问本地对象。攻击者利用SQL注入在移动设备上本地执行SQLite调用，以附加数据库并创建具有访问本地资源权限的文件。
    |'
- en: '| Countermeasures | Applications disable JavaScript within WebViews or whitelist
    accepts scripts. Applications validate user input and disallow dynamic queries
    to execute. |'
  id: totrans-339
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 应用程序在WebView中禁用JavaScript或白名单接受脚本。应用程序验证用户输入并禁止执行动态查询。 |'
- en: 'Threat #2'
  id: totrans-340
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '威胁 #2'
- en: '| **Threat description** | **Attacker could locate sensitive information for
    all users in clear text on the mobile device** |'
  id: totrans-341
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能在移动设备上以明文形式找到所有用户的敏感信息** |'
- en: '| Threat target | Mobile apps. |'
  id: totrans-342
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 移动应用。 |'
- en: '| Attack techniques | Attacker monitors file storage during runtime and finds
    data being synced from the vendor cloud to the mobile device, exposing sensitive
    information. |'
  id: totrans-343
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者在运行时监视文件存储，并发现从供应商云同步到移动设备的数据，暴露了敏感信息。 |'
- en: '| Countermeasures | Only data required for use should be stored on the device.
    |'
  id: totrans-344
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 只应存储设备上所需的数据。 |'
- en: 'Threat #3'
  id: totrans-345
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '威胁 #3'
- en: '| **Threat description** | **Attacker could add users for sharing cameras without
    authorization** |'
  id: totrans-346
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能未经授权添加用户共享摄像头** |'
- en: '| Threat target | Mobile apps. |'
  id: totrans-347
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 移动应用。 |'
- en: '| Attack techniques | An attacker creates a CSRF request that is sent to victims
    to auto-add a user for sharing. |'
  id: totrans-348
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者创建CSRF请求发送给受害者，自动添加用户进行共享。 |'
- en: '| Countermeasures | Use anti-CSRF tokens. |'
  id: totrans-349
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 使用反CSRF令牌。 |'
- en: 'Step 4: Rating the threats'
  id: totrans-350
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤4：评估威胁
- en: 'Using the following table, we will choose one threat and find out its risk
    rating:'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下表格，我们将选择一个威胁并找出其风险评分：
- en: '| **Threat risk rating: Attacker could access local resources on the mobile
    device** |'
  id: totrans-352
  prefs: []
  type: TYPE_TB
  zh: '| **威胁风险评估：攻击者可能访问移动设备上的本地资源** |'
- en: '| **Item** | **Score** |'
  id: totrans-353
  prefs: []
  type: TYPE_TB
  zh: '| **项目** | **分数** |'
- en: '| Damage potential | 3 |'
  id: totrans-354
  prefs: []
  type: TYPE_TB
  zh: '| 损害潜力 | 3 |'
- en: '| Reproducibility | 2 |'
  id: totrans-355
  prefs: []
  type: TYPE_TB
  zh: '| 可重现性 | 2 |'
- en: '| Exploitability | 1 |'
  id: totrans-356
  prefs: []
  type: TYPE_TB
  zh: '| 可利用性 | 1 |'
- en: '| Affected users | 1 |'
  id: totrans-357
  prefs: []
  type: TYPE_TB
  zh: '| 受影响用户 | 1 |'
- en: '| Discoverability | 2 |'
  id: totrans-358
  prefs: []
  type: TYPE_TB
  zh: '| 可发现性 | 2 |'
- en: '| **Risk rating score: Medium** | **9** |'
  id: totrans-359
  prefs: []
  type: TYPE_TB
  zh: '| **风险评分：中等** | **9** |'
- en: In the mobile space, common threats pertain to data and the way it's stored
    as well as transported. As a result, the risk is relatively low in mobile bugs
    unless the exploit affects a large number of users or many users' data was to
    be exposed. It would be rare for a mobile vulnerability to result in a shell on
    the server or mobile device during application testing.
  id: totrans-360
  prefs: []
  type: TYPE_NORMAL
  zh: 在移动领域，常见的威胁涉及数据及其存储和传输方式。因此，除非利用影响了大量用户或许多用户的数据被暴露，否则移动漏洞的风险相对较低。在应用程序测试期间，移动漏洞很少会导致服务器或移动设备上的shell。
- en: Threat modeling IoT device hardware
  id: totrans-361
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁建模物联网设备硬件
- en: It is time to analyze hardware threats for our target DVR. Most consumer DVRs
    are easy to open up and disassemble to examine their various inputs as well as
    their peripherals. This is due to the need to expand storage space or simply because
    they are not designed to be heavy duty like production **hardware security modules**
    (**HSMs**) which have tamper protections in place.
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
  zh: 现在是时候分析我们目标DVR的硬件威胁了。大多数消费级DVR都很容易打开和拆解，以检查它们的各种输入以及外围设备。这是因为需要扩展存储空间，或者仅仅是因为它们不像生产**硬件安全模块**（HSM）那样设计成重型设备，后者具有防篡改保护措施。
- en: How to do it...
  id: totrans-363
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做到...
- en: In this exercise, we use [https://draw.io](https://draw.io) diagrams to help
    us with demonstrating hardware inputs.
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个练习中，我们使用[https://draw.io](https://draw.io)图表来帮助我们展示硬件输入。
- en: 'Step 1: Creating an architecture overview and decomposition'
  id: totrans-365
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤1：创建架构概述和分解
- en: 'The following is a diagram of the DVR''s hardware:'
  id: totrans-366
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是DVR硬件的示意图：
- en: '![](img/3e84dc12-c798-4bb5-9794-aedbeee14068.png)'
  id: totrans-367
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3e84dc12-c798-4bb5-9794-aedbeee14068.png)'
- en: Depicting the image, there are eight BNC connectors for cameras, two USB ports,
    one Ethernet port, one power port, a VGA, and an HDMI port facing the outside
    of the DVR. Inside the DVR are various chips, with one being an EEPROM and possible
    inputs for UART on the PCB board itself.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 根据图像描述，DVR上有八个用于摄像头的BNC连接器，两个USB端口，一个以太网端口，一个电源端口，一个VGA和一个面向DVR外部的HDMI端口。DVR内部有各种芯片，其中一个是EEPROM，可能在PCB板上有UART的输入。
- en: 'Step 2: Identifying threats'
  id: totrans-369
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2：识别威胁
- en: 'An attacker could exploit the DVR hardware inputs to do the following:'
  id: totrans-370
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用DVR硬件输入来执行以下操作：
- en: Gain access to the consoles via UART
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过UART访问控制台
- en: Dump secrets within the EEPROM
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在EEPROM中转储秘钥
- en: Exploit a flaw in the USB stack to the DVR
  id: totrans-373
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用USB堆栈中的漏洞到DVR
- en: Attach a malicious USB device that causes corruption
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接恶意USB设备导致损坏
- en: Short the DVR power inputs
  id: totrans-375
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 短接DVR电源输入
- en: Glitch the DVR bootloader into console access
  id: totrans-376
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使DVR引导加载程序进入控制台访问
- en: Install malicious software via USB
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过USB安装恶意软件
- en: 'Step 3: Documenting threats'
  id: totrans-378
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤3：记录威胁
- en: 'Next, we will pick threat cases similar to what we have done in previous recipes
    and document them to rate their respective risk:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将挑选类似于之前的案例，并记录它们以评估各自的风险：
- en: 'Threat #1'
  id: totrans-380
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '威胁 #1'
- en: '| **Threat description** | **Attacker could gain access to the consoles via
    UART** |'
  id: totrans-381
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能通过UART访问控制台** |'
- en: '| Threat target | UART. |'
  id: totrans-382
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | UART。 |'
- en: '| Attack techniques | Attack UART headers on the PCB board of the device. |'
  id: totrans-383
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击设备的PCB板上的UART标头。 |'
- en: '| Countermeasures | UART access is password protected. UART access is blocked
    by another chip. |'
  id: totrans-384
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | UART访问受密码保护。UART访问被另一芯片阻止。 |'
- en: 'Threat #2'
  id: totrans-385
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '威胁 #2'
- en: '| **Threat description** | **Attacker could dump secrets within the EEPROM**
    |'
  id: totrans-386
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能在EEPROM中转储秘钥** |'
- en: '| Threat target | EEPROM. |'
  id: totrans-387
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | EEPROM。 |'
- en: '| Attack techniques | Attacker attaches an SOIC clip on top of the EEPROM to
    read its contents. |'
  id: totrans-388
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者在EEPROM顶部附加SOIC夹子以读取其内容。 |'
- en: '| Countermeasures | Prevent storage of sensitive data within the EEPROM. |'
  id: totrans-389
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 防止在EEPROM中存储敏感数据。 |'
- en: 'Threat #3'
  id: totrans-390
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '威胁 #3'
- en: '| **Threat description** | **Attacker could glitch the DVR bootloader into
    console access** |'
  id: totrans-391
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能会使DVR引导加载程序进入控制台访问** |'
- en: '| Threat target | EEPROM. |'
  id: totrans-392
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | EEPROM。 |'
- en: '| Attack techniques | An attacker interrupts timing of the bootloader to access
    the console. |'
  id: totrans-393
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者中断引导加载程序的时间以访问控制台。 |'
- en: '| Countermeasures | Implement glitch protections or tamper protections. |'
  id: totrans-394
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 实施故障保护或篡改保护。 |'
- en: 'Step 4: Rating the threats'
  id: totrans-395
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤4：评估威胁
- en: 'Using the following table, we will choose one threat and find out its risk
    rating:'
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下表格，我们将选择一个威胁并找出其风险评级：
- en: '| **Threat risk rating: Attacker could gain access to the consoles via UART**
    |'
  id: totrans-397
  prefs: []
  type: TYPE_TB
  zh: '| **威胁风险评级：攻击者可能通过UART访问控制台** |'
- en: '| **Item** | **Score** |'
  id: totrans-398
  prefs: []
  type: TYPE_TB
  zh: '| **项目** | **分数** |'
- en: '| Damage Potential | 3 |'
  id: totrans-399
  prefs: []
  type: TYPE_TB
  zh: '| 损害潜力 | 3 |'
- en: '| Reproducibility | 3 |'
  id: totrans-400
  prefs: []
  type: TYPE_TB
  zh: '| 可重现性 | 3 |'
- en: '| Exploitability | 2 |'
  id: totrans-401
  prefs: []
  type: TYPE_TB
  zh: '| 可利用性 | 2 |'
- en: '| Affected Users | 1 |'
  id: totrans-402
  prefs: []
  type: TYPE_TB
  zh: '| 受影响的用户 | 1 |'
- en: '| Discoverability | 2 |'
  id: totrans-403
  prefs: []
  type: TYPE_TB
  zh: '| 可发现性 | 2 |'
- en: '| **Risk rating score: High** | **11** |'
  id: totrans-404
  prefs: []
  type: TYPE_TB
  zh: '| **风险评级分数：高** | **11** |'
- en: Threat modeling IoT radio communication
  id: totrans-405
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 物联网无线电通信威胁建模
- en: Moving on to radio/wireless communication, our DVR does not have much going
    on with regards to radio communication other than the data that transports to
    the DVR from client applications or cameras. Most IoT devices and environments
    have several different radio communications broadcasting on different frequencies
    using different protocols. Luckily, we only have to worry about Wi-Fi and cell
    provider entry points into the DVR.
  id: totrans-406
  prefs: []
  type: TYPE_NORMAL
  zh: 转向无线/无线通信，我们的DVR在无线通信方面并没有太多的活动，除了从客户端应用程序或摄像头传输到DVR的数据。大多数物联网设备和环境在不同频率上使用不同协议进行广播。幸运的是，我们只需要担心Wi-Fi和蜂窝供应商进入DVR的入口。
- en: How to do it...
  id: totrans-407
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何做…
- en: For our radio communication threat modeling exercise, we can simply update previously
    drawn diagrams to reflect the radio communication that occurs within devices and
    applications.
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的无线电通信威胁建模练习，我们可以简单地更新先前绘制的图表，以反映设备和应用程序内发生的无线电通信。
- en: 'Step 1: Creating an architecture overview and decomposition'
  id: totrans-409
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤1：创建架构概述和分解
- en: 'An example architecture overview for radio communication usage within the DVR
    system is illustrated as follows:'
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
  zh: DVR系统内无线通信使用的架构概述示例如下：
- en: '![](img/3fa2ea24-b3d1-4357-adf9-7caa0de6c52d.png)'
  id: totrans-411
  prefs: []
  type: TYPE_IMG
  zh: '![](img/3fa2ea24-b3d1-4357-adf9-7caa0de6c52d.png)'
- en: As you may be able to tell, the wireless communication is limited to users accessing
    the DVR via client devices such as a browser and applications as well as wireless-enabled
    IP camera's which are optional. Also note that our diagram has iterated being
    that more information about the DVR has been acquired through previous threat
    models.
  id: totrans-412
  prefs: []
  type: TYPE_NORMAL
  zh: 正如您可能已经注意到的那样，无线通信仅限于用户通过客户端设备（如浏览器和应用程序）访问DVR以及可选的无线IP摄像头。还要注意的是，我们的图表已经迭代，因为通过先前的威胁模型已经获得了有关DVR的更多信息。
- en: 'Step 2: Identifying threats'
  id: totrans-413
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2：识别威胁
- en: 'An attacker could exploit wireless communications to do the following:'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者可以利用无线通信来做以下事情：
- en: Access the DVR network from a long-range distance
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从长距离访问DVR网络
- en: Eavesdrop on DVR wireless communication
  id: totrans-416
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃听DVR无线通信
- en: Jam DVR communication
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 干扰DVR通信
- en: Remove IP cameras from the DVR
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从DVR中移除IP摄像头
- en: Set up a fake access point to connect cameras
  id: totrans-419
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 建立一个虚假接入点来连接摄像头
- en: Eavesdrop on cellular communication
  id: totrans-420
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 窃听手机通信
- en: Set up a fake base station for **Global Systems for Mobile Communications**
    (**GSM**)
  id: totrans-421
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 为**全球移动通信系统**（**GSM**）建立一个虚假基站
- en: Spoof client application requests
  id: totrans-422
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 伪造客户端应用程序请求
- en: Add fake IP cameras
  id: totrans-423
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 添加虚假IP摄像头
- en: Access DVR systems through rogue client applications
  id: totrans-424
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过恶意客户端应用程序访问DVR系统
- en: 'Step 3: Documenting threats'
  id: totrans-425
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤3：记录威胁
- en: 'Next, we will pick threat cases similar to what we have done in previous recipes
    and document them to rate their respective risk:'
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将挑选类似于我们在以前的案例中所做的威胁，并记录它们以评估其各自的风险：
- en: 'Threat #1'
  id: totrans-427
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃1
- en: '| **Threat description** | **Attacker could access the DVR network from a long-range
    distance** |'
  id: totrans-428
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能从长距离访问DVR网络** |'
- en: '| Threat target | Wireless. |'
  id: totrans-429
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 无线。 |'
- en: '| Attack techniques | Attacker exploits wireless communication from any given
    client application via man-in-the-middle techniques or hijacking of user sessions
    from a wireless client. |'
  id: totrans-430
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者利用中间人技术或窃取无线客户端的用户会话，从任何给定的客户端应用程序中利用无线通信。 |'
- en: '| Countermeasures | Authorized devices should be implemented and whitelisted.
    |'
  id: totrans-431
  prefs: []
  type: TYPE_TB
  zh: 对策 | 应实施授权设备并列入白名单。
- en: 'Threat #2'
  id: totrans-432
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃2
- en: '| **Threat description** | **Attacker could jam DVR communications** |'
  id: totrans-433
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能干扰DVR通信** |'
- en: '| Threat target | Wireless. |'
  id: totrans-434
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 无线。 |'
- en: '| Attack techniques | Attacker identifies DVR traffic broadcasting from an
    IP camera or client device to replay traffic at a rate the DVR cannot consume.
    |'
  id: totrans-435
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者识别从IP摄像头或客户端设备传输到DVR的流量，以便以DVR无法消耗的速率重放流量。 |'
- en: '| Countermeasures | Implement anti-jamming protections or block malicious IP
    addresses within a given threshold. |'
  id: totrans-436
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 应实施防干扰保护或在给定阈值内阻止恶意IP地址。 |'
- en: 'Threat #3'
  id: totrans-437
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁＃3
- en: '| **Threat description** | **Attacker could add fake IP cameras** |'
  id: totrans-438
  prefs: []
  type: TYPE_TB
  zh: '| **威胁描述** | **攻击者可能添加虚假IP摄像头** |'
- en: '| Threat target | Wireless. |'
  id: totrans-439
  prefs: []
  type: TYPE_TB
  zh: '| 威胁目标 | 无线。 |'
- en: '| Attack techniques | An attacker mimics an IP camera to be added to the network
    which contains malicious firmware. |'
  id: totrans-440
  prefs: []
  type: TYPE_TB
  zh: '| 攻击技术 | 攻击者模拟一个包含恶意固件的IP摄像头添加到网络中。 |'
- en: '| Countermeasures | Client validation from the DVR should be implemented. |'
  id: totrans-441
  prefs: []
  type: TYPE_TB
  zh: '| 对策 | 应实施来自DVR的客户端验证。 |'
- en: 'Step 4: Rating the threats'
  id: totrans-442
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤4：评估威胁
- en: 'Using the following table, we will choose one threat and find out its risk
    rating:'
  id: totrans-443
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下表格，我们将选择一个威胁并找出其风险评级：
- en: '| **Threat risk rating: Attacker could access to the DVR network from a long-range
    distance** |'
  id: totrans-444
  prefs: []
  type: TYPE_TB
  zh: '| **威胁风险评级：攻击者可能从长距离访问DVR网络** |'
- en: '| **Item** | **Score** |'
  id: totrans-445
  prefs: []
  type: TYPE_TB
  zh: '| **项目** | **分数** |'
- en: '| Damage potential | 3 |'
  id: totrans-446
  prefs: []
  type: TYPE_TB
  zh: '| 损害潜力 | 3 |'
- en: '| Reproducibility | 2 |'
  id: totrans-447
  prefs: []
  type: TYPE_TB
  zh: '| 可重现性 | 2 |'
- en: '| Exploitability | 3 |'
  id: totrans-448
  prefs: []
  type: TYPE_TB
  zh: '| 可利用性 | 3 |'
- en: '| Affected users | 1 |'
  id: totrans-449
  prefs: []
  type: TYPE_TB
  zh: '| 受影响的用户 | 1 |'
- en: '| Discoverability | 3 |'
  id: totrans-450
  prefs: []
  type: TYPE_TB
  zh: '| 可发现性 | 3 |'
- en: '| **Risk rating score: High** | **12** |'
  id: totrans-451
  prefs: []
  type: TYPE_TB
  zh: '| **风险评级分数：高** | **12** |'
- en: Wireless threats within the DVR environment can be rather simple using common
    wireless man-in-the-middle techniques. Other threats such as adding fake IP cameras
    may be a bit more difficult and not worth the time for an attacker looking to
    make a bigger impact.
  id: totrans-452
  prefs: []
  type: TYPE_NORMAL
  zh: DVR环境中的无线威胁可以使用常见的无线中间人技术，相当简单。其他威胁，如添加假IP摄像头，可能会更加困难，对于寻求更大影响的攻击者来说可能不值得。
