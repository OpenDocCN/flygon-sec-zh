- en: Introduction to Penetration Testing
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 渗透测试简介
- en: In this chapter, we begin our journey by building a solid foundation. Having
    a good understanding of the basics of penetration testing will help you conduct
    a successful penetration test, as opposed to haphazardly scanning networks and
    performing tests blindly. We will define penetration testing and how it differs
    from other security assessments. Before the actual penetration test occurs, there
    are a few things that need to be done in order to ensure that the correct authorization
    is in place and the correct scope is defined. Every successful penetration testing
    student requires a lab environment—it can be daunting to build one, but don't
    despair. We will look at what options exist for a lab environment.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将通过建立坚实的基础来开始我们的旅程。对渗透测试基础知识的深入了解将有助于您进行成功的渗透测试，而不是盲目扫描网络和进行测试。我们将定义渗透测试以及它与其他安全评估的区别。在实际的渗透测试发生之前，需要做一些事情，以确保正确的授权和正确的范围得到定义。每个成功的渗透测试学生都需要一个实验室环境——建立一个可能令人生畏，但不要绝望。我们将看看实验室环境的哪些选项存在。
- en: 'As you progress through the chapter, you will learn the following:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 随着本章的进行，您将学到以下内容：
- en: What is penetration testing?
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是渗透测试？
- en: Stages of a penetration test
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试的阶段
- en: Getting started with your lab
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 开始您的实验室
- en: Creating **virtual machines** (**VMs**) in VMware, Hyper-V, and Virtualbox
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在VMware、Hyper-V和Virtualbox中创建虚拟机（VMs）
- en: Technical requirements
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'The following technical requirements are required for this chapter:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 本章需要以下技术要求：
- en: Kali Linux version 2019.1
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kali Linux 2019.1 版
- en: Any hypervisor, such as VMware, Hyper-V, or Virtualbox
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何虚拟化软件，如VMware、Hyper-V或Virtualbox
- en: What is penetration testing?
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 什么是渗透测试？
- en: 'Today, penetration testing is often confused with vulnerability assessments,
    red team assessments, and other security assessments. However, there are some
    differences between them, as follows:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 今天，渗透测试经常与漏洞评估、红队评估和其他安全评估混淆。然而，它们之间存在一些区别，如下所示：
- en: '**Vulnerability assessment**: This is the process of identifying vulnerabilities
    and risks in systems. In a vulnerability assessment, the vulnerability is not
    exploited. It merely highlights the risks so that the business can identify the
    risks and plan for remediation.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 漏洞评估：这是识别系统中的漏洞和风险的过程。在漏洞评估中，漏洞不会被利用。它只是突出显示风险，以便业务可以识别风险并制定补救计划。
- en: '**Penetration testing**: This is the authorized process of finding and using
    vulnerabilities to perform an intrusion into a network, application, or host in
    a predefined time frame. Penetration testing can be conducted by an internal team
    or an external third party. Penetration testing goes one step further as opposed
    to a vulnerability assessment, in that a penetration test exploits the vulnerability
    to ensure it is not a false positive. Penetration testing does not involve anything
    that is unauthorized or uncoordinated. During a penetration test, some tests might
    affect business applications and cause downtime. For this reason, awareness at
    the management and staff levels is often required.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试：这是一种授权的过程，通过在预定的时间范围内查找和利用漏洞来对网络、应用程序或主机进行入侵。渗透测试可以由内部团队或外部第三方进行。与漏洞评估相比，渗透测试更进一步，因为渗透测试利用漏洞以确保它不是虚假阳性。渗透测试不涉及任何未经授权或协调的行为。在渗透测试期间，一些测试可能会影响业务应用程序并导致停机。因此，通常需要管理和员工层面的意识。
- en: '**Red team assessment**: This is similar to a penetration test, but it''s more
    targeted. As a penetration test''s main aim is to discover multiple vulnerabilities
    and exploit them, the goal of a red team assessment is to test an organization''s
    response capabilities and act on vulnerabilities that will meet their goals. In
    a red team assessment, the team will attempt to access information in any way
    possible and remain as quiet as possible. Stealth is key in a red team assessment.
    In a red team assessment, the duration of the assessment is much longer than a
    penetration test.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 红队评估：这类似于渗透测试，但更有针对性。渗透测试的主要目的是发现多个漏洞并利用它们，而红队评估的目标是测试组织的响应能力并利用满足其目标的漏洞。在红队评估中，团队将尝试以任何可能的方式访问信息并保持尽可能安静。在红队评估中，隐秘性是关键。红队评估的持续时间比渗透测试长得多。
- en: As you start your penetration testing journey, it's important to understand
    what penetration testing is. To illustrate what penetration testing is, let's
    consider a scenario.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在开始渗透测试之旅时，了解渗透测试的含义非常重要。为了说明渗透测试是什么，让我们考虑一个场景。
- en: You currently own an organization that holds customer data. Within your organization,
    you have SQL databases, public-facing websites, internet-facing servers, and a
    sizeable number of users. Your organization is a prime target for a number of
    attacks, such as SQL injections, social engineering against users, and weak passwords.
    Should your organization be compromised, there is a risk of customer data being
    exposed, and more.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 您目前拥有一个持有客户数据的组织。在您的组织中，您拥有SQL数据库、面向公众的网站、面向互联网的服务器和大量用户。您的组织是多种攻击的主要目标，例如SQL注入、针对用户的社会工程和弱密码。如果您的组织受到损害，存在客户数据被泄露等风险。
- en: In order to reduce your exposure to risks, you need to identify the holes in
    your current security posture. Penetration testing helps you to identify these
    holes in a controlled manner before an attacker does. Penetration testing uses
    real-world attacks that attackers would leverage; the aim is to obtain accurate
    information as to how deep an attacker could go within your network and how much
    information the attacker could obtain. The results of a penetration test give
    organizations an open view of the vulnerabilities and allow them to patch these
    before an adversary can act on them.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 为了减少您面临的风险，您需要确定当前安全状况中的漏洞。渗透测试可以帮助您以受控的方式识别这些漏洞，而不是等到攻击者这样做。渗透测试使用攻击者可能利用的真实攻击；目标是获得有关攻击者在您的网络中可以深入多深以及攻击者可以获得多少信息的准确信息。渗透测试的结果为组织提供了漏洞的开放视图，并允许他们在对手采取行动之前修补这些漏洞。
- en: Think of penetration testing as looking through the eyes of an enemy.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 把渗透测试看作是从敌人的角度来看。
- en: Penetration testing is often referred to as ethical hacking, white hat hacking,
    pentest, or pentesting.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试通常被称为道德黑客、白帽黑客、渗透测试或渗透测试。
- en: As the security maturity of organizations differs, so will the scope of your
    penetration tests. Some organizations might have really good security mechanisms
    in place, while others might not. As businesses have policies, business continuity
    plans, risk assessments, and disaster recovery as integral parts of their overall
    security, penetration testing needs to be included.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 由于组织的安全成熟度不同，渗透测试的范围也会有所不同。一些组织可能已经建立了非常好的安全机制，而其他一些可能没有。由于企业有政策、业务连续性计划、风险评估和灾难恢复作为整体安全的重要组成部分，渗透测试需要被纳入其中。
- en: Stages of a penetration test
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 渗透测试的阶段
- en: Now that you understand what penetration testing is, you may be wondering what
    the flow of a penetration test is. Penetration testing has a number of stages,
    and each stage forms an important part of the overall penetration test.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 现在您了解了什么是渗透测试，您可能想知道渗透测试的流程是什么。渗透测试有许多阶段，每个阶段都是整个渗透测试的重要组成部分。
- en: 'There are various standards that relate to penetration testing. This book does
    not follow any one of them specifically. There are other known standards, such
    as the following:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 有各种与渗透测试相关的标准。本书没有专门遵循其中任何一个。还有其他已知的标准，例如以下：
- en: NIST SP800-115 standard – [https://csrc.nist.gov/publications/detail/sp/800-115/final](https://csrc.nist.gov/publications/detail/sp/800-115/final)
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NIST SP800-115标准 - [https://csrc.nist.gov/publications/detail/sp/800-115/final](https://csrc.nist.gov/publications/detail/sp/800-115/final)
- en: '**Open Source Security Testing Methodology Manual **(**OSSTMM**) – [http://www.isecom.org/research](http://www.isecom.org/research)'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**开源安全测试方法手册**（**OSSTMM**） - [http://www.isecom.org/research](http://www.isecom.org/research)'
- en: The following stages follow the **Penetration Testing Execution Standard** (**PTES**),
    which I found to be a great starting point. The full standard can be found at [http://www.pentest-standard.org/](http://www.pentest-standard.org/).
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来的阶段遵循**渗透测试执行标准**（**PTES**），我发现这是一个很好的起点。完整的标准可以在[http://www.pentest-standard.org/](http://www.pentest-standard.org/)找到。
- en: Pre-engagement
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 预约
- en: This is the most important phase in every penetration test. In this phase, you
    start defining the blueprint for the penetration test and align this blueprint
    to the business goals of the client. The aim is to ensure that everyone involved
    is on the same page and expectations are set well in advance.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这是每次渗透测试中最重要的阶段。在这个阶段，您开始为渗透测试定义蓝图，并将这个蓝图与客户的业务目标对齐。目标是确保所有参与者都在同一页面上，并且预期提前设定。
- en: During this phase, as a penetration tester, you need to take time to understand
    your client's requirements and goals. For example, why is the client performing
    a penetration test? Was the client compromised? Is the client performing the penetration
    test purely to meet a compliance requirement, or does the client intend to perform
    remediation on the findings? Talking to the client and understanding their business
    goals will help you plan and scope your penetration test so that any sticky situation
    can be avoided.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段，作为渗透测试人员，您需要花时间了解客户的需求和目标。例如，为什么客户要进行渗透测试？客户是否受到了侵害？客户进行渗透测试纯粹是为了满足合规要求，还是客户打算对发现的问题进行修复？与客户交谈并了解他们的业务目标将帮助您规划和确定渗透测试的范围，以避免任何棘手的情况。
- en: The pre-engagement phase consists of a few additional components that you need
    to consider.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 预约阶段包括您需要考虑的一些额外组件。
- en: Scoping
  id: totrans-32
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 范围
- en: This component defines what will be tested. Here, the key is in finding a balance
    between time, cost, and the goals of the business. It's important to note that
    everything agreed upon during the scope must be clearly documented and all legal
    implications must be considered.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 这个组件定义了将要测试的内容。在这里，关键在于在时间、成本和业务目标之间找到平衡。重要的是要注意，在范围内达成的一切都必须清楚地记录，并且必须考虑所有的法律影响。
- en: 'During this component, you will ask questions such as the following:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个组件中，您将提出以下问题：
- en: What is the number of IP address ranges or systems that will be tested?
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将要测试的IP地址范围或系统的数量是多少？
- en: Does the penetration test cover physical security, wireless networks, application
    servers, social engineering, and so on?
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试是否涵盖物理安全、无线网络、应用服务器、社会工程等？
- en: What is off-limits for the penetration test? The business might have mission-critical
    systems that could lead to loss of revenue if these are affected by the penetration
    test.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试的禁区是什么？企业可能有关键任务系统，如果这些系统受到渗透测试的影响，可能会导致收入损失。
- en: Will the penetration test be onsite or offsite?
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试是现场进行还是远程进行？
- en: Are there any third-party servers that are in the scope of the penetration test?
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 渗透测试的范围中是否包括第三方服务器？
- en: Are you performing a white-box, grey-box, or black-box penetration test?
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您是否进行了白盒、灰盒或黑盒渗透测试？
- en: The questions listed do not cover everything, and the questions will vary per
    client. To get a more comprehensive list of the type of questions you should consider,
    you can refer to the PTES Standard at [http://www.pentest-standard.org/index.php/Pre-engagement](http://www.pentest-standard.org/index.php/Pre-engagement).
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 列出的问题并不涵盖所有内容，问题会因客户而异。要获得更全面的问题清单，可以参考PTES标准[http://www.pentest-standard.org/index.php/Pre-engagement](http://www.pentest-standard.org/index.php/Pre-engagement)。
- en: '**White-box** testing gives you complete open access to systems, code, network
    diagrams, and so on. It provides more comprehensive results that are not available
    to average attackers.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '**白盒**测试可以完全开放地访问系统、代码、网络图等。它提供了对一般攻击者不可得的更全面的结果。'
- en: '**Grey-box** testing gives you some sort of information about the internal
    systems; the aim is to obtain information from the viewpoint of an attacker who
    has already breached the system.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: '**灰盒**测试可以让你获取一些关于内部系统的信息；其目的是从已经侵入系统的攻击者的角度获取信息。'
- en: '**Black-box** testing does not provide you with any information or access to
    the network. This type of test is more practical, as you simulate an external
    attacker.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: '**黑盒**测试不提供任何关于网络的信息或访问权限。这种测试更实际，因为你模拟了一个外部攻击者。'
- en: While you work on scoping your penetration test, be very careful of **scope
    creep**. Scope creep is any additional work that is not agreed upon during the
    initial scope. It introduces risks to your penetration test, which can lead to
    loss of revenue for you, an unsatisfied client, and even legal implications. Scope
    creep is a trap that you can easily fall into.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定渗透测试范围时，要非常小心**范围蔓延**。**范围蔓延**是指在最初的范围内没有达成一致的任何额外工作。这会给你的渗透测试引入风险，可能导致你的收入损失，客户不满意，甚至法律责任。**范围蔓延**是一个容易陷入的陷阱。
- en: Keep in mind the cost of a penetration test when in the scoping phase. Penetration
    test prices vary depending on what needs to be tested. For example, testing a
    complex web application will require a lot more time and effort, therefore the
    cost will be a lot more when compared to a simple network penetration test. The
    regularity with which you conduct the penetration test is another factor that
    affects the cost.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定范围阶段要考虑渗透测试的成本。渗透测试的价格取决于需要测试的内容。例如，测试复杂的网络应用程序将需要更多的时间和精力，因此与简单的网络渗透测试相比，成本会更高。进行渗透测试的频率也是影响成本的另一个因素。
- en: Timelines
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时间表
- en: Timelines can be set by the client as to when you are allowed to perform the
    penetration test. Some clients might have business-critical servers that are patched
    during a specific time window, and these servers might be off-limits during that
    time.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 客户可以设定时间表，规定何时可以进行渗透测试。一些客户可能有在特定时间窗口内进行补丁更新的业务关键服务器，这些服务器在那段时间内可能是禁区。
- en: Ensure that the start and end dates are defined. This allows the penetration
    test to have a defined end date.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 确保定义了开始和结束日期。这样可以让渗透测试有一个明确的结束日期。
- en: Dealing with third parties
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 处理第三方
- en: Today, many businesses are utilizing cloud services. There is a high probability
    that you will encounter cloud servers within your penetration scope. It's important
    to keep in mind who owns the server. In the case of a cloud environment, the server
    is not owned by the business that the penetration test is being conducted for,
    but rather the cloud provider.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 如今，许多企业正在利用云服务。在你的渗透范围内很可能会遇到云服务器。重要的是要记住谁拥有这台服务器。在云环境中，服务器不是由进行渗透测试的企业拥有，而是由云提供商拥有。
- en: Big players in the cloud space, such as Microsoft, Amazon, and Google, all have
    penetration testing rules-of-engagement documents. These documents detail what
    you are allowed to do and what you are not allowed to do.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 云领域的大公司，如微软、亚马逊和谷歌，都有渗透测试的规则文件。这些文件详细说明了你可以做什么，以及你不能做什么。
- en: Microsoft defines its rules of engagement here: [https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement).
    [](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement) Amazon defines
    its rules of engagement here:[ ](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement)[https://aws.amazon.com/security/penetration-testing/](https://aws.amazon.com/security/penetration-testing/)[.](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement)
    [](https://aws.amazon.com/security/penetration-testing/) Google defines its rules
    of engagement here:[ ](https://aws.amazon.com/security/penetration-testing/)[https://cloud.google.com/security/overview/](https://cloud.google.com/security/overview/)[.](https://aws.amazon.com/security/penetration-testing/)
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 微软在这里定义了其参与规则：[https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement](https://www.microsoft.com/en-us/msrc/pentest-rules-of-engagement)。亚马逊在这里定义了其参与规则：[https://aws.amazon.com/security/penetration-testing/](https://aws.amazon.com/security/penetration-testing/)。谷歌在这里定义了其参与规则：[https://cloud.google.com/security/overview/](https://cloud.google.com/security/overview/)。
- en: Make sure that you obtain the correct approvals from the cloud provider if you
    have any cloud services within your penetration scope; failure to do so might
    lead to legal consequences.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 确保从云服务提供商那里获得正确的批准，如果你的渗透范围内涉及云服务；否则可能会导致法律后果。
- en: Payment
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 支付
- en: Discussions around payment terms are crucial, as it's common for large organizations
    to delay payments. You need to define your payment terms upfront. Clear dates
    should be defined as to when payments should be made.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 支付条款的讨论至关重要，因为大型组织常常会延迟付款。你需要事先定义支付条款。应明确规定付款应该何时进行。
- en: Don't forget to define the costs; for example, you will perform a penetration
    test on 10 IP addresses at a cost of $500 per IP address.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 不要忘记定义成本；例如，您将以每个IP地址500美元的成本对10个IP地址进行渗透测试。
- en: Your "get out of jail free card"
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 你的“免于入狱的牌”
- en: As you perform penetration testing, you will uncover multitudes of information
    that are valuable to real-world attackers, and you will also be performing activities
    that are illegal. The only thing that separates a penetration tester from a malicious
    hacker is permission.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行渗透测试时，您将发现大量对现实世界攻击者有价值的信息，您还将进行一些非法活动。唯一将渗透测试人员与恶意黑客区分开来的是权限。
- en: Obtaining the relevant permission forms your "get out of jail free card". The
    permission that is provided by the business details any constraints and authorizes
    you to perform activities defined in your scoping agreement.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 获得相关许可构成了您的“免于入狱的牌”。业务提供的许可详细说明了任何限制，并授权您执行在范围协议中定义的活动。
- en: It's a formal approval from the business to begin the penetration test.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 这是业务正式批准开始渗透测试。
- en: Intelligence gathering
  id: totrans-62
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 情报收集
- en: Once you have completed the pre-engagement phase, you need to gather as much
    information as you can before you begin your attack. In the intelligence-gathering
    phase, also referred to as information gathering, you start looking at how much
    information you can obtain about your target. You will gather information from
    publicly accessible resources. This is known as **Open Source Intelligence** (**OSINT**).
    You will start leveraging tools that can assist you, such as Maltego and Shodan.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 完成了前期阶段后，您需要在开始攻击之前收集尽可能多的信息。在情报收集阶段，也称为信息收集，您开始查看有关目标的信息。您将从公开可访问的资源中收集信息。这被称为**开源情报**（**OSINT**）。您将开始利用可以帮助您的工具，如Maltego和Shodan。
- en: The importance of intelligence gathering is that you are able to detect entry
    points into the target organization. Businesses and employees do not take into
    account how much of their data they can expose on the internet, so this data becomes
    a wealth of information for a determined attacker.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 情报收集的重要性在于您能够发现进入目标组织的入口点。企业和员工并未考虑他们在互联网上可以暴露多少数据，因此这些数据对于决心攻击者来说成为了丰富的信息。
- en: In [Chapter 3](96db9b59-1985-4390-aa0c-ba91c0b0e9cf.xhtml), *Performing Information
    Gathering*, we will cover information gathering in more detail.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第3章](96db9b59-1985-4390-aa0c-ba91c0b0e9cf.xhtml)中，*进行信息收集*，我们将更详细地介绍信息收集。
- en: Threat modeling
  id: totrans-66
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁建模
- en: Once you have gathered information in the intelligence-gathering phase, you
    start working on threat modeling. In threat modelling, you begin to create a structure
    of threats and how they relate to your target's environment. For example, you
    will identify systems that hold valuable information, then you will identify the
    threats that pertain to the systems and what vulnerabilities exist in the system
    that can allow the attacker to act on the threat.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您在情报收集阶段收集了信息，您就开始进行威胁建模。在威胁建模中，您开始创建威胁的结构以及它们与目标环境的关系。例如，您将识别持有有价值信息的系统，然后您将确定与系统相关的威胁以及系统中存在的漏洞，这些漏洞可以允许攻击者对威胁采取行动。
- en: 'Threat modeling has a few methodologies, such as the following:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁建模有一些方法，例如以下：
- en: '**Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service,
    Elevation of Privilege** (**STRIDE**)'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**欺骗、篡改、否认、信息披露、拒绝服务、权限提升**（**STRIDE**）'
- en: '**Process for Attack Simulation and Threat Analysis** (**PASTA**)'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**攻击模拟和威胁分析过程**（**PASTA**）'
- en: '**Visual Agile and Simple Threat Modelling** (**VAST**)'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**视觉敏捷和简单威胁建模**（**VAST**）'
- en: 'There are few tools that you can leverage for threat modeling; the most common
    being the following two:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 有一些工具可以用于威胁建模；最常见的是以下两种：
- en: '**Microsoft Threat Modelling Tool**: [https://aka.ms/tmt](https://aka.ms/tmt)'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Microsoft威胁建模工具**：[https://aka.ms/tmt](https://aka.ms/tmt)'
- en: '**OWASP Threat Dragon**: [https://www.owasp.org/index.php/OWASP_Threat_Dragon](https://www.owasp.org/index.php/OWASP_Threat_Dragon)'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OWASP威胁龙**：[https://www.owasp.org/index.php/OWASP_Threat_Dragon](https://www.owasp.org/index.php/OWASP_Threat_Dragon)'
- en: Vulnerability analysis
  id: totrans-75
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 漏洞分析
- en: Once you have defined the threats that could lead to compromise, it's time to
    discover what vulnerabilities exist for those threats. In the vulnerability analysis
    phase, you start to discover vulnerabilities in systems and how you can act upon
    those by using exploits.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您定义了可能导致威胁的威胁，就是时候发现这些威胁存在哪些漏洞。在漏洞分析阶段，您开始发现系统中的漏洞以及如何利用这些漏洞。
- en: Here, you will perform either active or passive analysis. Keep in mind that
    any failed exploits can lead to detection.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您将进行主动或被动分析。请记住，任何失败的利用都可能导致被发现。
- en: 'Active vulnerability analysis can consist of the following:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 主动漏洞分析可以包括以下内容：
- en: Network scanners
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络扫描仪
- en: Web application scanners
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web应用程序扫描仪
- en: Automated scanners
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 自动化扫描仪
- en: 'Passive vulnerability analysis can consist of the following:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 被动漏洞分析可以包括以下内容：
- en: Monitoring traffic
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 监控流量
- en: Metadata
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 元数据
- en: There are many vulnerability scanners that exist today. For example, the more
    commonly used one is Nessus, but there are many others, such as OpenVAS, Nikto,
    and QualysGuard.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 今天存在许多漏洞扫描器。例如，更常用的是Nessus，但还有许多其他的，如OpenVAS、Nikto和QualysGuard。
- en: Exploitation
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用
- en: In the exploitation phase, you start focusing on obtaining access to systems
    and evading any security blockers that exist. By performing a vulnerability analysis
    in the exploitation phase, you can create a precise plan that you can execute.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在利用阶段，您开始专注于获取对系统的访问权限，并规避任何现有的安全阻碍。通过在利用阶段进行漏洞分析，您可以制定一个精确的计划来执行。
- en: In this phase, you will begin to work with many tools. Some exploits can be
    done easily, while others can be complex.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段，您将开始使用许多工具。有些漏洞利用可以很容易地完成，而其他一些可能会很复杂。
- en: Post-exploitation
  id: totrans-89
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 后期利用
- en: Post-exploitation covers activities that can be performed once a target is successfully
    exploited.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 后渗透覆盖了一旦目标成功被利用就可以执行的活动。
- en: The post-exploitation phase really showcases your skills as a penetration tester.
    When malicious hackers breach a system, they start to trawl the environment looking
    for high-value targets. They also start creating backdoors so that they can easily
    revisit the compromised system.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 后渗透阶段真正展示了您作为渗透测试人员的技能。当恶意黑客侵入系统时，他们开始在环境中寻找高价值目标。他们还开始创建后门，以便他们可以轻易地重新访问受损的系统。
- en: As a penetration tester, you would perform tasks as if you were an attacker.
    Once you have breached a system, it's time to look for high-value targets and
    valuable information, attempt to access escalated privileges, move laterally,
    and look at how you can pivot.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 作为渗透测试人员，您将执行任务，就好像您是攻击者一样。一旦您侵入了系统，就是寻找高价值目标和有价值的信息的时候，尝试访问提升的特权，横向移动，并查看您如何进行枢轴。
- en: Reporting
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 报告
- en: In the final phase of penetration testing, findings need to be provided to the
    business in a meaningful way. Here, you would define everything from how you entered
    their environment to what you found. It's important to provide the business with
    recommendations on how to fix the gaps that you have exposed in your penetration
    test.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 在渗透测试的最后阶段，需要以有意义的方式向企业提供发现。在这里，您需要定义从您如何进入他们的环境到您发现了什么的一切。重要的是要向企业提供如何修复您在渗透测试中暴露的漏洞的建议。
- en: Your report should have an executive summary and a technical report. Each section
    needs to be tailored to the audience that you are presenting it to. For example,
    you would not say that you used the **MS17-010 EternalBlue** exploit to compromise
    a system in the executive summary, but you would say this in the technical report.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 您的报告应该有执行摘要和技术报告。每个部分都需要针对您呈现的受众进行定制。例如，在执行摘要中，您不会说您在使用**MS17-010 EternalBlue**漏洞来攻击系统，但您会在技术报告中这样说。
- en: Executive summary
  id: totrans-96
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 执行摘要
- en: 'The executive summary will define the goals of the penetration test and provide
    an overview of the findings at a very high level. As the audience of the executive
    summary is usually the business decision-makers, you need to communicate on their
    level. In order to do that, the executive summary may contain the following sections:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 执行摘要将定义渗透测试的目标，并以非常高的层次概述发现。由于执行摘要的受众通常是业务决策者，您需要以他们的层次进行沟通。为了做到这一点，执行摘要可能包含以下部分：
- en: '**Background**:In the background section, you need to explain the purpose of
    the penetration test.'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**背景**：在背景部分，您需要解释渗透测试的目的。'
- en: '**Overall posture**:Here, you will define how effective the penetration test
    was in relation to the goals defined during the pre-engagement phases.'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**整体姿态**：在这里，您将定义渗透测试在预约期阶段定义的目标方面的有效性。'
- en: '**Risk ranking**: This defines the overall risk rating that the business resides
    in. For example, the business might be at an **extreme**, **high**, **moderate**,
    or **low risk**. You have to explain this rating so that it is clear to the business
    why they fall into that risk rank.'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**风险排名**：这定义了企业所处的整体风险评级。例如，企业可能处于**极端**、**高**、**中等**或**低风险**。您必须解释这个评级，以便企业清楚地了解他们为什么属于这种风险等级。'
- en: '**General findings**: This section provides a brief summary of the issues that
    were identified during the penetration test. Charts are often found here that
    highlight security risk categories; for example, missing patches and operating
    system hardening.'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**一般发现**：这部分提供了在渗透测试期间发现的问题的简要总结。通常在这里可以找到突出安全风险类别的图表，例如缺失的补丁和操作系统加固。'
- en: '**Recommendation summary**: This outlines a high-level overview of what tasks
    should be performed to re-mediate the findings. Do not go into detail here, as
    details are covered in the technical report.'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**建议摘要**：这概述了应该执行哪些任务来纠正发现。在这里不要详细说明，因为详细内容在技术报告中有所涉及。'
- en: '**Strategic roadmap**: This provides the business with an actionable roadmap
    to remediate the findings. This roadmap must be prioritized and be in line with
    the business-level of potential impact. The roadmap can be broken down into parts,
    such as **1 to 3-month**, **3 to 6-month**, and **6 to 12-month** plans. Within
    each section, there should be actions defined; for example, within the **1 to
    3-month** plan, the business should address missing patches that are low-impact.'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**战略路线图**：这为企业提供了一个可操作的路线图来纠正发现。这个路线图必须是有优先级的，并且与潜在影响的业务级别保持一致。路线图可以分解成部分，例如**1到3个月**、**3到6个月**和**6到12个月**的计划。在每个部分中，应该定义行动；例如，在**1到3个月**的计划中，企业应该解决低影响的缺失补丁。'
- en: Technical report
  id: totrans-104
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术报告
- en: The technical report will include a lot more details compared to the executive
    summary. In the technical report, you will define the scope, information, attack
    methods, and remediation steps in full. In this report, you can use technical
    terms that are easily understood, such as remote shell, pass-the-hash, and NTLM
    hashes.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 技术报告将包括比执行摘要更多的细节。在技术报告中，您将全面定义范围、信息、攻击方法和纠正步骤。在这份报告中，您可以使用易于理解的技术术语，例如远程shell、传递哈希和NTLM哈希。
- en: 'The technical report will include the following sections:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 技术报告将包括以下部分：
- en: '**Introduction**: This part will include topics such as the scope of the penetration
    test, contacts, systems involved, and approach.'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**介绍**：这部分将包括渗透测试的范围、联系人、涉及的系统和方法等主题。'
- en: '**Information gathering**: Here, you will explain how much of information you
    were able to gather on the targets. In this section, you can dive deeper to highlight
    what information was obtained by **passive intelligence** (information publicly
    available on the internet, DNS records, IP address information, and so on), **active
    intelligence** (port scanning, footprinting, and so on), **personnel intelligence**
    (what information was obtained from social engineering, phishing, and so on),
    and so forth.'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**信息收集**：在这里，您将解释您能够收集到目标的多少信息。在本节中，您可以深入挖掘，以突出通过**被动情报**（公开可用的信息、DNS记录、IP地址信息等）、**主动情报**（端口扫描、足迹、等）和**人员情报**（从社会工程、钓鱼等获得的信息）等方式获得了哪些信息。'
- en: '**Vulnerability assessment**: In this section, you will define what types of
    vulnerabilities were discovered, how they were discovered, and provide evidence
    of the vulnerability.'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**漏洞评估**：在本节中，您将定义发现的漏洞类型、如何发现它们，并提供漏洞的证据。'
- en: '**Exploitation/vulnerability verification**: This section provides the detailed
    steps on how you acted on the vulnerabilities discovered. Details such as a timeline
    of the attack, targets, success/fail ratio, and level of access obtained should
    be included.'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**利用/漏洞验证**：本节提供了您对发现的漏洞采取行动的详细步骤。应包括攻击的时间表、目标、成功/失败比率和获得的访问级别等详细信息。'
- en: '**Post exploitation**: Details included here would be activities such as escalation
    paths, data extraction, information value, how effective the countermeasures were
    (if any), persistence, and pivot points.'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**后期利用**：此处包括的详细信息将是升级路径、数据提取、信息价值、反制措施的有效性（如果有的话）、持久性和枢纽点等活动。'
- en: '**Risk/exposure**: The results from the preceding sections are combined and
    tied to a risk and exposure rating. This section would contain information such
    as estimated loss per incident, the skill required to perform a certain attack,
    countermeasure strength, and risk ranking (critical, high, medium, low).'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**风险/暴露**：前面各节的结果被结合并与风险和暴露评级联系起来。本节将包含每次事件的预估损失、执行某种攻击所需的技能、反制措施的强度和风险评级（关键、高、中、低）等信息。'
- en: '**Conclusion**: The conclusion should always end on a positive note. Here,
    you will highlight any guidance for increasing the business'' security posture
    with a final overview of the penetration test.'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**结论**：结论应该始终以积极的方式结束。在这里，您将强调通过对渗透测试的最终概述来增加业务安全姿态的任何指导。'
- en: Now that we have built our foundation on what penetration testing is, its phases,
    and how it differs from vulnerability assessments and red team assessments, it's
    time to dive into lab environments.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经建立了关于渗透测试是什么、其阶段以及它与漏洞评估和红队评估的区别的基础，是时候深入实验室环境了。
- en: Getting started with your lab
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 开始使用您的实验室
- en: As you work through this book, you will learn how to use different tools in
    a controlled environment. In order to have a controlled environment, we will need
    to build one.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 当您阅读本书时，您将学习如何在受控环境中使用不同的工具。为了拥有受控环境，我们需要构建一个。
- en: 'There are three options that we have for building a penetration lab. These
    are as follows:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 我们有三种选项来构建渗透实验室。它们如下：
- en: '**Using a cloud provider**: Cloud providers such as Microsoft Azure, Amazon
    Web Services, and Google Cloud give you the flexibility and scalability of deploying
    systems at a fraction of the cost compared to purchasing dedicated hardware. The
    only catch with using a cloud provider is that you would probably require permission
    to perform penetration tests on your deployed services.'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用云服务提供商**：微软Azure、亚马逊Web服务和谷歌云等云服务提供商为您提供了在部署系统方面灵活性和可伸缩性，成本仅为购买专用硬件的一小部分。使用云服务提供商的唯一问题是，您可能需要获得在部署服务上执行渗透测试的许可。'
- en: '**Using a high-powered laptop or desktop with virtualization software**: As
    high-powered laptops and desktops are relatively cheap, this would be the option
    that many prefer. By using virtualization software such as Microsoft Hyper-V,
    VMware, and Virtualbox, you can deploy a fully isolated network on your host computer.'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用高性能笔记本电脑或桌面计算机与虚拟化软件**：由于高性能笔记本电脑和桌面计算机相对便宜，这可能是许多人喜欢的选择。通过使用Microsoft
    Hyper-V、VMware和Virtualbox等虚拟化软件，您可以在主机计算机上部署一个完全隔离的网络。'
- en: 'When using a hypervisor for penetration testing, there is a limitation with
    Hyper-V. Currently, Hyper-V does not allow you to connect a USB wireless card
    directly to the VM, as opposed to VMware, shown in the following screenshot, and
    Virtualbox. This introduces problems when you try to leverage monitor mode for
    wireless penetration testing. VMware and Virtualbox allow you to connect a USB
    wireless card directly to the virtual machine. The following screenshot depicts
    connecting a wireless network card directly to the virtual machine (*Figure 1*):'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用虚拟化软件进行渗透测试时，Hyper-V存在一个限制。目前，Hyper-V不允许您直接将USB无线网卡连接到虚拟机，而VMware和Virtualbox则允许。这在尝试利用无线渗透测试的监视模式时会引入问题。VMware和Virtualbox允许您直接将USB无线网卡连接到虚拟机。下面的截图描述了将无线网卡直接连接到虚拟机（*图1*）：
- en: '![](img/8dd23338-02dd-4c4a-be46-6441be4085c0.png)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/8dd23338-02dd-4c4a-be46-6441be4085c0.png)'
- en: 'Figure 1: Connecting a wireless card to the virtual machine.'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 图1：将无线网卡连接到虚拟机。
- en: '**Using dedicated hardware**: This is the more expensive option. Here, you
    will need to have a full slew of networking equipment, including dedicated servers
    and workstations.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**使用专用硬件**：这是更昂贵的选择。在这里，您将需要一整套网络设备，包括专用服务器和工作站。'
- en: Let's start by looking at building a lab environment using virtualization tools
    such as VMware, Hyper-V, and VirtualBox.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先看看如何使用虚拟化工具（如VMware、Hyper-V和VirtualBox）构建实验室环境。
- en: Creating virtual machines in VMware, Hyper-V, and VirtualBox
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在VMware、Hyper-V和VirtualBox中创建虚拟机
- en: Leveraging a hypervisor enables you to build your lab environment with minimal
    hardware costs. Any decent laptop or desktop these days is able to run hypervisor
    software. When you use your hypervisor of choice, make sure that you configure
    the virtual networks appropriately. For example, if you require your VMs to be
    isolated, then you would use **host only**. If you require your virtual machine
    to have internet access, you could use **network address translation** or **bridged
    networking**.The difference between network address translation and bridged networking
    is that, with bridged networking, your virtual machine will obtain its own IP
    address, whereas with network address translation, your virtual machine will leverage
    your hosts, IP address to communicate externally.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 利用虚拟化管理程序可以以最小的硬件成本构建实验室环境。如今，任何一台体面的笔记本电脑或台式机都能运行虚拟化管理软件。在选择虚拟化管理程序时，确保适当地配置虚拟网络。例如，如果需要使虚拟机相互隔离，可以使用“仅主机模式”。如果需要让虚拟机访问互联网，可以使用“网络地址转换”或“桥接网络”。网络地址转换和桥接网络的区别在于，使用桥接网络时，虚拟机将获得自己的
    IP 地址，而使用网络地址转换时，虚拟机将利用主机的 IP 地址进行外部通信。
- en: Note that the options might differ between the different pieces of hypervisor
    software, but the concepts are the same.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，不同虚拟化管理程序之间的选项可能不同，但概念是相同的。
- en: Microsoft Hyper-V
  id: totrans-128
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Microsoft Hyper-V
- en: Hyper-V is a virtualization product by Microsoft that you can use to create
    VMs. Microsoft Hyper-V is available on Windows 10\. It can be enabled on Enterprise,
    Education, and Pro versions of Windows 10.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: Hyper-V 是微软的一款虚拟化产品，可以用来创建虚拟机。Microsoft Hyper-V 可以在 Windows 10 上使用。它可以在 Windows
    10 企业版、教育版和专业版上启用。
- en: Hyper-V can be installed a number of ways.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: Hyper-V 可以通过多种方式进行安装。
- en: 'Using Powershell, you can install the Hyper-V role using the following code:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Powershell，可以使用以下代码安装 Hyper-V 角色：
- en: '[PRE0]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Also, by using the following DISM and CMD (running as administrator) code:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，还可以使用以下 DISM 和 CMD（以管理员身份运行）代码：
- en: '[PRE1]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Hyper-V can also be installed using programs and features within Windows. To
    do so, the following steps should be performed in Windows 10:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: Hyper-V 也可以通过 Windows 的程序和功能进行安装。在 Windows 10 中，可以按照以下步骤进行操作：
- en: 'Press the Windows key + *R* to open the Run dialog box. Type in `appwiz.cpl`
    to open Programs and Features as shown in *Figure 2*:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下 Windows 键 + *R* 打开运行对话框。输入 `appwiz.cpl` 打开程序和功能，如 *图2* 所示：
- en: '![](img/5480104b-cdd8-42d1-99dd-a7b437ea58d9.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](img/5480104b-cdd8-42d1-99dd-a7b437ea58d9.png)'
- en: 'Figure 2: Opening the Programs and Features.'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 图2：打开程序和功能。
- en: 'Click on Turn Windows features on or off as shown in *Figure 3*:'
  id: totrans-139
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击如 *图3* 所示的“打开或关闭 Windows 功能”：
- en: '![](img/738fc89e-c71c-4071-85d8-8b557df58c2e.png)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
  zh: '![](img/738fc89e-c71c-4071-85d8-8b557df58c2e.png)'
- en: 'Figure 3: Turn windows features on or off.'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 图3：打开或关闭 Windows 功能。
- en: 'Select the Hyper-V roles as shown in *Figure 4*:'
  id: totrans-142
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 选择如 *图4* 所示的 Hyper-V 角色：
- en: '![](img/6e0b41fa-770a-4c8a-bb8d-0a54ab904b3e.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/6e0b41fa-770a-4c8a-bb8d-0a54ab904b3e.png)'
- en: 'Figure 4: Selecting Hyper-V roles.'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 图4：选择 Hyper-V 角色。
- en: Click on OK.
  id: totrans-145
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 点击确定。
- en: Your computer will require a reboot to install the Hyper-V roles.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 计算机需要重新启动以安装 Hyper-V 角色。
- en: Hyper-V currently does not have the ability to connect a USB device directly
    to the virtual machine. This introduces problems with wireless cards that will
    be used for wireless penetration testing, as you are unable to switch to monitor
    mode.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: Hyper-V 目前无法直接连接 USB 设备到虚拟机。这会给用于无线渗透测试的无线网卡带来问题，因为无法切换到监视模式。
- en: More information about Microsoft Hyper-V can be found at [https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/about/](https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/about/).
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 有关 Microsoft Hyper-V 的更多信息，请访问 [https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/about/](https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/about/)。
- en: VMware
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VMware
- en: VMware is a virtualization software that offers both free and paid versions.
    VMware offers support for Microsoft Windows, Linux, and Mac OS.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: VMware 是一款提供免费和付费版本的虚拟化软件。VMware 支持 Microsoft Windows、Linux 和 Mac OS。
- en: VMware Workstation Player ([https://www.vmware.com/products/workstation-player.html](https://www.vmware.com/products/workstation-player.html))
    is available for free for Microsoft Windows and Linux operating systems. There
    is a paid version called VMware Workstation Pro ([https://www.vmware.com/products/workstation-pro.html](https://www.vmware.com/products/workstation-pro.html)),
    which offers some additional features over the free version. VMware Fusion ([https://www.vmware.com/products/fusion.html](https://www.vmware.com/products/fusion.html)),
    which is also a paid version, is available for macOS.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: VMware Workstation Player ([https://www.vmware.com/products/workstation-player.html](https://www.vmware.com/products/workstation-player.html))
    可以免费在 Microsoft Windows 和 Linux 操作系统上使用。还有一个付费版本叫做 VMware Workstation Pro ([https://www.vmware.com/products/workstation-pro.html](https://www.vmware.com/products/workstation-pro.html))，相比免费版本提供了一些额外的功能。VMware
    Fusion ([https://www.vmware.com/products/fusion.html](https://www.vmware.com/products/fusion.html))
    也是一个付费版本，适用于 macOS。
- en: VirtualBox
  id: totrans-152
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VirtualBox
- en: Virtualbox is an open source hypervisor that is free to use. It offers support
    for Microsoft Windows, Linux, and macOS. Virtualbox has a number of extensions
    that are available for use, which includes support for USB3, PXE boot, disk encryption,
    and more.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: Virtualbox 是一款开源的免费虚拟化管理程序。它支持 Microsoft Windows、Linux 和 macOS。Virtualbox 还有一些可用的扩展，包括对
    USB3、PXE 引导、磁盘加密等的支持。
- en: Virtualbox can be downloaded at [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads).
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: Virtualbox 可以在 [https://www.virtualbox.org/wiki/Downloads](https://www.virtualbox.org/wiki/Downloads)
    下载。
- en: Target machines
  id: totrans-155
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 目标机器
- en: As we progress through the book, we will perform some penetration tests against
    target machines.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们阅读本书的过程中，我们将对目标机器执行一些渗透测试。
- en: When we talk about target machines, these are VMs that will be used to test
    various tools and concepts in this book.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们谈论目标机器时，这些是将用于测试本书中各种工具和概念的虚拟机。
- en: For Microsoft Windows, we will leverage the evaluation center to download Windows
    10 Enterprise and Server 2012 R2.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 对于 Microsoft Windows，我们将利用评估中心下载 Windows 10 企业版和 Server 2012 R2。
- en: The Microsoft evaluation center can be accessed at [https://www.microsoft.com/en-us/evalcenter/](https://www.microsoft.com/en-us/evalcenter/).
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 可以在[https://www.microsoft.com/en-us/evalcenter/](https://www.microsoft.com/en-us/evalcenter/)访问Microsoft评估中心。
- en: The direct link for Windows Server 2012R2 is [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2),
    and for Windows 10 Enterprise, the direct link is [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise).
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: Windows Server 2012R2的直接链接是[https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2012-r2)，而Windows
    10企业版的直接链接是[https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise)。
- en: For both operating systems, you will leverage the `.iso` file and install them
    using your hypervisor of choice.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 对于两个操作系统，您将使用`.iso`文件，并使用您选择的hypervisor进行安装。
- en: Metasploitable
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Metasploitable
- en: Metasploitable is an intentionally vulnerable machine that you can use to test
    Metasploit exploits to obtain shell permissions. Metasploitable differs from other
    vulnerable machines, since it focuses more on the operating system and network
    layer.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable是一个有意设置的易受攻击的机器，您可以使用它来测试Metasploit漏洞以获取shell权限。Metasploitable与其他易受攻击的机器不同，因为它更专注于操作系统和网络层。
- en: Metasploitable currently has three versions to date; these are aptly named Metasploitable,
    Metasploitable 2, and Metasploitable 3.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，Metasploitable目前有三个版本，它们分别被称为Metasploitable、Metasploitable 2和Metasploitable
    3。
- en: There are significant changes in each release over and above how you would set
    them up.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 每个版本都有重大变化，超出了您如何设置它们的范围。
- en: Metasploitable (version 1) is a VM-based customized Ubuntu image. Within this
    image, there is a number of vulnerable and poorly configured software installed.
    For example, you might have Tomcat with weak credentials, easily exploitable using
    Metasploit.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable（版本1）是基于VM的定制Ubuntu镜像。在这个镜像中，安装了许多易受攻击和配置不良的软件。例如，您可能会有使用Metasploit轻松可利用的弱凭据的Tomcat。
- en: Metasploitable (version 1) is available on Vulnhub for download at [https://www.vulnhub.com/entry/metasploitable-1,28/](https://www.vulnhub.com/entry/metasploitable-1,28/).
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable（版本1）可在Vulnhub上下载，链接为[https://www.vulnhub.com/entry/metasploitable-1,28/](https://www.vulnhub.com/entry/metasploitable-1,28/)。
- en: Metasploitable 2, which was more robust, had a lot more vulnerabilities introduced.
    It included more than 30 exposed ports that would show up in a Nmap scan. It also
    included vulnerable web applications, such as **Damn Vulnerable Web App** (**DMVA**)
    and **Mutillidae**. This allowed people to test their web application penetration
    testing skills.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable 2更加强大，引入了更多的漏洞。它包括超过30个暴露的端口，会在Nmap扫描中显示出来。它还包括易受攻击的Web应用程序，如**Damn
    Vulnerable Web App**（**DMVA**）和**Mutillidae**。这使人们能够测试他们的Web应用程序渗透测试技能。
- en: Metasploitable (version 2) is available for download at [https://information.rapid7.com/download-metasploitable-2017.html](https://sourceforge.net/projects/metasploitable/).
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable（版本2）可在[https://information.rapid7.com/download-metasploitable-2017.html](https://sourceforge.net/projects/metasploitable/)下载。
- en: Metasploitable 3 upped the game. Versions 1 and 2 were Linux-based, but version
    3 is Windows-based. Metasploitable 3 makes use of automation and provisioning.
    The build process is simple and robust, all of its scripts are open source, and
    it leverages tools such as **vagrant** and **packer**. At the time this book was
    written, Metasploitable 3 supports both VMware and Virtualbox.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable 3提升了游戏水平。版本1和2是基于Linux的，但版本3是基于Windows的。Metasploitable 3利用了自动化和配置。构建过程简单而强大，所有脚本都是开源的，并且利用了**vagrant**和**packer**等工具。在撰写本书时，Metasploitable
    3支持VMware和Virtualbox。
- en: Metasploitable 3 is available for download from [https://github.com/rapid7/metasploitable3](https://github.com/rapid7/metasploitable3).
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable 3可从[https://github.com/rapid7/metasploitable3](https://github.com/rapid7/metasploitable3)下载。
- en: 'There is additional software that needs to be installed prior to getting Metasploitable
    up and running. The following are required:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 在启动Metasploitable之前，需要安装其他软件。以下是必需的：
- en: Packer (available for download at [https://www.packer.io/intro/getting-started/install.html](https://www.packer.io/intro/getting-started/install.html))
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Packer（可在[https://www.packer.io/intro/getting-started/install.html](https://www.packer.io/intro/getting-started/install.html)下载）
- en: Vagrant (available for download at [https://www.vagrantup.com/docs/installation/](https://www.vagrantup.com/docs/installation/))
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vagrant（可在[https://www.vagrantup.com/docs/installation/](https://www.vagrantup.com/docs/installation)下载）
- en: The Vagrant reload plugin (available for download at [https://github.com/aidanns/vagrant-reload#installation](https://github.com/aidanns/vagrant-reload#installation))
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Vagrant reload插件（可在[https://github.com/aidanns/vagrant-reload#installation](https://github.com/aidanns/vagrant-reload#installation)下载）
- en: Virtualbox or VMware
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Virtualbox或VMware
- en: Metasploitable 3 (available for download at [https://github.com/rapid7/metasploitable3](https://github.com/rapid7/metasploitable3))
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Metasploitable 3（可在[https://github.com/rapid7/metasploitable3](https://github.com/rapid7/metasploitable3)下载）
- en: The build steps for Metasploitable 3 are relatively simple and can be found
    on the GitHub repository maintained by Rapid7 ([https://github.com/rapid7/metasploitable3](https://github.com/rapid7/metasploitable3)).
    There are resources available on the internet that host pre-built Metasploitable
    3 VMs.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: Metasploitable 3的构建步骤相对简单，并且可以在Rapid7维护的GitHub存储库上找到（[https://github.com/rapid7/metasploitable3](https://github.com/rapid7/metasploitable3)）。互联网上有一些资源可供下载预构建的Metasploitable
    3 VMs。
- en: In [Chapter 5](8c5306b6-5c1e-4554-a839-5b2422286120.xhtml), *Diving into the
    Metasploit Framework*, we will perform various tasks using the Metasploitable
    labs discussed here.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在[第5章](8c5306b6-5c1e-4554-a839-5b2422286120.xhtml)中，*深入了解Metasploit框架*，我们将执行在这里讨论的Metasploitable实验室中的各种任务。
- en: Summary
  id: totrans-180
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we began to build a solid foundation as you learned about penetration
    testing and how it differs from vulnerability and red team assessments. We defined
    the importance of leveraging a methodology or standard for penetration testing,
    such as the PTES standard and the various phases within it. Within each phase,
    we discussed what is involved and highlighted some important facets that should
    not be overlooked, such as the "get out of jail free card". Lastly, we looked
    at a lab environment, the various hypervisors that currently exist, and how to
    build a Metasploitable lab environment for future use.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们开始建立坚实的基础，您了解了渗透测试与漏洞和红队评估的区别。我们定义了利用渗透测试方法或标准的重要性，例如PTES标准及其中的各个阶段。在每个阶段中，我们讨论了涉及的内容，并强调了一些不容忽视的重要方面，比如“免于入狱的卡”。最后，我们看了一个实验室环境，目前存在的各种虚拟化程序，以及如何构建一个用于将来使用的Metasploitable实验室环境。
- en: In the next chapter ([Chapter 2](6c1d74a7-e51b-4141-9f6c-6e34bf0a926c.xhtml),
    *Getting Started with Kali Linux*), we will dive into Kali Linux to explore the
    different install options for Kali Linux and some initial configuration that is
    required. We will explore some of the essential tools within Kali Linux and what
    their main uses are.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章（第2章《开始使用Kali Linux》）中，我们将深入探讨Kali Linux，探索Kali Linux的不同安装选项以及一些必需的初始配置。我们将探讨Kali
    Linux中一些基本工具及其主要用途。
- en: Questions
  id: totrans-183
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: What is the purpose of penetration testing?
  id: totrans-184
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 渗透测试的目的是什么？
- en: Name at least two penetration testing standards.
  id: totrans-185
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 至少列举两种渗透测试标准。
- en: Why is it important to scope a penetration test?
  id: totrans-186
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 为什么对渗透测试进行范围界定很重要？
- en: Name at least two threat modeling methodologies.
  id: totrans-187
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 至少列举两种威胁建模方法。
- en: Why is Metasploitable different from other vulnerable machines?
  id: totrans-188
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Metasploitable与其他易受攻击的机器有何不同？
