- en: Detecting Advanced Persistent Threats
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 检测高级持续威胁
- en: Modern organizations face cyber threats on a daily basis. Black hat hackers
    do not show any indication that they are going to stop. New hacking techniques
    appear regularly. Detecting **advanced persistent threats** (**APTs**) is a hard
    mission, since the goals of these attacks are to stay undetected for a long period
    of time, and to steal data, rather than cause damage to systems.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 现代组织每天都面临网络威胁。黑帽黑客并没有显示出他们要停止的迹象。新的黑客技术经常出现。检测高级持续威胁（APT）是一项艰巨的任务，因为这些攻击的目标是长时间保持不被发现，并窃取数据，而不是对系统造成损害。
- en: According to multiple information security reports, the number of APT attacks
    is increasing in a notable way, targeting national defenses, manufacturing, and
    the financial industry. Thus, classic protection techniques are, in many cases,
    useless. Deploying suitable platforms and solutions can help organizations and
    companies defend against cyber attacks, especially APTs.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 根据多份信息安全报告，APT攻击的数量正在显著增加，瞄准国家防御、制造业和金融行业。因此，传统的保护技术在许多情况下是无用的。部署合适的平台和解决方案可以帮助组织和公司抵御网络攻击，特别是APT攻击。
- en: This chapter will give you step-by-step guidance to teach you how to build a
    threat-hunting platform, using a stack of well known open-source projects to protect
    your clients' data. You will learn how to create a machine learning module to
    enhance your platform and automate anomaly detection, so that you can focus on
    other concerns within your team.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将为您提供逐步指导，教您如何构建威胁狩猎平台，使用一系列知名的开源项目来保护您的客户数据。您将学习如何创建一个机器学习模块来增强您的平台，并自动检测异常，以便您可以专注于团队内的其他问题。
- en: 'In this chapter, we will cover:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖：
- en: The advanced threat landscape
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 高级威胁格局
- en: Threat-hunting methodologies
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 威胁狩猎方法论
- en: The hunting maturity model
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 狩猎成熟度模型
- en: The cyber kill chain
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络杀伤链
- en: The diamond model of intrusion detection
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 入侵检测的钻石模型
- en: Threat hunting using machine learning, with the **Elasticsearch**, **Logstash**,
    and **Kibana** (**ELK**) stack
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用机器学习进行威胁狩猎，使用**Elasticsearch**、**Logstash**和**Kibana**（**ELK**）堆栈
- en: Technical requirements
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: 'In this chapter, we will use the same Python libraries that we used in the
    previous chapters. It is recommended that you have the following:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用在前几章中使用过的相同的Python库。建议您具备以下内容：
- en: 4 GB RAM
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 4 GB RAM
- en: 2 GB CPU
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2 GB CPU
- en: Threats and risk analysis
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁和风险分析
- en: 'Threats are potential dangers to the assets of your organization. According
    to the **European Union Agency for Network and Information Security** (**ENISA**)
    Threat Landscape Report, 2017, modern organizations face millions of cyber threats,
    including: malware, web-based attacks, phishing, ransomware, botnets, and so on.
    For security professionals, and especially for risk managers, threats play a huge
    role in analyzing risks. Risks are a combination of threats and vulnerabilities,
    and they can be mathematically represented as *Risk = Threats x Vulnerability*.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁是对您组织资产的潜在危险。根据2017年**欧洲网络和信息安全局**（**ENISA**）威胁形势报告，现代组织面临着数百万的网络威胁，包括：恶意软件、基于网络的攻击、网络钓鱼、勒索软件、僵尸网络等。对于安全专业人员，尤其是风险管理人员，威胁在分析风险中起着巨大的作用。风险是威胁和漏洞的组合，可以用数学表示为*风险=威胁x漏洞*。
- en: Threat-hunting methodology
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 威胁狩猎方法论
- en: Threat hunting is an approach for search out, identifying, and understanding
    APTs. Threat hunting, like any methodological information security mission, is
    not about tools and utilities. It is a combination of processes, people, and technology.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎是一种寻找、识别和理解APT的方法。威胁狩猎，就像任何方法论的信息安全任务一样，不是关于工具和实用程序。它是一种过程、人员和技术的结合。
- en: 'Threat hunting involves the following steps:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 威胁狩猎涉及以下步骤：
- en: Creating hypotheses
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 创建假设
- en: Investigating by using tools and techniques
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用工具和技术进行调查
- en: Uncovering new patterns
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发现新的模式
- en: Informing and enriching analytics
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 信息和丰富的分析
- en: 'The following steps form the** threat-hunting loop**:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 以下步骤构成了**威胁狩猎循环**：
- en: '![](img/00147.jpeg)'
  id: totrans-25
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00147.jpeg)'
- en: 'You can evaluate the maturity of your threat-hunting program by selecting a
    level from the following:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过从以下选择一个级别来评估您的威胁狩猎计划的成熟度：
- en: '**Level 1**: Initial (little or no data collection, relying on automated alerts)'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**等级1**：初始（几乎没有数据收集，依赖自动警报）'
- en: '**Level 2**: Minimal (high level of data collection)'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**等级2**：最低（高水平的数据收集）'
- en: '**Level 3**: Procedural (high level of data collection, following data analysis
    procedures)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**等级3**：程序化（高水平的数据收集，遵循数据分析程序）'
- en: '**Level 4**: Innovative (high level of data collection, following new data
    analysis procedures)'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**等级4**：创新（高水平的数据收集，遵循新的数据分析程序）'
- en: '**Level 5**: Leading (high level of data collection, automating the successful
    data analysis procedures)'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**等级5**：领先（高水平的数据收集，自动化成功的数据分析程序）'
- en: The following two sections include the most important terminologies in threat
    hunting.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 以下两个部分包括威胁狩猎中最重要的术语。
- en: The cyber kill chain
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 网络杀伤链
- en: Like many aspects of information security, the cyber kill chain is a military-inspired
    model to describe the steps used in a cyber attack.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 像信息安全的许多方面一样，网络杀伤链是一个受军事启发的模型，用于描述网络攻击中使用的步骤。
- en: 'The seven steps of the cyber kill chain are as follows:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 网络杀伤链的七个步骤如下：
- en: '**Reconnaissance**: Harvesting information, such as email addresses'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**侦察**：收集信息，如电子邮件地址'
- en: '**Weaponization**: Coupling exploits with backdoors into a deliverable payload—in
    other words, building a deliverable payload using an exploit and a backdoor'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**武器化**：将漏洞与后门结合到可交付的有效载荷中，换句话说，使用漏洞和后门构建可交付的有效载荷'
- en: '**Delivery**: Delivering a weaponized bundle to the victim via different means,
    such as an email or USB'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**交付**：通过不同方式向受害者交付武器化的捆绑包，例如电子邮件或USB'
- en: '**Exploitation**: Exploiting a vulnerability to execute code on the targeted
    machine'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**利用**：利用漏洞在目标机器上执行代码'
- en: '**Installation**: Installing a malware'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安装**：安装恶意软件'
- en: '**Command and control (C2)**: Command channel for remote manipulation of the
    victim'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**命令和控制（C2）**：远程操纵受害者的命令通道'
- en: '**Actions and objectives**: Accomplishing the original goal'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**行动和目标**：完成原始目标'
- en: The diamond model of intrusion analysis
  id: totrans-43
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 入侵分析的钻石模型
- en: The diamond model of intrusion analysis is a methodology that was developed
    to verify cyber threats. Every incident can be represented as a diamond. This
    cognitive model is used by many information security analysts to characterize
    organized threats consistently and track them as they evolve.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 入侵分析的钻石模型是一种用于验证网络威胁的方法论。每个事件都可以表示为一个钻石。许多信息安全分析师使用这种认知模型来一致地表征有组织的威胁，并在其演变过程中跟踪它们。
- en: 'The four nodes of the diamond are as follows:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 钻石的四个节点如下：
- en: Adversary (bad guy persona)
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对手（坏人角色）
- en: Infrastructure (such as IP addresses, domain names, and email addresses)
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基础设施（如IP地址、域名和电子邮件地址）
- en: Capabilities (such as malware, exploits, and stolen certs)
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 能力（如恶意软件、漏洞利用和被盗证书）
- en: Victims (such as people and network assets)
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 受害者（如人员和网络资产）
- en: Threat hunting with the ELK Stack
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用ELK Stack进行威胁狩猎
- en: You have now seen a clear overview of the most important terminologies in threat
    hunting. So, let's build our threat-hunting platform. In the following sections,
    we will learn how to build a threat-hunting system by using open-source projects.
    In our hands-on guide, we will use one of the most promising solutions available—the
    ELK Stack. It includes three open-source projects, and is one of the most downloaded
    log management platforms nowadays.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在已经清楚地了解了威胁狩猎中最重要的术语。因此，让我们构建我们的威胁狩猎平台。在接下来的几节中，我们将学习如何使用开源项目构建威胁狩猎系统。在我们的实践指南中，我们将使用其中一个最有前途的解决方案——ELK
    Stack。它包括三个开源项目，是当今最受欢迎的日志管理平台之一。
- en: 'The ELK Stack is widely used in many fields, including:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: ELK Stack广泛应用于许多领域，包括：
- en: Business intelligence
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 商业智能
- en: Web analytics
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络分析
- en: Information security
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 信息安全
- en: Compliance
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 合规性
- en: 'The ELK Stack is composed of the following components:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: ELK Stack由以下组件组成：
- en: '**Elasticsearch**: To search and analyze data'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Elasticsearch**：搜索和分析数据'
- en: '**Logstash**: To collect and transform data'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Logstash**：收集和转换数据'
- en: '**Kibana**: To visualize data'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Kibana**：可视化数据'
- en: 'The following diagram illustrates the major components in the ELK Stack:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表说明了ELK Stack中的主要组件：
- en: '![](img/00148.jpeg)'
  id: totrans-62
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00148.jpeg)'
- en: 'So, according to the main architecture, in order to build a threat-hunting
    platform, we need to: collect logs, analyze and search for suitable data, and
    manage a visualization of our findings. Let''s look at how we can prepare the
    ELK Stack environment.'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，根据主要架构，为了构建威胁狩猎平台，我们需要：收集日志，分析和搜索合适的数据，并管理我们发现的可视化。让我们看看如何准备ELK Stack环境。
- en: Elasticsearch
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Elasticsearch
- en: 'Elasticsearch is an amazing open-source project. It is a RESTful, distributed,
    and JSON-based search engine. In other words, you can look at it as a NoSQL search
    server. You can see its official website at [https://www.elastic.co/](https://www.elastic.co/):'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: Elasticsearch是一个令人惊叹的开源项目。它是一个基于RESTful、分布式和基于JSON的搜索引擎。换句话说，您可以将其视为NoSQL搜索服务器。您可以在其官方网站上查看：[https://www.elastic.co/](https://www.elastic.co/)
- en: '![](img/00149.jpeg)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00149.jpeg)'
- en: 'To download it, go to [https://www.elastic.co/downloads/elasticsearch](https://www.elastic.co/downloads/elasticsearch):'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 要下载它，转到[https://www.elastic.co/downloads/elasticsearch](https://www.elastic.co/downloads/elasticsearch)
- en: '![](img/00150.jpeg)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00150.jpeg)'
- en: 'Select a suitable package. In my case, I am going to install it on an Ubuntu
    14.04 machine. Thus, I am going to select the `.deb` version. It is recommended
    that you have the following:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 选择合适的软件包。在我的情况下，我将在Ubuntu 14.04机器上安装它。因此，我将选择`.deb`版本。建议您具有以下内容：
- en: 4GB RAM
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 4GB RAM
- en: 2GB CPU
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 2GB CPU
- en: 'Elasticsearch is written in Java. So, we need to make sure that it is installed
    in our environment (we should download it if it is not). Add Java to the `apt` as
    follows:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Elasticsearch是用Java编写的。因此，我们需要确保它已安装在我们的环境中（如果没有，则应下载）。将Java添加到`apt`如下：
- en: '[PRE0]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Now Java source is added into the `list.sources` file:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 现在Java源已添加到`list.sources`文件中：
- en: '![](img/00151.gif)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00151.gif)'
- en: 'Update the `list.sources` file:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 更新`list.sources`文件：
- en: '![](img/00152.gif)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00152.gif)'
- en: 'Now, install the Java `installer`:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，安装Java `installer`：
- en: '[PRE1]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](img/00153.gif)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00153.gif)'
- en: 'Then, configure it:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，进行配置：
- en: '![](img/00154.jpeg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00154.jpeg)'
- en: 'Voilà! We have installed it successfully. Check it by typing the `java -version` command:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了！我们已经成功安装了。通过输入`java -version`命令来检查：
- en: '![](img/00155.gif)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00155.gif)'
- en: 'Let''s install Elasticsearch. Import the `elasticsearch` public key as follows:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们安装Elasticsearch。导入`elasticsearch`公钥如下：
- en: '[PRE2]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](img/00156.gif)'
  id: totrans-87
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00156.gif)'
- en: 'Add Elasticsearch to the source list:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 将Elasticsearch添加到源列表中：
- en: '[PRE3]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](img/00157.gif)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00157.gif)'
- en: 'Update the source list by using `apt-get update` and `install elasticsearch`:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 通过使用`apt-get update`和`install elasticsearch`来更新源列表：
- en: '[PRE4]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](img/00158.gif)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00158.gif)'
- en: 'To configure Elasticsearch, edit `/etc/elasticsearch/elasticsearch.yml` by
    using a text editor:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 要配置Elasticsearch，使用文本编辑器编辑`/etc/elasticsearch/elasticsearch.yml`：
- en: '[PRE5]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](img/00159.jpeg)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00159.jpeg)'
- en: 'After configuring the file, restart the Elasticsearch service:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 配置文件后，重新启动Elasticsearch服务：
- en: '[PRE6]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Kibana
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Kibana
- en: After installing and configuring Elasticsearch, it is time to install Kibana,
    to visualize data in a well-designed dashboard. Kibana is a web interface with
    different types of charts. You can see it as the visualization layer of our stack.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 安装和配置Elasticsearch后，是时候安装Kibana了，以在设计良好的仪表板中可视化数据。Kibana是一个带有不同类型图表的Web界面。您可以将其视为我们堆栈的可视化层。
- en: 'Install Kibana by using the `apt-get install` command, as usual:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 像往常一样使用`apt-get install`命令安装Kibana：
- en: '[PRE7]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'It won''t take so long to install it:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 安装不会花费太长时间：
- en: '![](img/00160.gif)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00160.gif)'
- en: 'After installing it, we can configure it by using a text editor to modify the
    `/opt/kibana/config/kibana.yml` configuration file:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 安装完成后，我们可以使用文本编辑器配置它，修改`/opt/kibana/config/kibana.yml`配置文件：
- en: '[PRE8]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Enable the Kibana service by using the following command:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令启用Kibana服务：
- en: '[PRE9]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](img/00161.gif)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00161.gif)'
- en: 'Start the service by using the following command:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 使用以下命令启动服务：
- en: '[PRE10]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](img/00162.gif)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00162.gif)'
- en: If you want to access the dashboard from outside using a public IP address,
    you can use a reverse proxy. For example, **Nginx** would be great in this case.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想要使用公共IP地址从外部访问仪表板，您可以使用反向代理。例如，在这种情况下，**Nginx**将是一个很好的选择。
- en: 'You can find the Kibana folders at `/usr/share/kibana`:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在`/usr/share/kibana`找到Kibana文件夹：
- en: '![](img/00163.jpeg)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00163.jpeg)'
- en: 'To check the dashboard, type `<Address>: 5601` and enter your credentials:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '要检查仪表板，请输入`<Address>: 5601`并输入您的凭据：'
- en: '![](img/00164.jpeg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00164.jpeg)'
- en: Logstash
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Logstash
- en: 'At this point, we have installed Elasticsearch and Kibana; now we need to install
    Logstash to collect and transform data. The Logstash pipeline contains three components:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 此时，我们已经安装了Elasticsearch和Kibana；现在我们需要安装Logstash来收集和转换数据。Logstash管道包含三个组件：
- en: Input
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输入
- en: Filters
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 过滤器
- en: Output
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 输出
- en: '![](img/00165.jpeg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00165.jpeg)'
- en: 'Let''s add Logstash to the sources list, and then update it:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将Logstash添加到源列表中，然后更新它：
- en: '[PRE11]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](img/00166.gif)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00166.gif)'
- en: 'Install Logstash as follows:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下方式安装Logstash：
- en: '[PRE12]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![](img/00167.gif)'
  id: totrans-129
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00167.gif)'
- en: 'Once you have installed Logstash, you can edit its configuration file, `<Parent_Directory>/logstash/conf/logstash.conf`.
    As you will notice, the configuration file contains two sections - `input` and
    `output`:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 安装Logstash后，您可以编辑其配置文件`<Parent_Directory>/logstash/conf/logstash.conf`。正如您将注意到的那样，配置文件包含两个部分
    - `input` 和 `output`：
- en: '![](img/00168.gif)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00168.gif)'
- en: 'Wait! I bet you are wondering why we only have two sections, even though Logstash
    contains three sections, as we discussed before. You are totally right. We need
    to add a customized section, called `filters`. Logstash provides good capabilities,
    including the ability to create personalized filters. For example, to create a
    filter, you can use the following format (we will use it later, in our guide):'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 等等！我打赌您一定想知道为什么我们只有两个部分，尽管Logstash包含三个部分，就像我们之前讨论的那样。您完全正确。我们需要添加一个自定义部分，称为`filters`。Logstash提供了很好的功能，包括创建个性化过滤器的能力。例如，要创建一个过滤器，您可以使用以下格式（我们将在我们的指南中稍后使用它）：
- en: '[PRE13]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: The `gork` filter is used to parse unstructured log data into something structured
    and queryable. According to the official section on filter plugins ([https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html](https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html)),
    Logstash delivers more than 120 patterns, by default.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: '`gork`过滤器用于将非结构化的日志数据解析为结构化且可查询的数据。根据官方的过滤器插件部分（[https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html](https://www.elastic.co/guide/en/logstash/current/plugins-filters-grok.html)），Logstash默认提供了120多种模式。'
- en: Machine learning with the ELK Stack using the X-Pack plugin
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用X-Pack插件进行ELK Stack的机器学习
- en: We have now installed the three main components of an ELK Stack. If you want
    an efficient way to deploy an ELK Stack, especially for testing purposes, I recommend
    that you use a cloud-based stack. For example, in the following demonstrations,
    I am going to use a predefined cloud ELK Stack by Bitnami.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 我们现在已经安装了ELK Stack的三个主要组件。如果您想要一种有效的部署ELK Stack的方式，特别是用于测试目的，我建议您使用基于云的堆栈。例如，在以下演示中，我将使用Bitnami预定义的云ELK
    Stack。
- en: 'The Bitnami ELK Stack ships with the following software versions:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: Bitnami ELK Stack随附以下软件版本：
- en: Apache 2.4.29
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Apache 2.4.29
- en: Elasticsearch 6.2.2
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Elasticsearch 6.2.2
- en: Logstash 6.2.2
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Logstash 6.2.2
- en: Kibana 6.2.2
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Kibana 6.2.2
- en: 'In a few moments, your stack will be ready to use. The following screenshot
    shows the ELK Stack files:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 在几分钟内，您的堆栈将准备就绪。以下屏幕截图显示了ELK Stack文件：
- en: '![](img/00169.jpeg)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00169.jpeg)'
- en: 'To get the password for your Bitnami environment, go to the Boot diagnostics
    section in your Azure portal, and check the log file; you will find the password
    at the bottom of the file:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取Bitnami环境的密码，请转到Azure门户中的Boot诊断部分，并检查日志文件；您将在文件底部找到密码：
- en: '![](img/00170.gif)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00170.gif)'
- en: 'Before adding the machine learning plugin, let''s configure our ELK Stack. Load
    the ELK environment and log in to the ELK server using the following command:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 在添加机器学习插件之前，让我们配置我们的ELK Stack。使用以下命令加载ELK环境并登录到ELK服务器：
- en: '[PRE14]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '![](img/00171.jpeg)'
  id: totrans-148
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00171.jpeg)'
- en: Let's stop Logstash by typing `sudo /opt/bitnami/ctlscript.sh stop logstash`
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们通过输入`sudo /opt/bitnami/ctlscript.sh stop logstash`来停止Logstash
- en: '![](img/00172.jpeg)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00172.jpeg)'
- en: 'Create a configuration file, `/opt/bitnami/logstash/conf/access-log.conf`:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 创建一个配置文件`/opt/bitnami/logstash/conf/access-log.conf`：
- en: '[PRE15]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](img/00173.gif)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00173.gif)'
- en: 'Check the configuration of `/opt/bitnami/logstash/bin/logstash -f /opt/bitnami/logstash/conf/
    --config.test_and_exit`:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 检查`/opt/bitnami/logstash/bin/logstash -f /opt/bitnami/logstash/conf/ --config.test_and_exit`的配置：
- en: '![](img/00174.gif)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00174.gif)'
- en: 'Start Logstash as follows:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 按照以下方式启动Logstash：
- en: '[PRE16]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '![](img/00175.gif)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00175.gif)'
- en: 'Check if Elasticsearch is working well:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 检查Elasticsearch是否正常工作：
- en: '![](img/00176.gif)'
  id: totrans-160
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00176.gif)'
- en: 'Now, let''s go to Kibana. As you may have noticed, we don''t have an index
    pattern yet:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们去Kibana。正如您可能已经注意到的，我们还没有索引模式：
- en: '![](img/00177.jpeg)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00177.jpeg)'
- en: 'After configuring Logstash, we can create a new index pattern:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 配置Logstash后，我们可以创建一个新的索引模式：
- en: '![](img/00178.jpeg)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00178.jpeg)'
- en: 'Type `*` and click Next step:'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 输入`*`并点击下一步：
- en: '![](img/00179.jpeg)'
  id: totrans-166
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00179.jpeg)'
- en: 'Select @timestamp and click the Create Index pattern button. You can now view
    the new index pattern page in Kibana:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 选择@timestamp并点击`Create Index pattern`按钮。您现在可以在Kibana中查看新的索引模式页面：
- en: '![](img/00180.jpeg)'
  id: totrans-168
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00180.jpeg)'
- en: 'When you hit the Discover option, you can check the logs:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 当您点击Discover选项时，您可以检查日志：
- en: '![](img/00181.jpeg)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00181.jpeg)'
- en: 'Now, let''s customize a visualization to add to the main dashboard later. Click
    Visualize on the side list, and create a new visualization:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们自定义一个可添加到主仪表板的可视化。在侧边栏上点击可视化，然后创建一个新的可视化：
- en: '![](img/00182.jpeg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00182.jpeg)'
- en: 'For our demonstration, we are going to use the Vertical Bar. You can choose
    from a range of charts and visualization tools:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我们的演示，我们将使用垂直条形图。您可以从一系列图表和可视化工具中进行选择：
- en: '![](img/00183.jpeg)'
  id: totrans-174
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00183.jpeg)'
- en: 'For the X-Axis, select Date Histogram as the Aggregation and @timestamp as
    the Field:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 对于X轴，选择日期直方图作为聚合和@timestamp作为字段：
- en: '![](img/00184.jpeg)'
  id: totrans-176
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00184.jpeg)'
- en: 'You will then see a visualization of your chart, as the following screenshot
    illustrates:'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，您将看到您图表的可视化，如下面的截图所示：
- en: '![](img/00185.jpeg)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00185.jpeg)'
- en: 'After creating the visualization, let''s add to our dashboard. Click on the
    Dashboard link and create a new dashboard. Then, add your visualizations:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 创建可视化后，让我们添加到我们的仪表板。点击仪表板链接并创建一个新的仪表板。然后，添加您的可视化：
- en: '![](img/00186.jpeg)'
  id: totrans-180
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00186.jpeg)'
- en: 'Save the dashboard. Now, you can check any indicator:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 保存仪表板。现在，您可以检查任何指标：
- en: '![](img/00187.jpeg)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00187.jpeg)'
- en: The ELK Stack threat platform is ready to help you hunt a number of advanced
    threats. Let's take our project up a notch and add an intelligent touch to it
    by using the power of machine learning to automate hunting operations. The ELK
    Stack gives you the power to add a plugin called X-Pack to your hunting platform,
    which will help you to detect anomalies in your artifacts and logs.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: ELK Stack威胁平台已准备好帮助您追踪多种高级威胁。让我们将项目提升一个档次，并通过利用机器学习的力量来自动化追踪操作，为其增加智能化的触角。ELK
    Stack让您有能力向您的追踪平台添加一个名为X-Pack的插件，它将帮助您检测您的文物和日志中的异常。
- en: 'To get the X-Pack plugin, we need to install it on every layer of the stack,
    as this official illustration shows:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 要获得X-Pack插件，我们需要在堆栈的每一层上安装它，正如官方插图所示：
- en: '![](img/00188.jpeg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00188.jpeg)'
- en: 'To install the plugin on Elasticsearch, go to the `binaries` folder and type
    in the following command:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 要在Elasticsearch上安装插件，请转到“binaries”文件夹，并输入以下命令：
- en: '[PRE17]'
  id: totrans-187
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'The same action applies to Kibana:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 相同的操作也适用于Kibana：
- en: '[PRE18]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'It also applies to Logstash:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 这也适用于Logstash：
- en: '[PRE19]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'Restart all of the services and go to the Kibana dashboard; you will notice
    a new option, called Machine Learning:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 重新启动所有服务并转到Kibana仪表板；您将注意到一个新选项，称为机器学习：
- en: '![](img/00189.jpeg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00189.jpeg)'
- en: Finally, you can add a time series anomaly detection capability, thanks to X-Pack.
    In the previous chapter we discussed anomaly detection in a detailed way. We dived
    deep into anomaly detection fundamentals and how to use machine learning to detect
    those anomalies. X-Pack is using the same techniques to spot anomalies.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，由于X-Pack，您可以添加时间序列异常检测功能。在上一章中，我们详细讨论了异常检测。我们深入研究了异常检测的基本原理以及如何使用机器学习来检测这些异常。X-Pack正在使用相同的技术来发现异常。
- en: '![](img/00190.jpeg)'
  id: totrans-195
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00190.jpeg)'
- en: Summary
  id: totrans-196
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In previous chapters, we saw how to build anomaly detection systems from scratch
    by using different machine learning algorithms and Python libraries. This chapter
    included a step-by-step guide to help you build a fully functioning threat-hunting
    platform, using three amazing open source projects. We also implemented a machine
    learning plugin to optimize and enhance the threat-hunting platform's power. By
    now, you have learned how to build many defensive systems using the power of machine
    learning. The next chapter is a must-read if you want to learn how to bypass machine
    learning safeguards.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 在之前的章节中，我们看到如何使用不同的机器学习算法和Python库从头开始构建异常检测系统。本章包括了一份逐步指南，帮助您构建一个完全功能的威胁追踪平台，使用了三个令人惊叹的开源项目。我们还实施了一个机器学习插件，以优化和增强威胁追踪平台的能力。到目前为止，您已经学会了如何使用机器学习的力量构建许多防御系统。如果您想学习如何绕过机器学习保障，下一章是必读的。
- en: Questions
  id: totrans-198
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Which of the following is not a step in the cyber kill chain?
  id: totrans-199
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪一项不是网络攻击杀伤链中的步骤？
- en: (a) Scanning
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: （a）扫描
- en: (b) Control and command
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: （b）控制和命令
- en: (c) Discover and spread
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: （c）发现和传播
- en: Which of the following options is not a node of the diamond model of intrusion
    analysis?
  id: totrans-203
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以下哪个选项不是入侵分析钻石模型的节点？
- en: (a) Victims
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: （a）受害者
- en: (b) Infrastructure
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: （b）基础设施
- en: (c) Procedures
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: （c）程序
- en: How many parts are needed in a Logstash configuration file?
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Logstash配置文件需要多少部分？
- en: (a) 2
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: （a）2
- en: (b) 3
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: （b）3
- en: (c) 4
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: （c）4
- en: In ElasticSearch, what is indexing?
  id: totrans-211
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Elasticsearch中，索引是什么？
- en: (a) The process of storing data in an index
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: （a）在索引中存储数据的过程
- en: (b) The process of identifying data
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: （b）识别数据的过程
- en: (c) None of the above
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: （c）以上都不是
- en: In Elasticsearch, what is a node?
  id: totrans-215
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Elasticsearch中，什么是节点？
- en: (a) An Elasticsearch module
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: （a）Elasticsearch模块
- en: (b) An instance of Elasticsearch
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: （b）Elasticsearch的一个实例
- en: (c) None of the above
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: （c）以上都不是
- en: In Elasticsearch, what is a shard?
  id: totrans-219
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在Elasticsearch中，什么是分片？
- en: (a) Shared files
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: （a）共享文件
- en: (b) Shared data
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: （b）共享数据
- en: (c) Shared resources (RAM, vCPU, and so on)
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: （c）共享资源（RAM、vCPU等）
- en: Does Elasticsearch have a schema? (Yes | No)
  id: totrans-223
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: Elasticsearch有模式吗？（是 | 否）
