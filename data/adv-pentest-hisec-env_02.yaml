- en: Chapter 2. Advanced Reconnaissance Techniques
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第2章。高级侦察技术
- en: 'Actionable information is the key to success when performing a penetration
    test. The amount of public data that is available on the Internet is staggering,
    and sifting through it all to find useful information can be a daunting task.
    Luckily, there are tools available that assist in gathering and sorting through
    this wealth of knowledge. In this chapter, we will be reviewing some of these
    tools and will focus on how to use the information to ensure your penetration
    tests are efficient, focused, and effective. Key topics covered include:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 可操作的信息是进行渗透测试的关键。互联网上可用的公共数据量庞大，筛选出有用的信息可能是一项艰巨的任务。幸运的是，有可用的工具可以帮助收集和整理这些丰富的知识。在本章中，我们将回顾其中一些工具，并重点介绍如何使用这些信息来确保您的渗透测试是高效、专注和有效的。主要涵盖的关键主题包括：
- en: What is reconnaissance and why do we need it
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 侦察是什么，为什么我们需要它
- en: Reconnaissance types
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 侦察类型
- en: Using DNS to quickly identify potential targets
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用DNS快速识别潜在目标
- en: Using search engines data
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用搜索引擎数据
- en: Using metadata to your advantage
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 利用元数据的优势
- en: Note
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Throughout this chapter we will use the domain names `example.com, example.org`,
    and `example.net` which are owned and maintained by IANA. DO NOT USE THESE FOR
    PRACTICE PURPOSES.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将使用由IANA拥有和维护的域名`example.com，example.org`和`example.net`。不要将它们用于实践目的。
- en: These domain names are used as a representation of a domain that you **own and/or
    have permission to use** as a target for your testing. Ideally, you would set
    up a segmented and controlled virtual lab with DNS servers that allows you to
    test all of these commands at your leisure.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 这些域名用作您**拥有和/或获得使用权限**作为测试目标的代表。理想情况下，您应该建立一个分割和受控的虚拟实验室，其中包括允许您随意测试所有这些命令的DNS服务器。
- en: Introduction to reconnaissance
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍侦察
- en: Penetration testing is most effective when you have a good grasp on the environment
    being tested. Sometimes this information will be presented to you by the corporation
    that hired you, other times you will need to go out and perform your reconnaissance
    to learn even the most trivial of items. In either case, make sure to have the
    scope clarified in the rules of engagement prior to conducting any work, including
    reconnaissance.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 当进行渗透测试时，了解被测试环境是最有效的。有时，公司会向您提供这些信息，而其他时候，您需要进行侦察以了解甚至最琐碎的事项。无论哪种情况，请确保在进行任何工作之前，包括侦察在内，都要在规则中明确范围。
- en: Many corporations are not aware of the types of data that can be found and used
    by attackers in the wild. A penetration tester will need to bring this information
    to light. You will be providing the business with real data that they can then
    act upon in accordance to their risk appetite. The information that you will be
    able to find will vary from target to target, but will typically include items
    such as IP ranges, domain names, e-mail addresses, public financial data, organizational
    information, technologies used, job titles, phone numbers, and much more. Sometimes
    you may even be able to find confidential documents or private information that
    is readily available to the public via the Internet. It is possible to fully profile
    a corporation prior to sending a single packet to the organization's network.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 许多公司并不知道攻击者可以在野外找到并使用的数据类型。渗透测试人员需要将这些信息披露出来。您将为企业提供他们可以根据其风险偏好采取行动的真实数据。您能够找到的信息会因目标而异，但通常包括IP范围、域名、电子邮件地址、公开财务数据、组织信息、使用的技术、职位名称、电话号码等等。有时，甚至可以找到机密文件或通过互联网公开获取的私人信息。在向组织的网络发送任何数据包之前，完全可以对一家公司进行全面的概况。
- en: The primary goal of the passive reconnaissance stage is to gather as much actionable
    data as possible while at the same time leaving few indicators that anyone has
    searched for the data.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 被动侦察阶段的主要目标是尽可能收集可操作的数据，同时留下尽可能少的迹象表明有人搜索了这些数据。
- en: Note
  id: totrans-14
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Passive reconnaissance avoids direct contact with the target network.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 被动侦察避免与目标网络直接接触。
- en: The information gained will be used to recreate the types of systems that you
    expect to encounter while testing, provide the information necessary to perform
    effective social engineering attacks or physical breaches, and determine if there
    are vulnerable externally facing devices such as routers or switches that still
    use the default usernames and passwords. Odds are that in a highly secured environment
    things will not be quite that easy, but making assumptions is not recommended
    when performing penetration testing. Things that should be common sense are sometimes
    overlooked when dealing with complex network configurations that support thousands
    of users.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 获得的信息将用于重建您预期在测试中遇到的系统类型，提供执行有效社会工程攻击或物理入侵所需的信息，并确定是否存在使用默认用户名和密码的易受外部攻击的设备，如路由器或交换机。在高度安全的环境中，事情可能不会那么容易，但在进行渗透测试时不建议做出假设。在处理支持成千上万用户的复杂网络配置时，有时会忽视一些常识性的事情。
- en: Note
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Reconnaissance as described in this book would most closely relate to the "Intelligence
    Gathering" category of the PTES.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中描述的侦察最接近于PTES的“情报收集”类别。
- en: The types of reconnaissance we will be focused on include **OSINT (Open Source
    Intelligence)** and footprinting. All of the sources we use will be freely available,
    but it is important to note that there are pay sites on the Internet that could
    be used as well.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将专注于的侦察类型包括**OSINT（开源情报）**和足迹。我们使用的所有来源都是免费的，但重要的是要注意互联网上也有付费网站可供使用。
- en: 'Open Source Intelligence (OSINT): Consists of gathering, processing, and analyzing
    publically available data and turning it into information that is actionable.
    Publically available data sources include, but are not limited to:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 开源情报（OSINT）：包括收集、处理和分析公开可用数据，并将其转化为可操作的信息。公开可用的数据来源包括但不限于：
- en: Public data from courthouses, tax forms, and so on
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 法院、税务表格等的公开数据
- en: Search engines
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 搜索引擎
- en: Conferences
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 会议
- en: Academic sources
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学术来源
- en: Blogs
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 博客
- en: Research reports
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 研究报告
- en: Metadata from pictures, executables, documents, and so on
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图片、可执行文件、文档等的元数据
- en: Publicly available documents
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公开可用文件
- en: 'Footprinting: Used to non-intrusively enumerate the network environment. The
    results are used to locate where possible vulnerabilities are, and to provide
    information about the types of systems, software, and services that are running
    on the target network. The types of information that can be gained while performing
    non-intrusive footprinting include:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 足迹：用于非侵入性地枚举网络环境。结果用于确定可能存在的漏洞位置，并提供有关目标网络上正在运行的系统、软件和服务类型的信息。在执行非侵入式足迹时可以获得的信息类型包括：
- en: Nameservers
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 域名服务器
- en: IP ranges
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IP范围
- en: Banners
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 横幅
- en: Operating Systems
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统
- en: Determining if IDS/IPS is used
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 确定是否使用IDS/IPS
- en: Technologies used
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用的技术
- en: Network device types
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 网络设备类型
- en: This wealth of information is extremely useful when conducting a penetration
    test.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 这些丰富的信息在进行渗透测试时非常有用。
- en: Reconnaissance workflow
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 侦察工作流程
- en: 'Reconnaissance is most effective when performed procedurally. There are three
    major stages that should be followed when performing your recon:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 当进行程序化的侦察时，侦察最有效。在执行侦察时应遵循三个主要阶段：
- en: '![Reconnaissance workflow](img/7744_02_01.jpg)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![侦察工作流程](img/7744_02_01.jpg)'
- en: As an example of how this workflow is to be used, let's pretend we are working
    on a penetration test involving a fictional company. This company has publically
    available information regarding it's externally facing routers.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 作为如何使用这个工作流程的示例，让我们假设我们正在进行一项涉及虚构公司的渗透测试。这家公司有关于其外部路由器的公开信息。
- en: '**Phase 1:** We were able to validate that the IP ranges that we were given
    during the initial planning stage actually belong to our client.'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第一阶段：**我们能够验证在初始规划阶段得到的IP范围实际上属于我们的客户。'
- en: '**Phase 2:** Sifting through the data we find that several routers are configured
    in a default state, and logon credentials have never been changed. We verify the
    information is accurate and move on to the next phase.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第二阶段：**在筛选数据时，我们发现有几台路由器配置为默认状态，并且登录凭据从未被更改。我们验证信息的准确性并继续下一个阶段。'
- en: '**Phase 3:** Based on the validated information gathered, we determine our
    best method of gaining a toe-hold on the network is to compromise the external
    routers and work our way in from there.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第三阶段：**根据收集到的验证信息，我们确定在网络上获得立足点的最佳方法是入侵外部路由器，然后从那里开始工作。'
- en: We have demonstrated a simplified example of how this workflow can be used.
    In the real world there will be many variables that will influence your decisions
    on which systems to target. The information you gather during the reconnaissance
    phase of your testing will be a determining factor in how successful and thorough
    your penetration test will be.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经演示了如何使用这个工作流程的简化示例。在现实世界中，将有许多变量影响您决定攻击哪些系统。在测试的侦察阶段收集的信息将是您的渗透测试成功和彻底程度的决定因素。
- en: DNS recon
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DNS侦察
- en: '**Domain Name System (DNS)** can provide valuable data during the reconnaissance
    phase. If you do not already understand DNS, you may want to take some time to
    get a good grasp on the service and how it works. At a *very* basic level, DNS
    is used to translate domain names into IP addresses. Luckily for us, there are
    many tools available that are excellent at extracting the data that we need from
    nameservers. An example of the information you are able to gather includes:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '**域名系统（DNS）**在侦察阶段可以提供有价值的数据。如果您还不了解DNS，您可能需要花些时间来了解该服务以及它的工作原理。在非常基本的水平上，DNS用于将域名转换为IP地址。幸运的是，有许多可用的工具非常擅长从域名服务器中提取我们需要的数据。您可以收集的信息示例包括：'
- en: '| **Record** | **Description** |'
  id: totrans-48
  prefs: []
  type: TYPE_TB
  zh: '| **记录** | **描述** |'
- en: '| --- | --- |'
  id: totrans-49
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| CNAME | Alias, used to tie many names to a single IP. An IP address can have
    multiple CNAME records associated with it. |'
  id: totrans-50
  prefs: []
  type: TYPE_TB
  zh: '| CNAME | 别名，用于将多个名称与单个IP联系起来。一个IP地址可以有多个与之关联的CNAME记录。 |'
- en: '| A | Used to translate a domain or subdomain name to a thirty-two bit IP address.
    It can also store additional useful information. |'
  id: totrans-51
  prefs: []
  type: TYPE_TB
  zh: '| A | 用于将域名或子域名转换为32位IP地址。它还可以存储其他有用的信息。 |'
- en: '| MX | Ties a domain name to associated mail servers. |'
  id: totrans-52
  prefs: []
  type: TYPE_TB
  zh: '| MX | 将域名与关联的邮件服务器联系起来。 |'
- en: There are other record types that can be collected from DNS tools as well; the
    records listed in the table are the most popular and often, the most useful.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 还有其他类型的记录可以从DNS工具中收集；表中列出的记录是最受欢迎的，通常也是最有用的。
- en: Note
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: DNS reconnaissance is considered active footprinting due to the fact that you
    will need to interact with client owned assets to receive your information.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: DNS侦察被认为是主动足迹，因为您需要与客户拥有的资产进行交互以获取信息。
- en: Nslookup — it's there when you need it
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Nslookup — 当你需要它时它就在那里
- en: '**nslookup** is a DNS querying tool that can be used to resolve IP addresses
    from domain names or vice versa. This tool is used to query any given nameserver
    for specific records. Although `nslookup` is not the most powerful DNS tool in
    our testing toolkit, you can rely on the fact that it will be installed when you
    need it. `nslookup` is cross-platform, and will be found preinstalled on most
    operating systems.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**nslookup**是一个DNS查询工具，可用于从域名解析IP地址，或反之亦然。该工具用于查询任何给定的域名服务器以获取特定记录。虽然`nslookup`不是我们测试工具包中最强大的DNS工具，但您可以依赖它在需要时已安装。`nslookup`是跨平台的，并且大多数操作系统都预装了它。'
- en: Note
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: During the following examples we have modified the command output to maximize
    the learning experience.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在接下来的示例中，我们修改了命令输出以最大化学习体验。
- en: We intend to help you understand the format and the meaning of the output. In
    many cases, we have substituted the original domain name(s) that was used with
    `example.com/net/org` and fictional IP addresses (usually non routable IPs). Do
    not expect to replicate the output directly, instead focus on the concepts described,
    and then practice these steps on domains and servers that you have proper permission
    to perform testing on.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 我们打算帮助您理解输出的格式和含义。在许多情况下，我们已经用`example.com/net/org`替换了原始域名，并使用了虚构的IP地址（通常是不可路由的IP）。不要期望直接复制输出，而是专注于所描述的概念，然后在您有适当权限进行测试的域名和服务器上练习这些步骤。
- en: Default output
  id: totrans-61
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 默认输出
- en: 'To perform a quick lookup for the IP address of the domain name `example.com`
    we enter the following into a BackTrack terminal session:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 要快速查找域名`example.com`的IP地址，我们在BackTrack终端会话中输入以下内容：
- en: '[PRE0]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: You will be presented with output in the following **format:**
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 你将会看到以下**格式**的输出：
- en: '[PRE1]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The server at `8.8.8.8` is a public DNS server made available by Google™. #53
    UDP is the port being used when making the request. The preceding example output
    would indicate that `example.com` resolves to `127.1.72.107`.'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '`8.8.8.8`处的服务器是由Google™提供的公共DNS服务器。在进行请求时使用的是#53 UDP端口。上面的示例输出表明`example.com`解析为`127.1.72.107`。'
- en: Note
  id: totrans-67
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Any IP address starting with 127.x.x.x will be redirected to localhost. Be aware
    of this when reviewing DNS records and selecting potential targets.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 任何以127.x.x.x开头的IP地址都将被重定向到本地主机。在查看DNS记录和选择潜在目标时要注意这一点。
- en: Changing nameservers
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更改域名服务器
- en: Results can be validated by using alternative DNS nameservers. In the following
    example we change the DNS nameserver to `156.154.70.22` which is the IP address
    of a nameserver offered by Comodo Secure DNS® to provide secure browsing to the
    public. It is beneficial to have a listing of several publicly available DNS servers
    when performing your testing. These can be used as a sanity check of sorts when
    dealing with a compromised DNS server. We also query for nameservers associated
    with `example.com:`
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过使用替代DNS域名服务器来验证结果。在下面的示例中，我们将DNS域名服务器更改为`156.154.70.22`，这是Comodo Secure
    DNS®提供的一个域名服务器的IP地址，用于向公众提供安全浏览。在进行测试时，拥有几个公共可用的DNS服务器列表是有益的。当处理受损的DNS服务器时，这些可以用作一种理智检查。我们还查询与`example.com`相关的域名服务器：
- en: '[PRE2]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This example began by initializing `nslookup` and then proceeded to establish
    the variables from within nslookups command console. We started by typing `server`
    which displayed the current value of `8.8.8.8`. After that we determined that
    we wanted to use a different server, consequently we typed `server 156.154.70.22`
    because we were specifically looking at example.com's nameservers. We defined
    the type to be **ns** (nameservers) by entering `set type=ns`.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 这个示例是通过初始化`nslookup`开始的，然后从nslookups命令控制台内建立变量。我们首先输入`server`，显示了当前值为`8.8.8.8`。之后，我们确定要使用不同的服务器，因此我们输入了`server
    156.154.70.22`，因为我们特别关注`example.com`的域名服务器。我们通过输入`set type=ns`来定义类型为**ns**（域名服务器）。
- en: Once the variables have been set, we can query as countless domain names by
    typing the name, such as `example.com` and pressing *Enter*.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦变量设置好了，我们可以通过输入名称，比如`example.com`，然后按下*Enter*键来查询无数个域名。
- en: Note
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: To leave the console type `exit` and then press *Enter*.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 要离开控制台，输入`exit`，然后按下*Enter*键。
- en: 'Everything that we have done thus far can be simplified into a single command
    line:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们所做的一切都可以简化为一个单一的命令行：
- en: '[PRE3]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We have invoked `nslookup`, used an option of `type=ns` to pull the associated
    nameservers, provided the domain name that we want the information as `example.com`,
    and finally, we specified that we would like to use `156.154.70.22` as our resolving
    DNS nameserver. This will result in the following output:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 我们调用了`nslookup`，使用了`type=ns`的选项来获取相关的域名服务器，提供了我们想要信息的域名`example.com`，最后，我们指定要使用`156.154.70.22`作为我们的解析DNS域名服务器。这将产生以下输出：
- en: '[PRE4]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Tip
  id: totrans-80
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Any time that a command-line tool is executed the output can be sent to a file
    for later review. This is especially important once you start to build your own
    scripts to automate your testing. For example, `nslookup example.com > example-resolv.txt`.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 每当执行命令行工具时，输出都可以发送到文件以供以后查看。一旦开始编写自己的脚本来自动化测试，这一点尤为重要。例如，`nslookup example.com
    > example-resolv.txt`。
- en: Creating an automation script
  id: totrans-82
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建自动化脚本
- en: As previously stated, `nslookup` is an excellent choice given that it is generally
    preinstalled on all platforms. If you are using a pivot point for instance, you
    can be rest assured that this is one tool that you will have available by default.
    As `nslookup` can be run from a single command-line prompt you can easily create
    a script that automates the task of extracting information about many domain or
    hostnames, then have the output placed into a text file.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，`nslookup`是一个很好的选择，因为它通常预装在所有平台上。例如，如果您正在使用一个枢纽点，您可以放心，这是一个默认可用的工具。由于`nslookup`可以从单个命令行提示符中运行，因此您可以轻松地创建一个自动化提取有关许多域名或主机名信息的脚本，然后将输出放入文本文件中。
- en: In BackTrack, open a terminal session and type `nano AutoM8` and press *Enter*.
  id: totrans-84
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在BackTrack中，打开一个终端会话，输入`nano AutoM8`，然后按下*Enter*键。
- en: In the nano editor, type the following code in which we initiate the **bourne**
    shell with `#!/bin/sh`, parse each line item in the `DomainNames.txt` file into
    the `HOSTNAME` variable and then output the string "Getting `name servers for`"
    followed by the current `HOSTNAME` being parsed. We then use the `nslookup` command
    to perform the nameserver lookup using our specified public nameserver at `8.8.8.8:`
  id: totrans-85
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在nano编辑器中，输入以下代码，我们使用`#!/bin/sh`来启动**bourne** shell，将`DomainNames.txt`文件中的每个行项目解析为`HOSTNAME`变量，然后输出字符串"Getting
    `name servers for`"，接着是当前正在解析的`HOSTNAME`。然后我们使用`nslookup`命令来使用我们指定的公共域名服务器`8.8.8.8`执行域名服务器查找：
- en: '[PRE5]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Press *Ctrl + O* then press *Enter* to confirm saving your data.
  id: totrans-87
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + O*，然后按*Enter*确认保存您的数据。
- en: Press *Ctrl + X* to exit back to the terminal screen.
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + X*退出返回到终端屏幕。
- en: Type `nano DomainNames.txt`.
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 键入`nano DomainNames.txt`。
- en: 'In **nano** enter the following:'
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在**nano**中输入以下内容：
- en: Note
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: '**Substitute domains that you have permission to test instead of the** `example.com/net/org`
    **domains used in the following listing!!!**'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: '**在以下列表中使用的`example.com/net/org`域名的地方，用您有权限测试的替代域名!!!**'
- en: '[PRE6]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Press *Ctrl + O* followed by *Ctrl + X* to save the file.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + O*，然后按*Ctrl + X*保存文件。
- en: 'In the terminal we will need to make the `AutoM8` file executable by typing:'
  id: totrans-95
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在终端中，我们需要通过输入以下命令使`AutoM8`文件可执行：
- en: '[PRE7]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Now run the `AutoM8` script by typing:'
  id: totrans-97
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在输入以下命令运行`AutoM8`脚本：
- en: '[PRE8]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'You should see the output similar to the following format:'
  id: totrans-99
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 您应该看到类似以下格式的输出：
- en: '[PRE9]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Now type:'
  id: totrans-101
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 现在输入：
- en: '[PRE10]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: You have now created a simple script named `AutoM8` that can be used to append
    the output into any file you like. We have validated this by using `cat` to look
    into the `NameServerListing.txt` file.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 您现在已经创建了一个名为`AutoM8`的简单脚本，可以用来将输出附加到任何您喜欢的文件中。我们通过使用`cat`来查看`NameServerListing.txt`文件已经验证了这一点。
- en: Tip
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Challenge yourself to make the previous code more efficient and reusable. Several
    of the tools you will learn about in this book could be automated in this fashion.
    Try using `grep` and `awk` to parse out your results in a cleaner fashion.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 挑战自己，使以前的代码更加高效和可重用。本书中您将学到的几种工具可以以这种方式自动化。尝试使用`grep`和`awk`以更清晰的方式解析出您的结果。
- en: Ideally, you will be using tools that have an XML output available to you so
    that results can easily be imported into MagicTree or Dradis, but when performing
    penetration testing on a daily basis you will want to know how to create some
    basic tools for your own special needs. Shell scripting can be very powerful;
    python, which is the tool of choice for many penetration testers, is even better.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 理想情况下，您将使用具有XML输出的工具，以便结果可以轻松导入到MagicTree或Dradis中，但是在日常进行渗透测试时，您将想要知道如何为自己的特殊需求创建一些基本工具。Shell脚本可以非常强大；对于许多渗透测试人员来说，首选工具是Python，它甚至更好。
- en: Note
  id: totrans-107
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Every Penetration Tester should know at least one basic scripting language.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 每个渗透测试人员都应该至少了解一种基本的脚本语言。
- en: What did we learn?
  id: totrans-109
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 我们学到了什么？
- en: If you take a look at the output of the various examples you should note that
    we learned a great deal about our targets already. We know which nameservers are
    used, and we know that all three domains use the same nameservers. We have also
    validated that the domain names we have resolve to certain IP addresses. This
    is the type of data that will be very useful in later stages of your penetration
    test. Now let's move on to some of the more powerful tools we have at our disposal.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您查看各种示例的输出，您应该注意我们已经对目标有了很多了解。我们知道使用了哪些域名服务器，并且我们知道所有三个域名都使用相同的域名服务器。我们还验证了我们拥有的域名解析为某些IP地址。这是在渗透测试的后期阶段非常有用的数据。现在让我们继续使用我们手头的更强大的工具。
- en: Domain Information Groper (Dig)
  id: totrans-111
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 域信息探测器（Dig）
- en: '**Domain Information Groper (Dig)** is a powerful alternative to `nslookup`.
    It has the capability to run either command-line options, or a file can be piped
    into it directly when multiple lookups need to be performed. Dig will use the
    `/etc/resolve.conf` file to cycle through your nameservers unless a nameserver
    is specified. Dig has a very long list of options that can be used to gather exactly
    what you are looking for.'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: '**域信息探测器（Dig）**是`nslookup`的一个强大替代品。它具有运行命令行选项或者可以直接将文件传送到其中进行多次查找的功能。Dig将使用`/etc/resolve.conf`文件来循环遍历您的域名服务器，除非指定了域名服务器。Dig有一个非常长的选项列表，可以用来准确地获取您所寻找的内容。'
- en: Tip
  id: totrans-113
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: There is a website at [http://www.digwebinterface.com/](http://www.digwebinterface.com/)
    that provides dig functionality to the public.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 有一个网站[http://www.digwebinterface.com/](http://www.digwebinterface.com/)向公众提供了dig功能。
- en: Default output
  id: totrans-115
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 默认输出
- en: To initiate the basic command from BackTrack type `dig example.com` from the
    terminal command line. Here is an example of this command when run on a domain
    that is owned by the author.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动BackTrack的基本命令，请在终端命令行中输入`dig example.com`。以下是在作者拥有的域上运行此命令的示例。
- en: Note
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The output from your commands may differ depending on the domain you are targeting.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 您的命令输出可能会因您所针对的域而有所不同。
- en: If you follow along with the commands, you'll be replacing `example.com` with
    domain names that you own or have permission to test.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您跟随命令，您将用您拥有或有权限测试的域名替换`example.com`。
- en: '[PRE11]'
  id: totrans-120
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: This verbose output indicates the version of Dig, which global options were
    selected by default, if there were any errors, and of course that the `A` record
    for `example.com` contains `10.1.1.1`. We also learn that the currently used nameserver
    is at `8.8.8.8`. In addition, we are provided with the time that the query was
    run, which can be very useful when piecing together data at a later date. DNS
    records can be changed, and having the date stamp from previous runs of Dig can
    be useful.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 这个冗长的输出指示了Dig的版本，哪些全局选项是默认选择的，是否有任何错误，当然`example.com`的`A`记录包含`10.1.1.1`。我们还了解到当前使用的域名服务器在`8.8.8.8`。此外，我们还提供了查询运行的时间，这在以后整理数据时非常有用。DNS记录可以更改，具有Dig以前运行的日期戳可能很有用。
- en: 'Let''s dig a little deeper. We will pull all records for the `example.com`
    domain:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入挖掘一下。我们将提取`example.com`域的所有记录：
- en: '[PRE12]'
  id: totrans-123
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'This will pull all DNS records that are available for the `example.com` domain
    due to the `any` option, and the `+qr` switch will print the outgoing query. The
    result will include the header and footer data as seen previously, but will also
    list the following records:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 这将提取`example.com`域的所有可用DNS记录，因为有`any`选项，并且`+qr`开关将打印出站查询。结果将包括头部和页脚数据，如前所述，但还将列出以下记录：
- en: '[PRE13]'
  id: totrans-125
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Zone transfers using Dig
  id: totrans-126
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用Dig进行区域传输
- en: Zone transfers (AXFR) will allow you to pull an entire record set down from
    a nameserver at once. If successful, you will be provided with a listing of all
    information on the nameserver from one simple command. In secured environments
    it is highly unlikely that zone transfers are enabled as it gives an attacker
    a wealth of data in regards to hostnames and other information. We will now review
    the steps necessary to perform a zone transfer on the domain `example.com`. As
    with everything discussed within this book, you need to have the **proper permission**
    to perform this type of activity for your client.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 区域传输（AXFR）将允许你一次从域名服务器中拉取整个记录集。如果成功，你将得到一个简单命令的所有关于域名服务器的信息列表。在安全环境中，区域传输几乎不可能被启用，因为它会给攻击者提供大量有关主机名和其他信息的数据。现在我们将回顾在域`example.com`上执行区域传输所需的步骤。与本书中讨论的所有内容一样，你需要有**适当的权限**来为你的客户执行这种类型的活动。
- en: Open up a BackTrack terminal window.
  id: totrans-128
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 打开一个BackTrack终端窗口。
- en: Type the following and press *Enter:*
  id: totrans-129
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 输入以下内容并按*Enter*：
- en: '[PRE14]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Review the results:'
  id: totrans-131
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审查结果：
- en: '[PRE15]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Our results indicate that the transfer has failed. In this case the administrator
    of the nameserver has properly disabled the ability to perform zone transfers.
    Now we will try another nameserver on the same domain and see if zone transfers
    are disabled on it as well.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的结果表明传输失败了。在这种情况下，域名服务器的管理员已经正确地禁用了执行区域传输的能力。现在我们将尝试同一域上的另一个域名服务器，看看它是否也禁用了区域传输。
- en: 'Type:'
  id: totrans-134
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 类型：
- en: '[PRE16]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Review the results:'
  id: totrans-136
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 审查结果：
- en: '[PRE17]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: When reviewing the record pulled for `example.com` we find several points of
    interest. It seems that `example.com` has several subdomains that are directed
    at the same IP address. If this site had not been set up strictly as an example,
    you would have real IP addresses to systems that could be enumerated. Also, there
    is a TXT record containing trivial information. In addition, it can be said that
    the naming convention is both inconsistent and informative.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在审查为`example.com`拉取的记录时，我们发现了几个有趣的地方。看起来`example.com`有几个子域名指向同一个IP地址。如果这个站点不是严格作为一个例子设置的话，你将会得到真实的IP地址，可以枚举系统。此外，还有一个包含琐碎信息的TXT记录。此外，可以说命名约定既不一致又具有信息量。
- en: Note
  id: totrans-139
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: It is very important that *all* of your nameservers are restricted to serving
    zone transfers to only trusted servers, or that zone transfers are completely
    disallowed.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 非常重要的是，*所有*你的域名服务器都被限制只向受信任的服务器提供区域传输，或者完全禁止区域传输。
- en: If you want to learn more about zone transfers I highly suggest that you take
    a look at `zonetransfer.me` which will redirect you to [http://www.digininja.org/projects/zonetransferme.php](http://www.digininja.org/projects/zonetransferme.php).
    The owner of that website has done an excellent job of detailing how zone transfers
    work.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想了解更多关于区域传输的信息，我强烈建议你查看`zonetransfer.me`，它会将你重定向到[http://www.digininja.org/projects/zonetransferme.php](http://www.digininja.org/projects/zonetransferme.php)。该网站的所有者已经非常详细地介绍了区域传输的工作原理。
- en: Advanced features of Dig
  id: totrans-142
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Dig的高级功能
- en: We have been discussing the basic usage of dig. Now we will touch upon a more
    advanced usage of this tool.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经讨论了dig的基本用法。现在我们将涉及这个工具的更高级用法。
- en: Shortening the output
  id: totrans-144
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 缩短输出
- en: Dig is versatile and allows you to extract the data in many different output
    formats.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: Dig是多功能的，可以让你以许多不同的输出格式提取数据。
- en: We can eliminate the command information section of the output by using `+nocmd`.
    It must precede the domain name in order to be effective.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过使用`+ nocmd`来消除输出的命令信息部分。它必须在域名之前才能生效。
- en: '`+noall` informs dig that we do not want the display flags as part of the command
    output.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: + noall通知dig我们不希望显示标志作为命令输出的一部分。
- en: '`+answer` can be toggled to display only the answer section.'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '`+ answer`可以切换为只显示答案部分。'
- en: '[PRE18]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'This will result in the following output:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这将导致以下输出：
- en: '[PRE19]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Any options discussed within this section can be used when shortening your output
    results. This makes it easy to use tools such as `awk` and `grep` to further manipulate
    your results.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 本节讨论的任何选项都可以在缩短输出结果时使用。这使得可以轻松使用诸如`awk`和`grep`之类的工具来进一步操作你的结果。
- en: Listing the bind version
  id: totrans-153
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 列出bind版本
- en: 'This command will allow you to determine the version of bind the nameserver
    is running unless it has been specifically restricted or changed by the server
    administrator. Remember to substitute `example.com` with a nameserver that you
    have permission to use:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令将允许你确定域名服务器正在运行的bind版本，除非它已经被服务器管理员专门限制或更改。记得用你有权限使用的域名服务器替换`example.com`：
- en: '[PRE20]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'This will result in the following output:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 这将导致以下输出：
- en: '[PRE21]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: We have determined that this particular nameserver is running bind 8.4.X. This
    information can prove to be extremely valuable when enumerating vulnerabilities.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经确定这个特定的域名服务器正在运行bind 8.4.X。这些信息在枚举漏洞时可能非常有价值。
- en: Reverse DNS lookup using Dig
  id: totrans-159
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用Dig进行反向DNS查找
- en: 'At times it will be necessary to resolve IP addresses to domain names. There
    is no need to swap back to `nslookup` to perform this task as you can simply type:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 有时需要将IP地址解析为域名。无需切换回`nslookup`来执行此任务，只需输入：
- en: '[PRE22]'
  id: totrans-161
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Your output would look something like this:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 你的输出会看起来像这样：
- en: '[PRE23]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: The previous command allowed us to determine the domain name associated with
    `192.168.0.1`.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 前面的命令让我们确定了与`192.168.0.1`相关联的域名。
- en: Multiple commands
  id: totrans-165
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 多个命令
- en: We can chain commands using dig. In the following example, we use our shortened
    output format to provide us with the `A` record of `example.com` and `example.net`
    and then request a reverse lookup on `192.0.43.10`.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用dig链式命令。在下面的例子中，我们使用我们缩短的输出格式来为我们提供`example.com`和`example.net`的`A`记录，然后请求对`192.0.43.10`进行反向查找。
- en: '[PRE24]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: 'The resulting output is as follows (domain name has been replaced with `example.org`
    in this output):'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 结果输出如下（在此输出中，域名已被替换为`example.org`）：
- en: '[PRE25]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Tracing the path
  id: totrans-170
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 跟踪路径
- en: 'If you would like to see the route that dig is taking to resolve your domain
    name you can use the `+trace` option as follows:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想查看dig解析域名所采取的路由，可以使用以下命令`+trace`选项：
- en: '[PRE26]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Batching with dig
  id: totrans-173
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 使用dig进行批处理
- en: Instead of having to write a script to loop that evaluates a list of domain
    names in a file like we had to when using `nslookup`, dig can use the `-f` option.
    We can use the dig command format to perform these batch jobs.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 不必像使用`nslookup`时那样编写循环脚本来评估文件中的域名列表，dig可以使用`-f`选项。我们可以使用dig命令格式来执行这些批处理作业。
- en: We will begin by creating a new TXT file using the nano text editor included
    in BackTrack. Open up a terminal shell in BackTrack and type `nano digginIt.txt`.
  id: totrans-175
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我们将首先使用BackTrack中包含的nano文本编辑器创建一个新的TXT文件。在BackTrack中打开终端shell，然后键入`nano digginIt.txt`。
- en: 'In nano type the following code. Note that each command needs to be on its
    own line to function properly:'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在nano中键入以下代码。请注意，每个命令都需要单独一行才能正常运行：
- en: '[PRE27]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: Press *Ctrl + O* to write save the file.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + O*保存文件。
- en: Press *Ctrl + X* to exit back to the terminal.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + X*退出返回到终端。
- en: 'Invoke the dig command using:'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用dig命令调用：
- en: '[PRE28]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'The results will be displayed on your screen:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 结果将显示在屏幕上：
- en: '[PRE29]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: We have successfully created and executed a dig batch job. This could be put
    to many uses including creating and checking against baselines, performing repetitive
    tasks from one penetration test to the next, or simply keeping track of the commands
    used to perform this portion of your reconnaissance. Store the text file used
    in the batch job so that you can at a later time validate the findings.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已成功创建并执行了一个dig批处理作业。这可以用于许多用途，包括创建和检查基线，从一个渗透测试到下一个执行重复任务，或者简单地跟踪用于执行您的侦察的命令。存储用于批处理作业的文本文件，以便以后验证结果。
- en: DNS brute forcing with fierce
  id: totrans-185
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用fierce进行DNS暴力破解
- en: In a secured environment DNS brute forcing is likely to be your best bet in
    determining which hosts are used in non-contiguous IP space. BackTrack contains
    several tools that address this need. We will be discussing fierce, created by
    RSnake, which is fast and efficient at DNS brute forcing. It will begin with determining
    the IP address of the domain, looking up the associated nameservers, and then
    working its way through your dictionary word list. The tool supplies an example
    word list that can be used for testing, but you should replace or supplement it
    with dictionary words more specific to your needs as soon as possible.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 在安全环境中，DNS暴力破解很可能是确定非连续IP空间中使用哪些主机的最佳选择。BackTrack包含几个工具来满足这种需求。我们将讨论由RSnake创建的fierce，它在DNS暴力破解方面快速高效。它将从确定域的IP地址开始，查找相关的名称服务器，然后逐个查找您的字典单词列表。该工具提供了一个示例单词列表，可用于测试，但您应尽快用更符合您需求的字典单词替换或补充它。
- en: Default command usage
  id: totrans-187
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 默认命令用法
- en: 'In BackTrack we will open up a terminal session and change directory to where
    the `fierce.pl` perl script is located:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在BackTrack中，我们将打开一个终端会话，并切换到`fierce.pl` perl脚本所在的目录：
- en: '[PRE30]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '`fierce.pl` contains a help section that can be accessed using:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '`fierce.pl`包含一个可以使用的帮助部分：'
- en: '[PRE31]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'The most basic method of using fierce is to use:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 使用fierce的最基本方法是使用：
- en: '[PRE32]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'This will result in output similar to the following:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 这将导致类似以下的输出：
- en: '[PRE33]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: This output indicates that the first step taken was to locate the nameservers
    for the `example.com` domain. The next step is to check the server to see if a
    zone transfer can be performed. As we have learned previously, zone transfers
    will extract all known domain information from the server with one command. There
    would be no need to brute force domain names if you can simply pull the entire
    record set at once.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 此输出表明首先要做的是查找`example.com`域的名称服务器。下一步是检查服务器，看看是否可以执行区域传输。正如我们之前学到的，区域传输将通过一个命令从服务器提取所有已知的域信息。如果可以一次性提取整个记录集，就不需要暴力破解域名。
- en: Some domains include wildcard DNS records. This will cause any subdomain you
    use to be resolved regardless of if it exists or not. In this case there were
    no wildcard DNS entries found.
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 一些域包括通配符DNS记录。这将导致任何您使用的子域都会被解析，无论它是否存在。在这种情况下，没有找到通配符DNS条目。
- en: The number of tests that are run will be determined by how many words are in
    your supplied word list. As we did not specify which list to use in the preceding
    example, `hosts.txt` which resides in the `/fierce` directory on Backtrack will
    be used by default.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: 运行的测试次数将取决于您提供的单词列表中有多少单词。由于在前面的示例中没有指定要使用哪个列表，默认情况下将使用Backtrack上`/fierce`目录中的`hosts.txt`。
- en: 'Here `fierce.pl` is used against a domain that allows for zone transfers:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，`fierce.pl`用于允许区域传输的域：
- en: '[PRE34]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'In this case, the brute forcing functionality of the tool is not necessary
    and thus not initialized. See the following results for details:'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，工具的暴力破解功能是不必要的，因此未初始化。有关详细信息，请参阅以下结果：
- en: '[PRE35]'
  id: totrans-202
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Looking at the results we can see that `fierce.pl` indicated that this setting
    is a misconfiguration which should be yet another indicator that allowing open
    AXFR is not advisable under any circumstance.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 查看结果，我们可以看到`fierce.pl`指示此设置是一个错误配置，这应该是另一个指示，即不建议在任何情况下允许开放的AXFR。
- en: Creating a custom wordlist
  id: totrans-204
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 创建自定义单词列表
- en: If we already have an idea of what we would like to check for, or we have a
    word list that may be more appropriate as we understand the naming convention
    of the site being tested, then making a custom word list is recommended.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们已经知道要检查什么，或者我们有一个更适合的单词列表，因为我们了解正在测试的站点的命名约定，那么建议制作自定义单词列表。
- en: Open up Nano using `nano myWordList.txt`.
  id: totrans-206
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 使用`nano myWordList.txt`打开Nano。
- en: 'Type the following:'
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 键入以下内容：
- en: '[PRE36]'
  id: totrans-208
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: Press *Ctrl + O* and press *Enter* to accept writing the file out to `myWordList.txt`.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + O*，然后按*Enter*，将文件写入`myWordList.txt`。
- en: Press *Ctrl + X* to exit back to the terminal shell.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 按下*Ctrl + X*退出返回到终端shell。
- en: 'Now that we have created our custom word list named `myWordList.txt`, let''s
    give it a try:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经创建了名为`myWordList.txt`的自定义单词列表，让我们试试：
- en: '[PRE37]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'After a short delay we will be presented with the following output:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 短暂延迟后，我们将看到以下输出：
- en: '[PRE38]'
  id: totrans-214
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Although this server no longer allowed us to use zone transfers, we were still
    able to map several of the subdomains through the use of a good word list.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管该服务器不再允许我们使用区域传输，但我们仍然能够通过良好的单词列表映射出几个子域。
- en: When you are unable to perform a zone transfer there are still methods that
    can be used to effectively enumerate the subdomains and hostnames on a network.
    An internal DNS nameserver will be able to provide you with a tremendous amount
    of information that can later be used to evaluate the network for vulnerabilities,
    and ultimately be used to exploit the environment. `fierce.pl` is a very useful
    addition to our arsenal of penetration testing utilities, and can be used to accomplish
    a great deal more than simple DNS brute forcing.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 当无法执行区域传输时，仍然可以使用其他方法有效地枚举网络上的子域和主机名。内部DNS名称服务器将能够为您提供大量信息，以后可以用来评估网络的漏洞，并最终用来利用环境。`fierce.pl`是我们渗透测试工具库中非常有用的补充，可以用来完成比简单的DNS暴力破解更多的工作。
- en: Gathering and validating domain and IP information
  id: totrans-217
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集和验证域和IP信息
- en: When a person or corporate entity registers a domain name there is a lot of
    information that is gathered. Depending on the registration privacy settings,
    you can collect this information and use it to verify your IP space, find information
    about other sites owned by the same individual or corporation, or even phone numbers
    and addresses of key employees. This type of reconnaissance is considered passive
    as it does not directly contact client-owned assets to pull information.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 当个人或公司实体注册域名时，会收集大量信息。根据注册隐私设置，您可以收集这些信息并用于验证您的IP空间，查找同一人或公司拥有的其他网站的信息，甚至关键员工的电话号码和地址。这种侦察被认为是被动的，因为它不直接联系客户拥有的资产来获取信息。
- en: We will need to locate the registrar that the domain has been registered with
    to obtain useful information. Here is a listing of the top registrars.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要找到已注册域名的注册商以获取有用的信息。以下是一些顶级注册商的列表。
- en: '| AFRINIC | [http://www.afrinic.net](http://www.afrinic.net) |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '| AFRINIC | [http://www.afrinic.net](http://www.afrinic.net) |'
- en: '| APNIC | [http://www.apnic.net](http://www.apnic.net) |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| APNIC | [http://www.apnic.net](http://www.apnic.net) |'
- en: '| ARIN | [http://ws.arin.net](http://ws.arin.net) |'
  id: totrans-222
  prefs: []
  type: TYPE_TB
  zh: '| ARIN | [http://ws.arin.net](http://ws.arin.net) |'
- en: '| IANA | [http://www.iana.com](http://www.iana.com) |'
  id: totrans-223
  prefs: []
  type: TYPE_TB
  zh: '| IANA | [http://www.iana.com](http://www.iana.com) |'
- en: '| ICANN | [http://www.icann.org](http://www.icann.org) |'
  id: totrans-224
  prefs: []
  type: TYPE_TB
  zh: '| ICANN | [http://www.icann.org](http://www.icann.org) |'
- en: '| LACNIC | [http://www.lacnic.net](http://www.lacnic.net) |'
  id: totrans-225
  prefs: []
  type: TYPE_TB
  zh: '| LACNIC | [http://www.lacnic.net](http://www.lacnic.net) |'
- en: '| NRO | [http://www.nro.net](http://www.nro.net) |'
  id: totrans-226
  prefs: []
  type: TYPE_TB
  zh: '| NRO | [http://www.nro.net](http://www.nro.net) |'
- en: '| RIPE | [http://www.ripe.net](http://www.ripe.net) |'
  id: totrans-227
  prefs: []
  type: TYPE_TB
  zh: '| RIPE | [http://www.ripe.net](http://www.ripe.net) |'
- en: '| InterNic | [http://www.internic.net](http://www.internic.net) |'
  id: totrans-228
  prefs: []
  type: TYPE_TB
  zh: '| InterNic | [http://www.internic.net](http://www.internic.net) |'
- en: Gathering information with whois
  id: totrans-229
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用whois收集信息
- en: Domain and IP space registration information can be found by using **whois**.
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 可以使用**whois**找到域名和IP空间注册信息。
- en: Note
  id: totrans-231
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: Be aware of the specific restrictions and rules that you need to abide by when
    using **whois**. For example, you are not allowed to automate your queries or
    to use the results for commercial or personal gain. Read the legal text headers
    that appear when you run a simple `whois example.com` query from the command line.
    Heed the warnings and follow the rules.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 在使用**whois**时，请注意您需要遵守的具体限制和规则。例如，您不允许自动化查询或将结果用于商业或个人利益。运行简单的`whois example.com`查询时，请阅读出现的法律文本标题。请注意警告并遵守规则。
- en: 'The most basic usage of whois is as follows:'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
  zh: whois的最基本用法如下：
- en: '[PRE39]'
  id: totrans-234
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'This will perform a quick lookup of the `example.com` domain and provide you
    with the following information:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 这将快速查找`example.com`域并为您提供以下信息：
- en: Whois usage agreements and legal headers
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Whois使用协议和法律标题
- en: Domain name
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 域名
- en: Registrar the domain name is registered with
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册域名的注册商
- en: Whois server that was used
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用的whois服务器
- en: The primary DNS nameservers associated with the domain
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 与域相关的主要DNS名称服务器
- en: Domain creation and expiration dates
  id: totrans-241
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 域名创建和到期日期
- en: Registrant information such as First Name, Last Name, Organization, physical
    address, phone number, and e-mail address
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 注册人信息，如名字、姓氏、组织、实际地址、电话号码和电子邮件地址
- en: Assigned domain administrator information such as First Name, Last Name, Organization,
    physical address, phone number, and e-mail address
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分配的域管理员信息，如名字、姓氏、组织、实际地址、电话号码和电子邮件地址
- en: Domain billing contact information such as First Name, Last Name, Organization,
    physical address, phone number, and e-mail address
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 域账单联系信息，如名字、姓氏、组织、实际地址、电话号码和电子邮件地址
- en: Domain technical contact information such as First Name, Last Name, Organization,
    physical address, phone number, and e-mail address
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 域技术联系人信息，如名字、姓氏、组织、实际地址、电话号码和电子邮件地址
- en: Specifying which registrar to use
  id: totrans-246
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 指定要使用的注册商
- en: There may be times when you will need to specify which registrar you would like
    to query. **whois** makes this simple by allowing the usage of the `-h` "connect
    to host" option.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 有时您需要指定要查询的注册商。**whois**通过允许使用`-h`“连接到主机”选项来简化此过程。
- en: '[PRE40]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Where in the world is this IP?
  id: totrans-249
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 这个IP在世界的哪个地方？
- en: 'You can use **whois** to find the originating country an IP address is assigned
    to:'
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用**whois**查找IP地址分配给的原始国家：
- en: '[PRE41]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'What we have done here is use the `-h` option to specify `whois.arin.net` to
    extract the record associated with `192.0.43.10` because we specifically wanted
    the country information relating to this IP. We used the `grep` command to pull
    out the `Country:` row. Here is the resulting output which indicates this IP address
    is located in The United States of America:'
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这里所做的是使用“-h”选项来指定`whois.arin.net`，以提取与`192.0.43.10`相关联的记录，因为我们特别想要与此IP相关的国家信息。我们使用`grep`命令来提取`Country:`行。以下是结果输出，表明该IP地址位于美利坚合众国：
- en: '[PRE42]'
  id: totrans-253
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Tip
  id: totrans-254
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: You will find the output format will vary from one registrar to the next. Take
    some time and get familiar with the different outputs so that you know what to
    grep for in the future. This could potentially save you a lot of time in the long
    run.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 您会发现输出格式会因注册商而异。花些时间熟悉不同的输出，这样您就会知道将来要在输出中搜索什么。这可能会在长远节省您大量时间。
- en: Defensive measures
  id: totrans-256
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 防御措施
- en: When you or your clients register domains, you should opt in on privacy options.
    These will restrict the information that is available to the public. The data
    will be replaced with the information provided by your privacy proxy. In case
    there are situations that require someone to get in contact with you they would
    contact your proxy whom would in turn let you know that there is an issue that
    needs to be addressed.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: 当您或您的客户注册域名时，应选择隐私选项。这些选项将限制向公众提供的信息。数据将被隐私代理提供的信息替换。如果有需要与您联系的情况，他们将联系您的代理，代理将再通知您需要解决的问题。
- en: Using search engines to do your job for you
  id: totrans-258
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 利用搜索引擎为您工作
- en: Search engines can produce an absolute overload of information if not used efficiently.
    Not only can you find information about the financials of your targets, but also
    information about key employees, usernames and passwords, confidential documents
    such as network diagrams, information indicating what types of software or hardware
    you use or have in place, and even if systems are in a default state. This information
    can be devastating in the wrong hands. As a penetration tester your focus should
    be to bring this type of information forth and show the clients how it can be
    used to gain access to the clients' most critical assets (and hopefully, you will
    tell them how to fix the problem as well!).
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不有效地使用，搜索引擎可能会产生绝对的信息过载。您不仅可以找到有关目标财务状况的信息，还可以找到有关关键员工、用户名和密码、机密文件（如网络图表）、有关您使用或已安装的软件或硬件类型的信息，甚至系统是否处于默认状态的信息。这些信息如果落入错误的手中可能会造成毁灭性的后果。作为渗透测试人员，您的重点应该是提取这类信息，并向客户展示如何利用这些信息来获取对客户最关键资产的访问权限（希望您也会告诉他们如何解决问题！）。
- en: Tip
  id: totrans-260
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: There are search engines that cache information for quick access, and there
    are search engines that will archive sites and documents for years on end. There
    are even search engines that focus strictly on networking equipment such as wireless
    access points or publically facing routers, switches, servers, and more.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 有些搜索引擎会缓存信息以便快速访问，还有一些搜索引擎会存档网站和文件多年。甚至有一些搜索引擎专门关注网络设备，如无线接入点或公共路由器、交换机、服务器等。
- en: SHODAN
  id: totrans-262
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: SHODAN
- en: We will continue our footprinting reconnaissance efforts with **Shodan**. This
    search engine is specialized in indexing the information found in banners served
    by devices attached to the Internet. The search engine primarily indexes finding
    from port 80, but also indexes some Telnet, SSH, and FTP banners. SHODAN is a
    web application and can be accessed by going to [http://www.shodanhq.com](http://www.shodanhq.com).
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将继续使用**Shodan**进行足迹侦察工作。这个搜索引擎专门用于索引连接到互联网的设备提供的横幅信息。该搜索引擎主要索引端口80的发现，但也索引一些Telnet、SSH和FTP横幅。SHODAN是一个网络应用程序，可以通过访问[http://www.shodanhq.com](http://www.shodanhq.com)来访问。
- en: '![SHODAN](img/7744_02_02.jpg)'
  id: totrans-264
  prefs: []
  type: TYPE_IMG
  zh: '![SHODAN](img/7744_02_02.jpg)'
- en: With **Shodan** you can find information on devices connected to the Internet.
    In addition to allowing you to search by IP address or hostname it also allows
    you to search by geographical location. Exporting the search results into XML
    is a premium feature which would require you to purchase credits. There is an
    example export available if you want to build a transform for MagicTree or some
    other data centralization tool before you decide if you want to spend money on
    the export.
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
  zh: 使用**Shodan**，您可以找到连接到互联网的设备的信息。除了允许您按IP地址或主机名搜索外，它还允许您按地理位置搜索。将搜索结果导出为XML是一个高级功能，需要您购买积分。如果您想在决定是否花钱购买导出之前构建MagicTree或其他数据集中工具的转换，可以查看一个示例导出。
- en: Filters
  id: totrans-266
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 过滤器
- en: 'There are several free filters that make narrowing the searches down much simpler.
    Most filters use the same format: *searchterm filter:{filterterm}*; an example
    would be a search for `IIS 6.0 os:"Windows 2000`". These filters can also be used
    in conjunction with each other in order to pull some very interesting results.'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
  zh: 有几个免费的过滤器可以使搜索范围缩小得更简单。大多数过滤器使用相同的格式：*searchterm filter:{filterterm}*；例如，搜索`IIS
    6.0 os:"Windows 2000`"。这些过滤器也可以结合使用，以便提取一些非常有趣的结果。
- en: 'Here is a listing of several important filters:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是几个重要的过滤器列表：
- en: '**net:** Possibly one of the most useful filters for a penetration tester.
    You can search your IP ranges using IP/CIDR notation (for example, 127.1.1.0/24)
    to see if all of your devices are configured as expected, or if there are indicators
    that a vulnerable server or network device configuration is externally facing
    and ready to be compromised during testing.'
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**net:** 对于渗透测试人员来说可能是最有用的过滤器之一。您可以使用IP/CIDR表示法（例如，127.1.1.0/24）搜索您的IP范围，以查看所有设备是否按预期配置，或者是否存在迹象表明一个易受攻击的服务器或网络设备配置面向外部并准备在测试期间被攻破。'
- en: '**city:** This will limit the search to the city listed.'
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**city:** 这将限制搜索到所列城市。'
- en: '**country:** Restricts the search to devices in the country of choice. This
    is also very important for pentesting, as there may be times when a client provides
    you with IP ranges (which you validated, right?), and then places certain assets
    out of scope due to location. A client may chose to not test against systems located
    in Singapore for instance.'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**country:** 将搜索限制为所选国家的设备。这对于渗透测试非常重要，因为有时客户可能会提供您IP范围（您已经验证了，对吧？），然后由于位置的原因将某些资产排除在范围之外。例如，客户可能选择不针对位于新加坡的系统进行测试。'
- en: '**port:** Will restrict the search to the port indicated. Remember that SHODAN
    does not scan and index banners for all ports, only for 80, 21, 22, and 23.'
  id: totrans-272
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**port:** 将搜索限制为指定的端口。请记住，SHODAN并不扫描和索引所有端口的横幅，只扫描和索引80、21、22和23端口的横幅。'
- en: '**before:** Search for systems scanned before a specified date.'
  id: totrans-273
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**before:** 搜索指定日期之前扫描的系统。'
- en: '**after:** Search for systems scanned after this date.'
  id: totrans-274
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**after:** 搜索在此日期之后扫描的系统。'
- en: '**os:** Which operating systems do you want to include or exclude in your search?'
  id: totrans-275
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**os:** 您想在搜索中包含或排除哪些操作系统？'
- en: Understanding banners
  id: totrans-276
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 理解横幅
- en: In order to perform affective searching in Shodan you must have some understanding
    of the types of banners that are indexed and what sort of information they typically
    contain.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
  zh: 为了在Shodan中进行有效的搜索，您必须了解已索引的横幅类型以及它们通常包含的信息。
- en: FTP, Telnet, and SSH banners will vary, but each will provide useful versioning
    information.
  id: totrans-278
  prefs: []
  type: TYPE_NORMAL
  zh: FTP、Telnet和SSH横幅将有所不同，但每种都将提供有用的版本信息。
- en: HTTP banners
  id: totrans-279
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: HTTP横幅
- en: 'Banners can be collected by using `nc example.com:80` and then typing `HEAD
    / HTTP/1.0` which results in the typical banner format you will see in your SHODAN
    results. As the HTTP banners are often the most difficult to understand we walk
    through some of the commonly found sections:'
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
  zh: 横幅可以通过使用`nc example.com:80`进行收集，然后输入`HEAD / HTTP/1.0`，这将导致您在SHODAN结果中看到的典型横幅格式。由于HTTP横幅通常是最难理解的，我们将介绍一些常见的部分：
- en: '[PRE43]'
  id: totrans-281
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: The `HTTP/1.1 200` status code highlighted will provide a response to your query
    indicating the status of your request. In this case the `HEAD/ HTTP/1.0` was accepted
    and processed successfully thus initiating a status code of `200 OK`.
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`HTTP/1.1 200`状态代码的突出显示将为您的查询提供响应，指示请求的状态。在这种情况下，`HEAD/ HTTP/1.0`被接受并成功处理，从而启动了`200
    OK`的状态代码。'
- en: '`Content-Length:` Indicated the length of the content in decimal number of
    OCTETs.'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Content-Length:` 表示内容的长度，以十进制的OCTET数表示。'
- en: '`Content-Type:` Will list the type of content being sent. Could be image/GIF,
    text/HTML, or other types.'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Content-Type:` 将列出正在发送的内容类型。可能是image/GIF、text/HTML或其他类型。'
- en: '`Accept-Ranges:` Indicates if the server will accept a byte range. Setting
    this to none will let the client know that range requests could be denied.'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Accept-Ranges:` 指示服务器是否接受字节范围。将其设置为none将让客户端知道范围请求可能被拒绝。'
- en: '`ETag:` Provides the client with the current entity tag value.'
  id: totrans-286
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`ETag:` 为客户端提供当前实体标记值。'
- en: '`Server:` Will provide you with the version and type of software being used
    to service the request. This is one of the most important banner results for a
    penetration tester. Clients should be advised to hide this information. You will
    use this information to establish what attack types may be usable on the machine.'
  id: totrans-287
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Server:` 将为您提供用于服务请求的软件版本和类型。这是渗透测试人员最重要的横幅结果之一。客户端应该被建议隐藏这些信息。您将使用这些信息来确定可能对该机器可用的攻击类型。'
- en: '`X-Powered-By:` Flag is not a standard header, but can provide useful information
    to an attacker. It can also be changed or disabled completely.'
  id: totrans-288
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`X-Powered-By:` 标志不是标准标头，但可以为攻击者提供有用的信息。它也可以被更改或完全禁用。'
- en: 'Common status codes include:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 常见的状态代码包括：
- en: '| **HTTP status code** | **Description** |'
  id: totrans-290
  prefs: []
  type: TYPE_TB
  zh: '| **HTTP状态代码** | **描述** |'
- en: '| --- | --- |'
  id: totrans-291
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| 200 | A successful query resulting in displaying the result. |'
  id: totrans-292
  prefs: []
  type: TYPE_TB
  zh: '| 200 | 成功的查询结果显示。 |'
- en: '| 301 | Document has been moved permanently. |'
  id: totrans-293
  prefs: []
  type: TYPE_TB
  zh: '| 301 | 文档已永久移动。 |'
- en: '| 302 | Document has been moved temporarily. |'
  id: totrans-294
  prefs: []
  type: TYPE_TB
  zh: '| 302 | 文档已暂时移动。 |'
- en: '| 307 | A temporary redirect is being used. |'
  id: totrans-295
  prefs: []
  type: TYPE_TB
  zh: '| 307 | 正在使用临时重定向。 |'
- en: '| 400 | Syntax error - Cannot process your request. |'
  id: totrans-296
  prefs: []
  type: TYPE_TB
  zh: '| 400 | 语法错误-无法处理您的请求。 |'
- en: '| 401 | Request requires authentication. Usually indicates a login is required.
    |'
  id: totrans-297
  prefs: []
  type: TYPE_TB
  zh: '| 401 | 请求需要身份验证。通常表示需要登录。 |'
- en: '| 403 | Request is forbidden. |'
  id: totrans-298
  prefs: []
  type: TYPE_TB
  zh: '| 403 | 请求被禁止。 |'
- en: '| 404 | The page was not found on the server. |'
  id: totrans-299
  prefs: []
  type: TYPE_TB
  zh: '| 404 | 服务器上找不到页面。 |'
- en: '| 502 | The server is not available at the moment. Unable to get the resource
    on behalf of the client. |'
  id: totrans-300
  prefs: []
  type: TYPE_TB
  zh: '| 502 | 服务器当前不可用。无法代表客户端获取资源。 |'
- en: '| 501 | Internal server errors cause the server to be unable to complete the
    request. - Request was not supported. |'
  id: totrans-301
  prefs: []
  type: TYPE_TB
  zh: '| 501 | 内部服务器错误导致服务器无法完成请求。-请求不受支持。 |'
- en: '| 505 | Unsupported HTTP version was used. |'
  id: totrans-302
  prefs: []
  type: TYPE_TB
  zh: '| 505 | 使用了不受支持的HTTP版本。 |'
- en: Finding specific assets
  id: totrans-303
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查找特定资产
- en: Just as with most search engines the tool is extremely user friendly. To perform
    a basic search, simply type the search string into the input box at the top of
    the screen and you will be presented with a listing of results. You can search
    using any of the filters we have previously discussed, or you can try your hand
    at looking for specific banner fields.
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 就像大多数搜索引擎一样，该工具非常用户友好。要执行基本搜索，只需将搜索字符串输入到屏幕顶部的输入框中，然后您将看到结果列表。您可以使用我们之前讨论过的任何过滤器进行搜索，或者您可以尝试查找特定的横幅字段。
- en: Finding people (and their documents) on the web
  id: totrans-305
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 在网络上查找人（及其文档）
- en: In this day and age, everything is becoming interconnected. People are using
    their personal devices for work, sending out corporate e-mails using personal
    accounts on publicly owned mail servers, and watching lots of videos. One trend
    that has occurred over the years is that people have become so comfortable with
    the Internet that they are willing to share their information with unknown individuals
    and websites around the world. We will now discuss some of the methods you can
    use to verify that your clients are not unintentionally or intentionally leaking
    actionable or confidential data onto the public Internet.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 在当今这个时代，一切都在变得互相连接。人们正在使用他们的个人设备进行工作，使用个人帐户在公共拥有的邮件服务器上发送公司电子邮件，并观看大量视频。多年来出现的一个趋势是，人们对互联网变得如此舒适，以至于愿意与世界各地的未知个人和网站分享他们的信息。我们现在将讨论一些方法，您可以使用这些方法来验证您的客户是否没有无意或有意地将可操作或机密数据泄露到公共互联网上。
- en: Google hacking database
  id: totrans-307
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Google黑客数据库
- en: There have been many books written on Google hacking, that speaking of the details
    and tricks involved would quickly divert the focus of this book.
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 已经有很多关于Google黑客的书籍，谈论细节和技巧会很快转移本书的重点。
- en: Tip
  id: totrans-309
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: If you are not familiar with Google hacking, perform a search for Johnny Long
    and visit his website at [http://www.hackersforcharity.com](http://www.hackersforcharity.com),
    and check out The Google Hacking Database (GHDB), which was the original Google
    Dorks repository.
  id: totrans-310
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您对Google黑客不熟悉，请搜索Johnny Long并访问他的网站[http://www.hackersforcharity.com](http://www.hackersforcharity.com)，并查看原始的Google
    Dorks存储库，即Google Hacking Database (GHDB)。
- en: Exploit-DB at `exploit-db.com` has taken over and updated Mr. Long's Google
    Dorks database. This is now the official GHDB site. You should use these tools
    in tandem with good filters to ensure that you get only the data you need. Here
    are some examples of how this can be done.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: Exploit-DB在`exploit-db.com`接管并更新了Mr. Long的Google Dorks数据库。这现在是官方的GHDB网站。您应该与良好的过滤器一起使用这些工具，以确保您只获取所需的数据。以下是一些示例，说明如何做到这一点。
- en: 'Go to [http://exploit-db.com/google-dorks](http://exploit-db.com/google-dorks)
    and choose a query. Here is a random entry:'
  id: totrans-312
  prefs: []
  type: TYPE_NORMAL
  zh: 转到[http://exploit-db.com/google-dorks](http://exploit-db.com/google-dorks)并选择一个查询。这是一个随机条目：
- en: '[PRE44]'
  id: totrans-313
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Enter it into `Google.com` with the following modifications. Add the `site:`
    option followed by a domain name that is part of your rules of engagement:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: 将其输入`Google.com`并进行以下修改。添加`site:`选项，后面跟着您规则中的域名：
- en: '[PRE45]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: In the case of this example, if there are any results found, you have located
    a MS Excel file that contains some form of "password". Mind that results will
    vary and the best Google search queries are usually focused on determining the
    versions of installed software, seeking out known vulnerable installations that
    will later be targeted if allowed by the rules of engagement.
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，如果找到任何结果，您已经找到了一个包含某种形式“密码”的MS Excel文件。请注意，结果会有所不同，而且最好的Google搜索查询通常集中在确定已安装软件的版本，寻找已知的易受攻击的安装，如果规则允许的话，以后将被攻击。
- en: You should also be performing focused searches that locate all major document
    types such as `.pdf, .doc, .txt, .xls`, and more. However, there are some additional
    tools that will help us with this.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 您还应该执行定向搜索，以查找所有主要文档类型，如`.pdf，.doc，.txt，.xls`等。但是，还有一些其他工具可以帮助我们。
- en: Tip
  id: totrans-318
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: 'Warning: Do not open random files on your primary testing machine. You should
    have a separate machine that is not connected to your network or the Internet
    that can be used to open unknown (that is potentially harmful) files and media.
    One of the easiest methods of gaining access to a machine is through sending a
    file to a user that uses exploits to open a system up to an attacker. Opening
    unknown files in an uncontrolled environment would be reckless. Don''t be that
    user.'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 警告：不要在您的主要测试机器上打开随机文件。您应该有一台与您的网络或互联网没有连接的单独的机器，可以用来打开未知（可能有害）的文件和媒体。通过向使用漏洞打开系统的用户发送文件来访问计算机的最简单方法之一。在不受控制的环境中打开未知文件是鲁莽的。不要成为那个用户。
- en: Google filters
  id: totrans-320
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Google过滤器
- en: 'To understand the types of queries you will see when browsing Exploit-DB''s
    **Google Hacking Database (GHDB)** you must understand the types of operators
    that are used. Here is a list of the more common advanced operators:'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: 要了解在浏览Exploit-DB的**Google Hacking Database (GHDB)**时将看到的查询类型，您必须了解使用的操作符类型。以下是更常见的高级操作符列表：
- en: '| **Filter** | **Description** | **Example** |'
  id: totrans-322
  prefs: []
  type: TYPE_TB
  zh: '| **过滤器** | **描述** | **示例** |'
- en: '| --- | --- | --- |'
  id: totrans-323
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| `allinurl` | Search for all terms in URL | `allinurl:example company` |'
  id: totrans-324
  prefs: []
  type: TYPE_TB
  zh: '| `allinurl` | 在URL中搜索所有术语 | `allinurl:example company` |'
- en: '| `allintext` | Search for all terms in page text | `allintext:company name`
    |'
  id: totrans-325
  prefs: []
  type: TYPE_TB
  zh: '| `allintext` | 在页面文本中搜索所有术语 | `allintext:company name` |'
- en: '| `intitle` | Search for term in page title | `intitle:ftp` |'
  id: totrans-326
  prefs: []
  type: TYPE_TB
  zh: '| `intitle` | 在页面标题中搜索术语 | `intitle:ftp` |'
- en: '| `cache` | Displays cached pages | `cache:example.com` |'
  id: totrans-327
  prefs: []
  type: TYPE_TB
  zh: '| `cache` | 显示缓存页面 | `cache:example.com` |'
- en: '| `phonebook` | Searches the phonebook listings | `phonebook:CompanyName` |'
  id: totrans-328
  prefs: []
  type: TYPE_TB
  zh: '| `phonebook` | 搜索电话簿列表 | `phonebook:CompanyName` |'
- en: '| `author` | Search Google Groups for items by specific author (Use Google
    Groups search for this) | `author:anonymous` |'
  id: totrans-329
  prefs: []
  type: TYPE_TB
  zh: '| `author` | 搜索Google Groups中特定作者的项目（使用Google Groups搜索） | `author:anonymous`
    |'
- en: '| `filetype` | Searches for all documents of a specific type | `filetype:pdf`
    |'
  id: totrans-330
  prefs: []
  type: TYPE_TB
  zh: '| `filetype` | 搜索特定类型的所有文档 | `filetype:pdf` |'
- en: '| `site` | Restrict your search to a specific site (or domain) | `site:example.com`
    |'
  id: totrans-331
  prefs: []
  type: TYPE_TB
  zh: '| `site` | 限制搜索到特定站点（或域） | `site:example.com` |'
- en: '| `link` | Find all pages that point to a specified URL | `link:example.com`
    |'
  id: totrans-332
  prefs: []
  type: TYPE_TB
  zh: '| `link` | 查找所有指向指定URL的页面 | `link:example.com` |'
- en: Metagoofil
  id: totrans-333
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Metagoofil
- en: Metagoofil, a powerful metadata gathering tool created by Christian Martorella
    ([http://www.edge-security.com](http://www.edge-security.com)), can be used to
    automate search engine document retrieval and analysis. It also has the capability
    to provide MAC addresses, username listings, and more.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: Metagoofil是由Christian Martorella创建的强大的元数据收集工具（[http://www.edge-security.com](http://www.edge-security.com)），可以用于自动化搜索引擎文档检索和分析。它还具有提供MAC地址、用户名列表等功能。
- en: 'BackTrack has the Metagoofil Blackhat Arsenal Edition installed by default.
    Open up a terminal and type the following:'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: BackTrack默认安装了Metagoofil Blackhat Arsenal Edition。打开终端，输入以下内容：
- en: '[PRE46]'
  id: totrans-336
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: 'Metagoofil is a Python script and can be launched by typing:'
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: Metagoofil是一个Python脚本，可以通过输入以下内容来启动：
- en: '[PRE47]'
  id: totrans-338
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Which results in the following output:'
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
  zh: 这导致以下输出：
- en: '[PRE48]'
  id: totrans-340
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: 'Let''s give `metagoofil.py` a try on the `example.com` domain:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在`example.com`域上尝试`metagoofil.py`：
- en: '[PRE49]'
  id: totrans-342
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: 'As a penetration tester you would want to find some documents that provide
    you all sorts of information about your client when running this tool. We do not
    currently have any such documents on the `example.com` domain so the output is
    as follows:'
  id: totrans-343
  prefs: []
  type: TYPE_NORMAL
  zh: 作为渗透测试人员，当运行此工具时，您会想要找到一些文件，这些文件会为您提供有关客户的各种信息。我们目前在`example.com`域上没有这样的文件，因此输出如下：
- en: '[PRE50]'
  id: totrans-344
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: As indicated in the preceding output, if this site had any information that
    was searchable via Google, it would have provided a nice HTML report of Usernames,
    E-mail Addresses, Software, Servers, and Paths. All of this is accomplished with
    one simple command sequence. You can change the variables to look for any documentation
    type that Google can find based on the `filetype:` option.
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的输出所示，如果这个网站有任何可以通过谷歌搜索的信息，它将提供一个漂亮的HTML报告，其中包括用户名、电子邮件地址、软件、服务器和路径。所有这些都可以通过一个简单的命令序列完成。您可以更改变量以查找谷歌可以找到的任何文档类型，基于`filetype:`选项。
- en: Searching the Internet for clues
  id: totrans-346
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 搜索互联网以寻找线索。
- en: By now you should have some usernames, and possibly even some phone numbers
    and job titles. This information will come in handy if you are planning on performing
    a social engineering test.
  id: totrans-347
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，您应该有一些用户名，甚至可能还有一些电话号码和职位。如果您计划进行社会工程测试，这些信息将会很有用。
- en: Tip
  id: totrans-348
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: Search engines such as Google can be used to search for information that corporate
    employees are dropping on the Internet as easily as you could search for a pie
    recipe. Be sure to verify that your client wants you to do research on employees
    before you start, not after. There are many laws that protect the privacy of an
    employee and only a lawyer can let you know what is and what is not acceptable.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 搜索引擎如谷歌可以用来搜索企业员工在互联网上发布的信息，就像你搜索馅饼食谱一样容易。在开始之前，请确保你的客户希望你在开始之前进行员工调查，而不是之后。有许多法律保护员工的隐私，只有律师才能告诉你什么是可以接受的，什么是不可以接受的。
- en: One practice that seems to be prominent in penetration testing is to search
    for forum and group postings made by employees that may include information relating
    to work assets. Most of the information will not be shared with the world in a
    malicious manner, but rather innocently. This does not change the fact that attackers
    have access to this information and could possible use it against a targeted company.
    Look for things such as an administrator of the company asking for help on configuring
    a specific firewall type, or other network devices. A security professional that
    posts questions on a public forum may be unintentionally providing clues as to
    which standards their company complies with. These are the types of information
    that gives both you the penetration tester, as well as an advanced attacker, the
    knowledge necessary to penetrate an otherwise secured environment.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试中似乎有一种突出的做法，就是搜索员工在论坛和群组上发布的信息，这些信息可能涉及工作资产。大多数信息不会以恶意方式与世界分享，而是无意中。但这并不改变攻击者可以访问这些信息并可能针对目标公司使用它的事实。寻找诸如公司管理员寻求帮助配置特定防火墙类型或其他网络设备等内容。在公共论坛上发布问题的安全专业人员可能无意中提供了关于他们公司遵守哪些标准的线索。这些是给予你作为渗透测试人员以及高级攻击者所需的知识，以便渗透一个本来安全的环境。
- en: 'Here are some tools that would assist you in finding more information:'
  id: totrans-351
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些可以帮助您找到更多信息的工具：
- en: '| **Name** | **Description** | **Location** |'
  id: totrans-352
  prefs: []
  type: TYPE_TB
  zh: '| **名称** | **描述** | **位置** |'
- en: '| --- | --- | --- |'
  id: totrans-353
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| SecApps Google Hacking Database Explorer | Web application that allows you
    to put in the site and query modifiers to automate your GHDB queries. | [http://www.secapps.com/a/ghdb](http://www.secapps.com/a/ghdb)
    |'
  id: totrans-354
  prefs: []
  type: TYPE_TB
  zh: '| SecApps Google Hacking Database Explorer | Web应用程序，允许您输入站点和查询修饰符以自动化您的GHDB查询。
    | [http://www.secapps.com/a/ghdb](http://www.secapps.com/a/ghdb) |'
- en: '| Site Digger 3.0 | Searches Googles cache. Finds all sorts of information.
    Requires .NET Framework 3.5 to work. | [http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx](http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx)
    |'
  id: totrans-355
  prefs: []
  type: TYPE_TB
  zh: '| Site Digger 3.0 | 搜索谷歌缓存。找到各种信息。需要.NET Framework 3.5才能运行。 | [http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx](http://www.mcafee.com/us/downloads/free-tools/sitedigger.aspx)
    |'
- en: '| The Harvester | Searches for Subdomains, Hostnames, Users, Employee E-mails,
    and Names from search engines and PGP servers. | Included in BackTrack or [https://code.google.com/p/theharvester](http://https://code.google.com/p/theharvester)
    |'
  id: totrans-356
  prefs: []
  type: TYPE_TB
  zh: '| The Harvester | 从搜索引擎和PGP服务器中搜索子域、主机名、用户、员工电子邮件和姓名。 | 包含在BackTrack中或[https://code.google.com/p/theharvester](http://https://code.google.com/p/theharvester)
    |'
- en: '| Lullar.com | Search for people by Name, E-mail, or Usernames. | [http://com.lullar.com/](http://com.lullar.com/)
    |'
  id: totrans-357
  prefs: []
  type: TYPE_TB
  zh: '| Lullar.com | 通过姓名、电子邮件或用户名搜索人员。 | [http://com.lullar.com/](http://com.lullar.com/)
    |'
- en: '| White Pages | Good to find business information. | [http://www.whitepages.com/](http://www.whitepages.com/)
    |'
  id: totrans-358
  prefs: []
  type: TYPE_TB
  zh: '| White Pages | 查找商业信息的好地方。 | [http://www.whitepages.com/](http://www.whitepages.com/)
    |'
- en: '| PeekYou | Search for people by Username, Last Name, or First Name. | [http://www.peekyou.com/](http://www.peekyou.com/)
    |'
  id: totrans-359
  prefs: []
  type: TYPE_TB
  zh: '| PeekYou | 通过用户名、姓氏或名字搜索人员。 | [http://www.peekyou.com/](http://www.peekyou.com/)
    |'
- en: '| TinEye | Find your images across the Web. | [http://www.tineye.com/](http://www.tineye.com/)
    |'
  id: totrans-360
  prefs: []
  type: TYPE_TB
  zh: '| TinEye | 在网络上查找您的图片。 | [http://www.tineye.com/](http://www.tineye.com/) |'
- en: '| Internet Archive | Personal favorite, archives copies of websites and files
    for years and years. | [http://www.archive.org/web/web.php](http://www.archive.org/web/web.php)
    |'
  id: totrans-361
  prefs: []
  type: TYPE_TB
  zh: '| Internet Archive | 个人最喜欢，存档网站和文件多年。 | [http://www.archive.org/web/web.php](http://www.archive.org/web/web.php)
    |'
- en: Metadata collection
  id: totrans-362
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 元数据收集
- en: In this chapter, we have already touched upon metadata when discussing `Metagoofil`.
    Metadata can provide very useful information to a penetration tester. Many users
    are not even aware that this information is being attached to their files. A good
    example of this would be the **Exif** data associated with different image formats.
    You can find out what type of camera was used, when the photo was taken, where
    it was taken if there is GPS data available at the time (phone cameras…), and
    much more. Pictures are not the only files that have this type of extensive data
    available. The same goes for PDF documents, and more. **Foca** is an excellent
    program with an intuitive user interface, and its usage is highly advised, but
    it is a Windows program and is difficult to install on BackTrack (although not
    impossible by any means!). Thus we will review other options that come preinstalled
    on our penetration testing toolkit of choice — BackTrack.
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，当讨论`Metagoofil`时，我们已经提到了元数据。元数据对于渗透测试人员来说可以提供非常有用的信息。许多用户甚至不知道这些信息被附加到他们的文件中。一个很好的例子就是与不同图像格式相关的**Exif**数据。您可以了解使用了什么类型的相机，照片拍摄的时间，拍摄地点（如果当时有GPS数据可用的话，比如手机相机...）等等。图片并不是唯一具有这种大量数据的文件。PDF文档等也是如此。**Foca**是一个具有直观用户界面的优秀程序，强烈建议使用，但它是一个Windows程序，在BackTrack上安装起来很困难（尽管绝非不可能！）。因此，我们将回顾其他预装在我们选择的渗透测试工具包BackTrack上的选项。
- en: Note
  id: totrans-364
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: If your clients use Windows 7 or Windows Server 2008 please make them aware
    that there is an option to erase all personal metadata from certain file types
    with a few clicks of the mouse.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您的客户使用Windows 7或Windows Server 2008，请让他们知道有一个选项可以通过几次鼠标点击从某些文件类型中删除所有个人元数据。
- en: Extracting metadata from photos using exiftool
  id: totrans-366
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 使用exiftool从照片中提取元数据
- en: '**exiftool** comes preinstalled on BackTrack 5 and can be used to list all
    of the Exif data associated with many file types. This tool is extremely powerful
    and allows you to export your results into many different formats, write to file
    metadata, and more.'
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
  zh: '**exiftool**已经预装在BackTrack 5上，可用于列出与许多文件类型相关的所有Exif数据。这个工具非常强大，可以让您将结果导出到许多不同的格式，写入文件元数据等。'
- en: We will use a picture named `FotoStation.jpg` that is included at `/pentest/misc/exiftool/t/images`
    for our first usage example.
  id: totrans-368
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将使用位于`/pentest/misc/exiftool/t/images`的`FotoStation.jpg`图片作为我们的第一个使用示例。
- en: 'To start **exiftool** you can open up a terminal session and type:'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
  zh: 要启动**exiftool**，您可以打开一个终端会话并输入：
- en: '[PRE51]'
  id: totrans-370
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: If you run the default `exiftool` you will be presented with the tool help selection.
    It is quite extensive, so be prepared for a lot of reading. Here we initiate a
    simple check against `FotoStation.jpg:`
  id: totrans-371
  prefs: []
  type: TYPE_NORMAL
  zh: 如果运行默认的`exiftool`，将会显示工具帮助选项。内容非常丰富，所以准备好大量阅读。在这里，我们对`FotoStation.jpg`进行了简单的检查：
- en: '[PRE52]'
  id: totrans-372
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'This results in the following output:'
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
  zh: 这将产生以下输出：
- en: '[PRE53]'
  id: totrans-374
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: 'We can see that this provides a tremendous amount of data, but nothing that
    could really be used for your penetration testing. Now let''s try a different
    file format:'
  id: totrans-375
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到这提供了大量的数据，但没有什么可以真正用于您的渗透测试。现在让我们尝试不同的文件格式：
- en: '[PRE54]'
  id: totrans-376
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'This provides us the following:'
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
  zh: 这为我们提供了以下内容：
- en: '[PRE55]'
  id: totrans-378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: 'This is the metadata that you are looking for when testing. In this particular
    example, the information has been scrubbed for learning purposes but some fields
    of interest should include:'
  id: totrans-379
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是您在测试时要寻找的元数据。在这个特定的例子中，出于学习目的，信息已经被清除，但一些感兴趣的字段应该包括：
- en: Title
  id: totrans-380
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 标题
- en: Subject
  id: totrans-381
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 主题
- en: Author
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 作者
- en: Comments
  id: totrans-383
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 评论
- en: Software
  id: totrans-384
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 软件
- en: Company
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 公司
- en: Manager
  id: totrans-386
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 经理
- en: Hyperlinks
  id: totrans-387
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 超链接
- en: Current User
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 当前用户
- en: All of this data starts to make a pretty picture when it is all combined in
    your data collection and centralization tool. You can use **exiftool** to pull
    or to write to metadata from Flash, PPT, and MANY more. You can obtain a complete
    listing of supported file types from [http://www.sno.phy.queensu.ca/~phil/exiftool/#supported](http://www.sno.phy.queensu.ca/~phil/exiftool/#supported).
  id: totrans-389
  prefs: []
  type: TYPE_NORMAL
  zh: 当所有这些数据结合在您的数据收集和集中工具中时，就会形成一个完整的图片。您可以使用**exiftool**从Flash、PPT等文件中提取或写入元数据。您可以从[http://www.sno.phy.queensu.ca/~phil/exiftool/#supported](http://www.sno.phy.queensu.ca/~phil/exiftool/#supported)获取支持的文件类型的完整列表。
- en: Summary
  id: totrans-390
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we have reviewed many specialized methods of gathering freely
    available information. Using this information we are able to create a larger picture
    of the networks we are targeting.
  id: totrans-391
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经回顾了许多收集免费可用信息的专门方法。使用这些信息，我们能够对我们正在针对的网络创建一个更大的图片。
- en: After performing the initial reconnaissance we should be able to determine if
    the network space provided to us by our clients is accurate. We should also be
    able to successfully determine which documents are searchable on the Internet
    and we are able to read the metadata associated with said documents. At this point
    of a penetration test we should be getting an idea of just how difficult or easy
    this job will be. One such indicator will be the results you gather from search
    engines such as Shodan. One last note, be very diligent in collecting the data
    you have found. Documentation is critical and will make your life as a penetration
    tester much easier in the long run.
  id: totrans-392
  prefs: []
  type: TYPE_NORMAL
  zh: 完成初始侦察后，我们应该能够确定客户提供给我们的网络空间是否准确。我们还应该能够成功确定哪些文档可以在互联网上搜索，并且能够阅读与这些文档相关的元数据。在渗透测试的这一阶段，我们应该能够对这项工作的难易程度有所了解。其中一个指标将是您从Shodan等搜索引擎中收集到的结果。最后，请务必勤奋地收集您找到的数据。文档记录至关重要，并将使您作为渗透测试人员的生活在长远来看更加轻松。
- en: 'In the next chapter, we will start to put the information we have gathered
    to use. You will have a chance to directly enumerate networks. We also begin to
    build out a functional lab that allows you to follow along with each and every
    step of the process. Some of the topics covered in [Chapter 3](ch03.html "Chapter 3. Enumeration:
    Choosing Your Targets Wisely"), *Enumeration: Choosing your targets wisely*, include
    understanding how and when to use NMAP, using SNMP to your advantage, various
    avoidance techniques, and more!'
  id: totrans-393
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将开始利用我们收集到的信息。您将有机会直接枚举网络。我们还将开始建立一个功能性实验室，让您可以跟随整个过程的每一步。[第3章](ch03.html
    "第3章 枚举：明智地选择目标")涵盖的一些主题包括了如何何时使用NMAP，利用SNMP的优势，各种避免技术等等！
